<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>The Tragedy of XY</title>
    <description>The Tragedy of XY</description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 29 Apr 2021 01:29:36 +0000</pubDate>
    <lastBuildDate>Thu, 29 Apr 2021 01:29:36 +0000</lastBuildDate>
    <generator>Jekyll v4.1.0</generator>
    
      <item>
        <title>Hotwire: æ²¡æœ‰JavaScriptçš„Reactive Rails</title>
        <description>&lt;p&gt;&lt;em&gt;æœ¬æ–‡å·²è·å¾—åŸä½œè€…ï¼ˆVladimir Dementyevï¼‰å’Œ Evil Martians æˆæƒè®¸å¯è¿›è¡Œç¿»è¯‘ã€‚åŸæ–‡ä»‹ç»äº† Rails çš„æœ€æ–°â€œé­”æ³•â€ï¼š&lt;strong&gt;Hotwire&lt;/strong&gt;ã€‚è¿™ä¹Ÿæ˜¯ Vladimir Dementyev åœ¨ RailsConf 2021 ä¸Šçš„æ¼”è®²å†…å®¹ã€‚&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&quot;https://evilmartians.com/chronicles/hotwire-reactive-rails-with-no-javascript&quot;&gt;Hotwire: Reactive Rails with no JavaScript?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;ä½œè€…ï¼š&lt;a href=&quot;https://twitter.com/palkan_tula&quot;&gt;Vladimir Dementyev&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;ç«™ç‚¹ï¼šEvil Martians â€”â€”ä½äºçº½çº¦å’Œä¿„ç½—æ–¯çš„ Ruby on Rails å¼€å‘äººå‘˜åšå®¢ã€‚ å®ƒå‘å¸ƒäº†è®¸å¤šä¼˜ç§€çš„æ–‡ç« ï¼Œå¹¶ä¸”æ˜¯ä¸å°‘ gem çš„èµåŠ©å•†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;ã€æ­£æ–‡å¦‚ä¸‹ã€‘&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;å¼•è¨€&quot;&gt;å¼•è¨€&lt;/h2&gt;

&lt;p&gt;åˆ°ä¼ æ’­ DHH åŠå…¶å…¬å¸ä¹…ç»è€ƒéªŒçš„&lt;a href=&quot;https://twitter.com/dhh/status/1275901955995385856&quot;&gt;æ–°é­”æ³•&lt;/a&gt;çš„æ—¶å€™äº†ï¼Œå¹¶ä¸”åœ¨è¶…è¿‡ 5 åˆ†é’Ÿçš„æ•™å­¦ä¸­å­¦ä¹ ä½¿ç”¨ &lt;a href=&quot;https://hotwire.dev/&quot;&gt;Hotwire&lt;/a&gt;ã€‚è‡ªä»ä»Šå¹´æ­å¼€å…¶é¢çº±ä»¥æ¥ï¼Œè¿™ä¸ªç”¨äºæ„å»ºç°ä»£ Web ç•Œé¢è€Œä¼¼ä¹æ— éœ€ä»»ä½• JavaScript çš„æŠ€æœ¯çš„åå­—å°±å¤‡å—æ¬¢è¿ã€‚è¿™ä¸ª &lt;strong&gt;HTML-over-the-wire&lt;/strong&gt; çš„æ–¹æ¡ˆæ­£åœ¨ Rails ä¸–ç•Œé‡Œæ¿€å‘èµ·å±‚å±‚æ¶Ÿæ¼ªï¼šä¸è®¡å…¶æ•°çš„åšå®¢æ–‡ç« ã€reddit ç¤¾åŒºå¸–å­ã€å½•å±è§†é¢‘ï¼Œä»¥åŠ&lt;a href=&quot;https://railsconf.com/program&quot;&gt;ä»Šå¹´ RailsConf çš„äº”ä¸ªæ¼”è®²&lt;/a&gt;ï¼Œè€Œå…¶ä¸­ä¼šåŒ…å«ä½ æ‰€æœŸæœ›çš„å†…å®¹ã€‚æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³è¦å¯¹ Hotwire è¿›è¡Œå½»åº•åœ°è§£é‡Šâ€”â€”å€ŸåŠ©ä»£ç ç¤ºä¾‹å’Œæµ‹è¯•ç­–ç•¥ã€‚å°±åƒæˆ‘æœ€çˆ±çš„æ‘‡æ»šä¹é˜Ÿè¯´çš„é‚£æ ·ï¼Œè®©æˆ‘ä»¬ Hotwired æ¥â€¦â€¦&lt;del&gt;self destruct&lt;/del&gt; å­¦ä¹ æ–°æŠ€å·§å§ï¼ã€è¯‘è€…æ³¨ï¼šæ‘‡æ»šä¹é˜Ÿ Metallica 2016 å¹´å‘è¡Œäº†ä¸“è¾‘ã€ŠHardwired â€¦ To Self-Destructã€‹ï¼Œä½œè€…åœ¨è¿™å„¿ä½¿ç”¨äº†åç§°çš„è°éŸ³ã€‘&lt;/p&gt;

&lt;h2 id=&quot;life-is-short&quot;&gt;Life is short&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;è¦æ¦‚è§ˆ Hotwire åœ¨ Rails 6 ä¸­è¿›è¡Œä½¿ç”¨çš„å…¨è²Œï¼Œæ¯‹éœ€å†è´¹å…¶ä»–åŠŸå¤«ï¼Œçœ‹&lt;a href=&quot;https://github.com/anycable/anycable_rails_demo/pull/16&quot;&gt;è¿™ä¸ª PR&lt;/a&gt; å°±è¶³å¤Ÿäº†ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥çš„æ–‡ç« ä¼šè§£é‡Šä¸Šè¿° PR ä»£ç â€”â€”åœ¨å¾ˆå¤šç»†èŠ‚ä¸Šã€‚å®ƒæ˜¯æˆ‘çš„ &lt;a href=&quot;https://railsconf.com/&quot;&gt;RailsConf 2021&lt;/a&gt; æ¼”è®²ï¼š&lt;a href=&quot;https://railsconf.com/program/sessions#session-1118&quot;&gt;â€œFrontendless Rails frontendâ€&lt;/a&gt; çš„ä¸€ä¸ªæ”¹ç¼–å’Œæ‰©å±•ç‰ˆæœ¬ï¼Œæ‰€æœ‰ RailsConf çš„å‚ä¼šè€…éƒ½å·²èƒ½å¤Ÿåœ¨çº¿è§‚çœ‹ã€‚å¦‚æœä½ æ²¡æœ‰å¤§ä¼šé—¨ç¥¨ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼šå¯ä»¥åœ¨&lt;a href=&quot;https://noti.st/palkan/eVl0xO/frontendless-rails-frontend&quot;&gt;è¿™é‡Œ&lt;/a&gt;çœ‹åˆ°å…¶ç®€æŠ¥ï¼Œè€Œä¸”è¯¥é¡µé¢ä¼šæ›´æ–°æ¼”è®²è§†é¢‘ï¼Œä¸€æ—¦æ¼”è®²å¯ä»¥å…¬å¼€å‘å¸ƒçš„è¯ã€‚&lt;/p&gt;

&lt;h2 id=&quot;this-is-the-way&quot;&gt;â€œThis is the wayâ€&lt;/h2&gt;

&lt;p&gt;è¿‡å»äº”å¹´ä¸­ï¼Œæˆ‘ä¸€ç›´ä¸»è¦åœ¨åšçº¯åç«¯çš„å¼€å‘ï¼šREST å’Œ GraphQL APIsã€WebSocketã€gRPCã€æ•°æ®åº“ã€ç¼“å­˜ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;æ•´ä¸ªå‰ç«¯çš„è¿›åŒ–åƒå·¨æµªä¸€æ ·å¸­å·äº†æˆ‘ï¼šæˆ‘ä»ç„¶ä¸ç†è§£ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ª Web åº”ç”¨éƒ½ä½¿ç”¨ &lt;em&gt;reacts&lt;/em&gt; å’Œ &lt;em&gt;webpacks&lt;/em&gt;ã€‚ä¼ ç»Ÿçš„ HTML-first çš„ &lt;strong&gt;Rails æ–¹å¼&lt;/strong&gt; æ‰æ˜¯æˆ‘çš„æ–¹å¼ï¼ˆæˆ–è€…è¯´æ·å¾„ğŸ˜‰ï¼‰ã€‚è¿˜è®°å¾—é‚£äº› JavaScript åœ¨ä½ çš„åº”ç”¨ä¸­æ— éœ€ä»€ä¹ˆ MVCï¼ˆæˆ– MVVMï¼‰çš„æ—¥å­å—ï¼Ÿæˆ‘æ€€å¿µé‚£ç§æ—¥å­ã€‚è€Œè¿™äº›æ—¥å­æ­£åœ¨æ‚„æ‚„åœ°å·åœŸé‡æ¥ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘ä»¬ç›®ç¹äº† &lt;em&gt;HTML-over-the-wire&lt;/em&gt; çš„å´›èµ·ï¼ˆæ˜¯çš„ï¼Œç°åœ¨å®ƒæ˜¯ä¸€ä¸ªå®é™…åè¯äº†ï¼‰ã€‚ç”± &lt;a href=&quot;https://github.com/phoenixframework/phoenix_live_view&quot;&gt;Phoenix LiveView&lt;/a&gt; ç‡å…ˆæå‡ºï¼Œ&lt;a href=&quot;https://stimulusreflex.com/&quot;&gt;StimulusReflex&lt;/a&gt; ç³»åˆ— gems å¯¹å…¶å‘æ‰¬å…‰å¤§ï¼Œè¿™ç§åŸºäºåç«¯é€šè¿‡ WebSocket æŠŠæ¸²æŸ“çš„æ¨¡æ¿æ¨é€åˆ°æ‰€æœ‰æ‰€è¿æ¥çš„å®¢æˆ·ç«¯çš„æ–¹æ¡ˆï¼Œåœ¨ Rails ç¤¾åŒºè·å¾—äº†æå¤§çš„å¸å¼•åŠ›ã€‚æœ€ç»ˆï¼ŒDHH æœ¬äººäºä»Šå¹´åˆæŠŠ &lt;a href=&quot;https://hotwire.dev/&quot;&gt;Hotwire&lt;/a&gt; å‘ˆç°äºä¸–ç•Œé¢å‰ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æ˜¯å¦æ­£ç«™åœ¨ Web å¼€å‘çš„å¦ä¸€ä¸ªå…¨çƒèŒƒå¼è½¬å˜çš„è¾¹ç¼˜ï¼Ÿå›åˆ°æœåŠ¡ç«¯æ¸²æŸ“æ¨¡æ¿çš„ç®€å•æ€ç»´æ¨¡å‹ï¼Œè¿™ä¸€æ¬¡èŠ±è´¹å¾ˆå°‘çš„ç²¾åŠ›å°±å¯å®ç°å„ç§èŠ±é‡Œèƒ¡å“¨çš„ååº”å¼ç•Œé¢å—ï¼Ÿç»å°½è„‘æ±åï¼Œæˆ‘è®¤è¯†åˆ°è¿™æ˜¯ä¸€å¢æƒ…æ„¿çš„æƒ³æ³•ï¼šæŠ€æœ¯é¢†åŸŸå·²ç»æœ‰å¤ªå¤šçš„æŠ•èµ„åœ¨å®¢æˆ·ç«¯æ¸²æŸ“çš„åº”ç”¨ä¸Šè€Œå¾ˆéš¾å›å¤´äº†ã€‚2020 æ—¶ä»£çš„å‰ç«¯å¼€å‘å·²ç»æ˜¯ä¸€ç§ç‹¬ç«‹çš„&lt;strong&gt;èµ„è´¨&lt;/strong&gt;å’Œæœ‰å…¶è‡ªèº«éœ€æ±‚çš„ç‹¬ç«‹è¡Œä¸šï¼Œæˆ‘ä»¬å°†æ²¡åŠæ³•å†æˆä¸ºâ€œå…¨æ ˆâ€äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼ŒHOTWireï¼ˆçœ‹åˆ°é‚£ä¸ªé¦–å­—æ¯ç¼©å†™å—ï¼ŸBasecamp è¿™æ–¹é¢å¾ˆèªæ˜ï¼Œæ˜¯å§ï¼Ÿï¼‰ï¼Œä¸ºå¤æ‚çš„ï¼Œæˆ–è€…æˆ‘ä»¬åº”è¯¥è¯´â€œé”™ç»¼å¤æ‚çš„â€ï¼Œèˆªå¤©ç§‘å­¦ä¸€èˆ¬é’ˆå¯¹æµè§ˆå™¨çš„ç°ä»£å®¢æˆ·ç«¯ç¼–ç¨‹ï¼Œæä¾›äº†ä¸€ç§æ€¥éœ€çš„æ›¿ä»£æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¯¹äºåŒå€¦äº†åªåš API åº”ç”¨è€Œæ— æ³•æŒæ§å…¶å‘ˆç°ï¼Œä»¥åŠæ€€å¿µåˆ›å»ºå“è¶Šç”¨æˆ·ä½“éªŒè€Œæ‘†è„±æ¯å‘¨ 40 å°æ—¶å……æ–¥ç€ SQL å’Œ JSON çš„ä¸€å Rails å¼€å‘è€…è€Œè¨€ï¼ŒHotwire å°±å¦‚ä»–æ‰€æ¸´æœ›èƒ½å¸¦æ¥æ–°é²œæ°”æ¯çš„å‘¼å¸ä¸€èˆ¬ï¼Œè®© Web å¼€å‘é‡æ‹¾ä¹è¶£ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¼šæ¼”ç¤ºå¦‚ä½•æŠŠ HTML-over-the-wire å“²å­¦é€šè¿‡ Hotwire ç”¨åˆ°ç°æœ‰çš„ Rails åº”ç”¨ä¸Šã€‚å°±åƒæˆ‘æœ€è¿‘çš„å¤§å¤šæ•°æ–‡ç« ä¸€æ ·ï¼Œæˆ‘ä¼šä½¿ç”¨ &lt;a href=&quot;https://github.com/anycable/anycable_rails_demo&quot;&gt;AnyCable demo åº”ç”¨&lt;/a&gt;ä½œä¸ºå°ç™½é¼ ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªåº”ç”¨å¾ˆåº”æ™¯ï¼šäº¤äº’å’Œååº”ï¼ŒTurbolinks é©±åŠ¨ï¼Œä»¥åŠå°‘é‡è‡ªå®šä¹‰ JavaScriptsï¼Œè¿˜æœ‰ç›¸å½“å¥½çš„ç³»ç»Ÿæµ‹è¯•è¦†ç›–ç‡ï¼ˆè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è¿›è¡Œå®‰å…¨åœ°é‡æ„ï¼‰ã€‚æˆ‘ä»¬çš„ &lt;em&gt;Hotwire åŒ–&lt;/em&gt; å°†ä¼šæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è¿›è¡Œï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://evilmartians.com/chronicles/hotwire-reactive-rails-with-no-javascript#from-turbolinks-to-turbo-drive&quot;&gt;From Turbolinks to Turbo Drive&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://evilmartians.com/chronicles/hotwire-reactive-rails-with-no-javascript#framing-with-turbo-frames&quot;&gt;Framing with Turbo Frames&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://evilmartians.com/chronicles/hotwire-reactive-rails-with-no-javascript#streaming-with-turbo-streams&quot;&gt;Streaming with Turbo Streams&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://evilmartians.com/chronicles/hotwire-reactive-rails-with-no-javascript#beyond-turbo-or-using-stimulus-and-custom-elements&quot;&gt;Beyond Turbo, or using Stimulus and custom elements&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;from-turbolinks-to-turbo-drive&quot;&gt;From Turbolinks to Turbo Drive&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/turbolinks/turbolinks&quot;&gt;Turbolinks&lt;/a&gt; åœ¨ Rails ä¸–ç•Œé‡Œå¾ˆé•¿æ—¶é—´ä¹…è´Ÿç››åï¼›å…¶&lt;a href=&quot;https://github.com/turbolinks/turbolinks-classic/commit/41dd321407f837d9705de9d893f2847537676904&quot;&gt;ç¬¬ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬&lt;/a&gt;åœ¨ 2013 å¹´æ—©æœŸå‘å¸ƒã€‚ç„¶è€Œï¼Œåœ¨æˆ‘çš„å¼€å‘ç”Ÿæ¶¯åˆæœŸï¼ŒRails å¼€å‘è€…æœ‰ä¸€ä¸ªç»éªŒä¹‹è°ˆï¼š&lt;em&gt;å¦‚æœä½ çš„å‰ç«¯å‡ºæ¯›ç—…äº†ï¼Œå°è¯•ä¸€ä¸‹ç¦ç”¨Turbolinks&lt;/em&gt;ã€‚è®©ç¬¬ä¸‰æ–¹ JS åº“çš„ä»£ç è·Ÿ Turbolinks çš„ä¼ªå¯¼èˆªï¼ˆå‚è€ƒï¼š&lt;code&gt;pushState&lt;/code&gt; + AJAXï¼‰å…¼å®¹å¯ä¸åƒåœ¨å…¬å›­é‡Œæ•£æ­¥é‚£æ ·å®¹æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;å½“ &lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;StimulusJS&lt;/a&gt; å‡ºæ¥ä»¥åï¼Œæˆ‘å°±ä¸å†èº²é¿ Turbolinks äº†ã€‚å®ƒé€šè¿‡ä¾é ç°ä»£çš„ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver&quot;&gt;DOM mutation APIs&lt;/a&gt; è€Œä»æ ¹æœ¬ä¸Šè§£å†³äº†â€œè¿æ¥â€å’Œâ€œæ–­å¼€è¿æ¥â€ JavaScript çš„é—®é¢˜ã€‚Turbolinks ä¸ Stimulus çš„ä»£ç ç»„åˆï¼ŒDOM æ“ä½œä»…ä»¥ React-Angular å‡ åˆ†ä¹‹ä¸€çš„å¼€å‘æˆæœ¬å°±è½»è€Œæ˜“ä¸¾äº§ç”Ÿäº†â€œSPAâ€èˆ¬çš„ä½“éªŒã€‚&lt;/p&gt;

&lt;p&gt;æ˜”æ—¥è¯¸èˆ¬å¥½å¤„çš„ Turbolinks ç°åœ¨æ›´åä¸º &lt;em&gt;Turbo Drive&lt;/em&gt;ï¼Œå°±å¦‚å­—é¢ä¸Šé‚£æ ·å®ƒé©±åŠ¨äº† &lt;a href=&quot;https://turbo.hotwire.dev/&quot;&gt;Turbo&lt;/a&gt; â€”â€” Hotwire åŒ…çš„æ ¸å¿ƒã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å¦‚æœä½ çš„åº”ç”¨å·²ç»ä½¿ç”¨äº† Turbolinksï¼ˆå¦‚æˆ‘ä¸€èˆ¬ï¼‰ï¼Œåˆ‡æ¢åˆ° Turbo Drive ä¸è´¹å¹ç°ä¹‹åŠ›ã€‚ä¸è¿‡æ˜¯ä¸€äº›é‡å‘½åçš„äº‹å„¿ç½¢äº†ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯æŠŠ&lt;code&gt;package.json&lt;/code&gt;ä¸­çš„&lt;code&gt;turbolinks&lt;/code&gt;æ›¿æ¢ä¸º&lt;code&gt;@hotwired/turbo-rails&lt;/code&gt;ï¼Œä»¥åŠæŠŠ&lt;code&gt;Gemfile&lt;/code&gt;ä¸­çš„&lt;code&gt;turbolinks&lt;/code&gt;æ›¿æ¢ä¸º&lt;code&gt;turbo-rails&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åˆå§‹åŒ–ä»£ç ç¨æœ‰å·®å¼‚ï¼Œç°åœ¨çš„æ›´ç®€æ´äº†ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;- import Turbolinks from 'turbolinks';

- Turbolinks.start();
+ import &quot;@hotwired/turbo&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼Œæˆ‘ä»¬ç°åœ¨ä¸éœ€è¦æ‰‹åŠ¨å¯åŠ¨ Turbo Drive äº†ï¼ˆå½“ç„¶ä½ å¯ä»¥&lt;a href=&quot;https://github.com/hotwired/turbo/issues/198&quot;&gt;ä¸è¿™ä¹ˆåš&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿˜æœ‰äº›â€œæŸ¥æ‰¾ &amp;amp; æ›¿æ¢â€å·¥ä½œè¦åšï¼šæŠŠæ‰€æœ‰ HTML çš„ data å±æ€§çš„&lt;code&gt;data-turbolinks&lt;/code&gt;æ›´æ–°ä¸º&lt;code&gt;data-turbo&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;è¿™äº›å˜æ›´ä¸­å”¯ä¸€èŠ±è´¹äº†æˆ‘ä¸€ç‚¹æ—¶é—´è€Œå€¼å¾—ä¸€æçš„æ˜¯å¤„ç† &lt;strong&gt;forms å’Œ redirects&lt;/strong&gt;ã€‚ä¹‹å‰ä½¿ç”¨ Turbolinks æ—¶ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ remote formsï¼ˆ&lt;code&gt;remote: true&lt;/code&gt;ï¼‰å’Œ &lt;a href=&quot;https://github.com/turbolinks/turbolinks-rails/blob/master/lib/turbolinks/redirection.rb&quot;&gt;Redirection concern&lt;/a&gt; æ¥å“åº”ä»¥ JavaScript æ¨¡æ¿ã€‚Turbo Drive å·²ç»å†…ç½®äº†å¯¹è¡¨å•æ‹¦æˆªçš„æ”¯æŒï¼Œæ‰€ä»¥&lt;code&gt;remote: true&lt;/code&gt;å°±ä¸å†éœ€è¦äº†ã€‚ç„¶è€Œï¼Œäº‹å®è¯æ˜ redirection ä»£ç å¿…é¡»è¿›è¡Œæ›´æ–°ï¼Œæˆ–è€…æ›´ç²¾ç¡®åœ°è¯´ï¼Œæ˜¯ redirection &lt;strong&gt;status code&lt;/strong&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;- redirect_to workspace
+ redirect_to workspace, status: :see_other
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½¿ç”¨æœ‰äº›æ™¦æ¶©çš„ &lt;em&gt;See Other&lt;/em&gt; HTTP response code (303) æ˜¯ä¸€ä¸ªèªæ˜çš„é€‰æ‹©ï¼šå®ƒå…è®¸ Turbo ä¾èµ–åŸç”Ÿ Fetch API çš„ &lt;code&gt;redirect: &quot;follow&quot; &lt;/code&gt; é€‰é¡¹ï¼Œè¿™æ ·åœ¨è¡¨å•æäº¤åä½ å°±ä¸å¿…æ˜ç¡®å‘èµ·å¦ä¸€ä¸ªè¯·æ±‚ä»¥è·å–æ–°å†…å®¹ã€‚æ ¹æ®&lt;a href=&quot;https://fetch.spec.whatwg.org/#concept-http-redirect-fetch&quot;&gt;å…¶è§„èŒƒ&lt;/a&gt;ï¼Œâ€œ&lt;em&gt;if status is 303 and requestâ€™s method is not &lt;code&gt;GET&lt;/code&gt; or &lt;code&gt;HEAD&lt;/code&gt;&lt;/em&gt;â€ï¼ŒGET è¯·æ±‚å¿…é¡»è¢«è‡ªåŠ¨æ‰§è¡Œã€‚æŠŠè¿™ä¸ªè·Ÿ â€œ&lt;em&gt;if status is 301 or 302 and requestâ€™s method is &lt;code&gt;POST&lt;/code&gt;&lt;/em&gt;â€ æ¯”è¾ƒä¸€ä¸‹â€”â€”çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å…¶ä»–çš„ 3xx çŠ¶æ€ä»…é€‚ç”¨äº POST è¯·æ±‚ï¼Œè€Œ Rails ä¸­æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ POST, PATCH, PUT, å’Œ DELETEã€‚&lt;/p&gt;

&lt;h2 id=&quot;framing-with-turbo-frames&quot;&gt;Framing with Turbo Frames&lt;/h2&gt;

&lt;p&gt;è¯¥æ¥çœ‹ä¸€äº›çœŸæ­£çš„æ–°ä¸œè¥¿äº†ï¼šTurbo Framesã€‚&lt;/p&gt;

&lt;p&gt;Turbo Frames å¸¦æ¥äº†é¡µé¢åœ¨å±€éƒ¨ä¸Šçš„æ— ç¼æ›´æ–°ï¼ˆä¸åƒ Turbo Drive æ˜¯åœ¨æ•´ä¸ªé¡µé¢ä¸Šï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è¯´å®ƒéå¸¸ç±»ä¼¼äº&lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt;æ‰€åšçš„ï¼Œä½†å´ä¸ç”¨åˆ›å»ºå•ç‹¬çš„ windowsã€DOM æ ‘ä»¥åŠä¸ä¹‹ä¿±æ¥çš„é‚£äº›å®‰å…¨å™©æ¢¦ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹å®é™…çš„ä¾‹å­ã€‚&lt;/p&gt;

&lt;p&gt;AnyCable demo åº”ç”¨ï¼ˆç§°ä¸º &lt;em&gt;AnyWork&lt;/em&gt;ï¼‰å…è®¸ä½ åˆ›å»º dashboardsï¼Œå…¶å¸¦å¤šä¸ª ToDo åˆ—è¡¨å’Œä¸€ä¸ªèŠå¤©å®¤ã€‚ç”¨æˆ·å¯ä»¥ä¸ä¸åŒåˆ—è¡¨ä¸­çš„æ¡ç›®è¿›è¡Œäº¤äº’ï¼šæ·»åŠ ã€åˆ é™¤ä»¥åŠæŠŠå…¶æ ‡æ³¨ä¸ºå·²å®Œæˆã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xfyuan/ossimgs@master/uPic/turbo_frames.av1-d92b50b.gif&quot; alt=&quot;turbo_frames.av1-d92b50b&quot; /&gt;&lt;/p&gt;

&lt;p&gt;èµ·åˆï¼Œå®Œæˆå’Œåˆ é™¤è¿™äº›æ¡ç›®æ˜¯é€šè¿‡ AJAX è¯·æ±‚å’Œ&lt;a href=&quot;https://github.com/anycable/anycable_rails_demo/blob/fdb1353b3fa4aae2598b5eaceba838b73d09254e/frontend/controllers/list_controller.js&quot;&gt;ä¸€ä¸ªè‡ªå®šä¹‰ Stimulus controller&lt;/a&gt; æ¥åšåˆ°çš„ã€‚æˆ‘å†³å®šä½¿ç”¨ Turbo Frames æ¥é‡å†™è¿™éƒ¨åˆ†åŠŸèƒ½ä»¥å…¨éƒ¨ä½¿ç”¨ HTMLã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å¦‚ä½•æ¥è§£æ„è¿™äº› ToDo åˆ—è¡¨é¡¹ä»¥å¤„ç†å•ä¸ªæ¡ç›®çš„æ›´æ–°å‘¢ï¼ŸæŠŠæ¯ä¸ªæ¡ç›®éƒ½è½¬åŒ–ä¸ºä¸€ä¸ª frameï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- _item.html.rb --&amp;gt;
&amp;lt;%= turbo_frame_tag dom_id(item) do %&amp;gt;
  &amp;lt;div class=&quot;any-list--item&amp;lt;%= item.completed? ? &quot; checked&quot; : &quot;&quot;%&amp;gt;&quot;&amp;gt;
    &amp;lt;%= form_for item do |f| %&amp;gt;
      &amp;lt;!-- ... --&amp;gt;
    &amp;lt;% end %&amp;gt;
    &amp;lt;%= button_to item_path(item), method: :delete %&amp;gt;
      &amp;lt;!-- ... --&amp;gt;
    &amp;lt;% end %&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;% end %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é‡Œæˆ‘ä»¬åšäº†ä¸‰ä¸ªé‡è¦çš„äº‹æƒ…ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;é€šè¿‡ helper ä¼ é€’ä¸€ä¸ªå”¯ä¸€è¯†åˆ«ç¬¦ï¼ˆæ¥è‡ª&lt;code&gt;ActionView&lt;/code&gt;çš„å¯çˆ±çš„ &lt;a href=&quot;https://api.rubyonrails.org/classes/ActionView/RecordIdentifier.html#method-i-dom_id&quot;&gt;dom_id&lt;/a&gt; æ–¹æ³•ï¼‰ï¼ŒæŠŠå•ä¸ªæ¡ç›®åŒ…è£¹åœ¨ä¸€ä¸ª&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt; tag ä¹‹å†…ï¼›&lt;/li&gt;
  &lt;li&gt;æ·»åŠ ä¸€ä¸ª HTML formï¼Œä½¿å¾— Turbo æ‹¦æˆªè¡¨å•æäº¤å¹¶æ›´æ–°è¯¥ frame çš„å†…å®¹ï¼›ä»¥åŠ&lt;/li&gt;
  &lt;li&gt;ä½¿ç”¨&lt;code&gt;button_to&lt;/code&gt; helper å¹¶å¸¦ &lt;code&gt;method: :delete&lt;/code&gt; å‚æ•°ï¼Œåœ¨è¯¥ä»£ç å¤„ä¹Ÿåˆ›å»ºäº†ä¸€ä¸ª HTML formã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç°åœ¨ï¼Œä»»ä½•æ—¶å€™è¯¥ frame å†…æœ‰è¡¨å•æäº¤ï¼ŒTurbo éƒ½ä¼šæ‹¦æˆªè¯¥æäº¤ï¼Œæ‰§è¡Œ AJAX è¯·æ±‚ï¼Œä»å“åº”è¿”å›çš„ HTML ä¸­æå–å‡ºæœ‰ç›¸åŒ ID çš„ frameï¼ŒæŠŠå…¶å†…å®¹æ›¿æ¢åˆ°è¯¥ frame ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ‰€æœ‰ä¸Šè¿°å·¥ä½œæ²¡æœ‰ä¸€è¡Œè‡ªå·±æ‰‹å†™çš„ JavaScriptï¼&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ¥çœ‹ä¸€ä¸‹æ›´æ–°è¿‡åçš„ controller ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-ruby&quot;&gt;class ItemsController &amp;lt; ApplicationController
  def update
    item.update!(item_params)

    render partial: &quot;item&quot;, locals: { item }
  end

  def destroy
    item.destroy!

    render partial: &quot;item&quot;, locals: { item }
  end
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼Œå½“æˆ‘ä»¬åˆ é™¤æ¡ç›®æ—¶ï¼Œä»¥åŒæ ·çš„ partial è¿›è¡Œäº†å“åº”ã€‚ä½†æˆ‘ä»¬éœ€è¦ç§»é™¤è¯¥æ¡ç›®çš„ HTML èŠ‚ç‚¹è€Œéæ›´æ–°å®ƒã€‚è¦å¦‚ä½•åšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç©º frame æ¥å“åº”ï¼æ›´æ–° partial ä¸ºå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- _item.html.rb --&amp;gt;
&amp;lt;%= turbo_frame_tag dom_id(item) do %&amp;gt;
  &amp;lt;% unless item.destroyed? %&amp;gt;
    &amp;lt;div class=&quot;any-list--item&amp;lt;%= item.completed? ? &quot; checked&quot; : &quot;&quot;%&amp;gt;&quot;&amp;gt;
      &amp;lt;!-- ... --&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;% end %&amp;gt;
&amp;lt;% end %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ å¯èƒ½ä¼šé—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šâ€œå½“æ ‡æ³¨ä¸€ä¸ªæ¡ç›®ä¸ºå®Œæˆæ—¶å¦‚ä½•è§¦å‘è¡¨å•æäº¤å‘¢ï¼Ÿâ€æ¢å¥è¯è¯´ï¼Œå¦‚ä½•è®© checkbox çš„çŠ¶æ€å˜æ›´æ¥è§¦å‘æäº¤è¡¨å•ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ª&lt;em&gt;è¡Œå†…äº‹ä»¶ç›‘å¬å™¨&lt;/em&gt;åšåˆ°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;%= f.check_box :completed, onchange: &quot;this.form.requestSubmit();&quot; %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;æé†’ï¼š&lt;/strong&gt;ä½¿ç”¨ &lt;em&gt;&lt;code&gt;requestSubmit()&lt;/code&gt;&lt;/em&gt; è€Œé &lt;em&gt;&lt;code&gt;submit()&lt;/code&gt;&lt;/em&gt; å¾ˆé‡è¦ï¼šå‰è€…è§¦å‘çš„â€œsubmitâ€äº‹ä»¶èƒ½å¤Ÿè¢« Turbo æ‰€æ‹¦æˆªï¼Œè€Œåè€…ä¸èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ”¾å¼ƒæ‰€æœ‰ä¸“é—¨ä¸ºæ­¤åŠŸèƒ½å®šåˆ¶çš„ JS äº†ï¼Œåªéœ€ä¸€ç‚¹ HTML æ¨¡æ¿çš„æ›´æ”¹å’Œ controller ä»£ç çš„ç®€åŒ–ã€‚éå¸¸ä»¤äººå…´å¥‹ï¼Œä¸æ˜¯ä¹ˆï¼Ÿ&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼ŒæŠŠåˆ—è¡¨ä¹Ÿè½¬åŒ–ä¸º framesã€‚è¿™ä¼šè®©æˆ‘ä»¬åœ¨æ·»åŠ ä¸€ä¸ªæ–°æ¡ç›®æ—¶ï¼Œä» Turbo Drive çš„æ•´ä¸ªé¡µé¢æ›´æ–°åˆ‡æ¢ä¸ºä»…ç‰¹æ®Šé¡µé¢èŠ‚ç‚¹çš„æ›´æ–°ã€‚ä½ å¤§å¯è‡ªå·±å°è¯•ä¸€ä¸‹ï¼&lt;/p&gt;

&lt;p&gt;å‡è®¾ä½ ä¹ŸæœŸæœ›åœ¨ä¸€ä¸ªæ¡ç›®è¢«å®Œæˆæˆ–åˆ é™¤çš„ä»»ä½•æ—¶å€™éƒ½ä¸ºç”¨æˆ·å±•ç¤ºä¸€ä¸ª flash æé†’ï¼ˆæ¯”å¦‚ï¼Œâ€œæ¡ç›®å·²è¢«æˆåŠŸåˆ é™¤â€ï¼‰ã€‚æˆ‘ä»¬èƒ½å€ŸåŠ©äº Turbo Frames åšåˆ°å—ï¼Ÿå¬èµ·æ¥æˆ‘ä»¬éœ€è¦æŠŠ flash æ¶ˆæ¯å®¹å™¨åŒ…è£¹åœ¨ä¸€ä¸ª frame å†…ï¼Œå¹¶å°†æ›´æ–°åçš„ HTML è·Ÿæ ‡è®°ä¸€èµ·æ¨é€ç»™è¯¥æ¡ç›®ã€‚è¿™æ˜¯æˆ‘åˆå§‹çš„æ€è·¯ï¼Œä½†å…¶å¹¶ä¸èƒ½æ­£å¸¸å·¥ä½œï¼šframe çš„æ›´æ–°æ˜¯åœ¨æ‰€åˆ›å»ºçš„ frame å®šä¹‰åŸŸå†…çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•æ›´æ–°åœ¨å…¶å¤–éƒ¨çš„ä»»ä½•ä¸œè¥¿ã€‚&lt;/p&gt;

&lt;p&gt;ç»è¿‡ä¸€ç•ªæ¢ç´¢ä¹‹åï¼Œæˆ‘å‘ç° &lt;a href=&quot;https://turbo.hotwire.dev/handbook/streams&quot;&gt;Turbo Streams&lt;/a&gt; èƒ½å¸®æˆ‘ä»¬åšåˆ°è¿™ç‚¹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;streaming-with-turbo-streams&quot;&gt;Streaming with Turbo Streams&lt;/h2&gt;

&lt;p&gt;è¾ƒä¹‹äº Drive å’Œ Framesï¼Œ&lt;a href=&quot;https://turbo.hotwire.dev/handbook/streams&quot;&gt;Turbo Streams&lt;/a&gt; å®Œå…¨æ˜¯ä¸€é¡¹æ–°æŠ€æœ¯ã€‚è·Ÿå‰ä¸¤è€…ä¸åŒï¼ŒStreams å«ä¹‰æ˜ç¡®ï¼Œæ˜“äºç†è§£ã€‚æ²¡æœ‰ä»€ä¹ˆä¼šè‡ªåŠ¨å‘ç”Ÿï¼Œä½ å¾—è´Ÿè´£é¡µé¢ä¸Šä½•æ—¶æ›´æ–°ä½•ç§å†…å®¹ã€‚è¦åšåˆ°è¿™ç‚¹ï¼Œä½ éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„&lt;code&gt;&amp;lt;trubo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ã€‚&lt;/p&gt;

&lt;p&gt;æ¥çœ‹ä¸€ä¸ª stream å…ƒç´ çš„ç¤ºä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;turbo-stream action=&quot;replace&quot; target=&quot;flash-alerts&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div class=&quot;flash-alerts--container&quot; id=&quot;flash-alerts&quot;&amp;gt;
      &amp;lt;!--  --&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯¥å…ƒç´ è´Ÿè´£ä»¥&lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt; tag å†…æ‰€ä¼ è¾“è¿‡æ¥çš„æ–° HTML å†…å®¹æ›¿æ¢ï¼ˆ&lt;code&gt;action=&quot;replace&quot;&lt;/code&gt;ï¼‰DOM ID ä¸º&lt;code&gt;flash-alerts&lt;/code&gt;å…¶ä¸‹çš„èŠ‚ç‚¹ã€‚ä¸ç®¡ä»€ä¹ˆæ—¶å€™ä½ æŠŠè¿™æ ·çš„&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ä¸‹å‘åˆ°é¡µé¢ä¸Šï¼Œå®ƒéƒ½ä¼šç«‹åˆ»æ‰§è¡Œå…¶ action å¹¶é”€æ¯å…¶è‡ªèº«ã€‚è€Œåœ¨åº•å±‚ï¼Œå®ƒä½¿ç”¨äº† HTML çš„ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements&quot;&gt;Custom Elements API&lt;/a&gt; â€”â€” åˆä¸€ä¸ªä¸ºäº†å¼€å‘ä¹è¶£ï¼ˆæ¯”å¦‚ï¼Œæ›´å°‘çš„ JavaScript ğŸ˜„ï¼‰è€Œä½¿ç”¨ç°ä»£ Web APIs çš„èŒƒä¾‹ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘å¾—è¯´ï¼ŒTurbo Streams æ˜¯è€å¼çš„ JavaScript æ¨¡æ¿çš„ä¸€ä¸ªå£°æ˜å¼æ›¿ä»£æ–¹æ¡ˆã€‚åœ¨ 2010 å¹´ä»£ï¼Œæˆ‘ä»¬å†™çš„ä»£ç ç±»ä¼¼è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;// destroy.js.erb
$(&quot;#&amp;lt;%= dom_id(item) %&amp;gt;&quot;).remove();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è€Œç°åœ¨ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!--  destroy.html.erb --&amp;gt;
&amp;lt;%= turbo_stream.remove dom_id(item) %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç›®å‰ï¼Œä»…æœ‰äº”ç§å¯ç”¨çš„ actionsï¼š&lt;em&gt;appendã€prependã€replaceã€remove å’Œ update&lt;/em&gt;ï¼ˆä»…æ›¿æ¢èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ï¼‰ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢è°ˆè®ºå…¶å±€é™æ€§å’Œå¦‚ä½•å…‹æœå®ƒã€‚&lt;/p&gt;

&lt;p&gt;å›åˆ°æˆ‘ä»¬çš„åˆå§‹é—®é¢˜ï¼šä¸º ToDo æ¡ç›®çš„å®Œæˆæˆ–åˆ é™¤ï¼Œå±•ç¤ºå“åº”ç»“æœä¸­çš„ flash æé†’ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æƒ³è¦ä¸€æ¬¡å“åº”ç»“æœå°±å¸¦æœ‰&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;å’Œ&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;ä¸¤ç§æ›´æ–°ã€‚å¦‚ä½•æ¥åšï¼Ÿä¸ºå…¶æ·»åŠ ä¸€ä¸ªæ–°çš„ partial æ¨¡æ¿ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- _item_update.html.erb --&amp;gt;
&amp;lt;%= render item %&amp;gt;

&amp;lt;%= turbo_stream.replace &quot;flash-alerts&quot; do %&amp;gt;
  &amp;lt;%= render &quot;shared/alerts&quot; %&amp;gt;
&amp;lt;% end %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯¹&lt;code&gt;ItemsController&lt;/code&gt;æ·»åŠ ä¸€ç‚¹å°çš„æ”¹åŠ¨ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;+    flash.now[:notice] = &quot;Item has been updated&quot;

-    render partial: &quot;item&quot;, locals: { item }
+    render partial: &quot;item_update&quot;, locals: { item }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸å¹¸åœ°æ˜¯ï¼Œä¸Šè¿°ä»£ç å¹¶æœªå¦‚é¢„æœŸé‚£æ ·æ­£å¸¸å·¥ä½œï¼šæˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°ä»»ä½• flash æé†’ã€‚&lt;/p&gt;

&lt;p&gt;æ·±å…¥ç ”ç©¶&lt;a href=&quot;https://turbo.hotwire.dev/handbook/streams#streaming-from-http-responses&quot;&gt;æ–‡æ¡£&lt;/a&gt;ä¹‹åï¼Œæˆ‘å‘ç°æ˜¯ Turbo æœŸæœ› HTTP å“åº”å…·æœ‰&lt;code&gt;text/vnd.turbo-stream.html&lt;/code&gt; content type æ‰å¯æ¿€æ´» stream å…ƒç´ ã€‚å¥½å§ï¼ŒåŠ ä¸Šå®ƒï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;-    render partial: &quot;item_update&quot;, locals: { item }
+    render partial: &quot;item_update&quot;, locals: { item }, content_type: &quot;text/vnd.turbo-stream.html&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ç›¸åçš„æƒ…å†µï¼šflash æ¶ˆæ¯æ­£å¸¸å·¥ä½œï¼Œä½†æ¡ç›®çš„å†…å®¹ä¸èƒ½æ›´æ–°äº†ğŸ˜ã€‚æ˜¯æˆ‘å¯¹ Hotwire è¦æ±‚å¤ªé«˜äº†ä¹ˆï¼Ÿé˜…è¯»äº†ä¸‹ Turbo çš„æºç ï¼Œæˆ‘å‘ç°ç±»ä¼¼è¿™æ ·æŠŠ streams å’Œ frames è¿›è¡Œæ··åˆæ˜¯&lt;a href=&quot;https://github.com/hotwired/turbo/blob/8bce5f17cd697716600d3b34836365ebcdc04b3f/src/observers/stream_observer.ts#L50-L55&quot;&gt;ä¸è¡Œçš„&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;è¿™è¯´æ˜ï¼Œæœ‰ä¸¤ç§æ–¹å¼æ¥å®ç°è¯¥åŠŸèƒ½ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æŠŠ streams ç”¨åœ¨æ‰€æœ‰ä¸œè¥¿ä¸Šã€‚&lt;/li&gt;
  &lt;li&gt;æŠŠ&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;ç½®äº&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;å†…éƒ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç¬¬äºŒä¸ªé€‰é¡¹ï¼Œå¯¹æˆ‘è€Œè¨€ï¼Œä¸åœ¨å¸¸è§„é¡µé¢ä¸Šé‡ç”¨ HTML partials å¹¶ä»¥ Turbo è¿›è¡Œæ›´æ–°çš„æƒ³æ³•èƒŒé“è€Œé©°ã€‚æ‰€ä»¥ï¼Œæˆ‘é€‰æ‹©ç¬¬ä¸€ä¸ªï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- _item_update.html.erb --&amp;gt;
&amp;lt;%= turbo_stream.replace dom_id(item) do %&amp;gt;
  &amp;lt;%= render item %&amp;gt;
&amp;lt;% end %&amp;gt;

&amp;lt;%= turbo_stream.replace &quot;flash-alerts&quot; do %&amp;gt;
  &amp;lt;%= render &quot;shared/alerts&quot; %&amp;gt;
&amp;lt;% end %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»»åŠ¡å®Œæˆã€‚ä½†ä»˜å‡ºäº†ä»€ä¹ˆä»£ä»·å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¾—ä¸ä¸ºè¿™ç§ç”¨ä¾‹æ·»åŠ ä¸€ä¸ªæ–°çš„æ¨¡æ¿ã€‚å¹¶ä¸”æˆ‘æ‹…å¿ƒåœ¨ç°å®ä¸­çš„åº”ç”¨ç¨‹åºé‡Œï¼Œè¿™ç§ partials çš„æ•°é‡ä¼šéšç€åº”ç”¨çš„è¿›åŒ–è€Œå¢é•¿ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ›´æ–°ï¼ˆ2021-04-13ï¼‰&lt;/strong&gt;ï¼šAlex Takitani &lt;a href=&quot;https://twitter.com/alex_takitani/status/1381706025875730435?s=20&quot;&gt;å»ºè®®&lt;/a&gt;äº†ä¸€ç§æ›´åŠ ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ layout æ¥æ›´æ–° flash å†…å®¹ã€‚æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹é¢è¿™æ ·æŠŠ application layout å®šä¹‰ä¸º Turbo Stream å“åº”ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- layouts/application.turbo_stream.erb --&amp;gt;
&amp;lt;%= turbo_stream.replace &quot;flash-alerts&quot; do %&amp;gt;
  &amp;lt;%= render &quot;shared/alerts&quot; %&amp;gt;
&amp;lt;% end %&amp;gt;

&amp;lt;%= yield %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬éœ€è¦ä» controller ç§»é™¤ç›¸åº”çš„æ¸²æŸ“ï¼ˆå› ä¸ºè¦ä¸ç„¶ &lt;a href=&quot;https://github.com/hotwired/turbo-rails/issues/25&quot;&gt;layout å°±ä¸ä¼šè¢«ç”¨ä¸Šäº†&lt;/a&gt;ï¼‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;def update
     item.update!(item_params)

     flash.now[:notice] = &quot;Item has been updated&quot;
-
-    render partial: &quot;item_update&quot;, locals: { item }, content_type: &quot;text/vnd.turbo-stream.html&quot;
   end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;åˆ«å¿˜äº†æŠŠ&lt;em&gt;&lt;code&gt;format: :turbo_stream&lt;/code&gt;&lt;/em&gt;æ·»åŠ åˆ° controller/request specs æµ‹è¯•ç›¸åº”çš„è¯·æ±‚ä¸Šï¼Œä»¥ä¾¿ä½¿å¾— render èƒ½æ­£å¸¸å·¥ä½œã€‚&lt;/p&gt;

&lt;p&gt;å¹¶ä¸”æŠŠæˆ‘ä»¬çš„&lt;code&gt;_item_update&lt;/code&gt; partial è½¬æ¢ä¸º&lt;code&gt;update&lt;/code&gt;çš„ Turbo Stream æ¨¡æ¿ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- update.turbo_stream.erb --&amp;gt;
&amp;lt;%= turbo_stream.replace dom_id(item) do %&amp;gt;
  &amp;lt;%= render item %&amp;gt;
&amp;lt;% end %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾ˆé…·ï¼Œå¯¹å§ï¼Ÿè¿™æ­£æ˜¯ Rails çš„æ–¹å¼ï¼&lt;/p&gt;

&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘ä»¬è½¬åˆ°ä¸€äº›å®æ—¶çš„æµå¹¿æ’­ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;Turbo Streams ç»å¸¸åœ¨å®æ—¶æ›´æ–°çš„è¯­å¢ƒä¸­è¢«æåˆ°ï¼ˆä¸”å¸¸å¸¸è¢«ç”¨æ¥è·Ÿ &lt;a href=&quot;https://stimulusreflex.com/&quot;&gt;StimulusReflex&lt;/a&gt; æ¯”è¾ƒï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æ¥çœ‹çœ‹æˆ‘ä»¬èƒ½å¤Ÿå¦‚ä½•åœ¨ Turbo Streams ä¹‹ä¸Šæ„å»ºåˆ—è¡¨çš„åŒæ­¥åŒ–ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xfyuan/ossimgs@master/uPic/turbo_streams.av1-17e20a6.gif&quot; alt=&quot;turbo_streams.av1-17e20a6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æœ‰ Turbo ä¹‹å‰ï¼Œæˆ‘ä¸å¾—ä¸æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„ Action Cable channel å’Œä¸€ä¸ª Stimulus controller æ¥å¤„ç†å¹¿æ’­çš„äº‹æƒ…ã€‚æˆ‘ä¹Ÿéœ€è¦å¤„ç†æ¶ˆæ¯çš„æ ¼å¼ï¼Œå› ä¸ºå¿…é¡»åŒºåˆ†å¯¹æ¡ç›®çš„åˆ é™¤å’Œå®Œæˆã€‚æ¢å¥è¯è¯´ï¼Œæœ‰ä¸å°‘ä»£ç è¦ç»´æŠ¤ã€‚&lt;/p&gt;

&lt;p&gt;è€Œ Turbo Streams å·²ç»ç…§é¡¾å¥½äº†å‡ ä¹ä¸€åˆ‡ï¼š&lt;code&gt;turbo-rails&lt;/code&gt; gem è‡ªå¸¦ä¸€ä¸ªé€šç”¨çš„&lt;code&gt;Turbo::StreamChannel&lt;/code&gt;å’Œä¸€ä¸ª helperï¼ˆ&lt;code&gt;#turbo_stream_from&lt;/code&gt;ï¼‰ï¼Œç”¨æ¥ä» HTML ä¸­åˆ›å»ºä¸€ä¸ª subscriptionï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- worspaces/show.html.erb --&amp;gt;
&amp;lt;div&amp;gt;
  &amp;lt;%= turbo_stream_from workspace %&amp;gt;
  &amp;lt;!-- ... --&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ controller ä¸­ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†&lt;code&gt;#broadcast_new_item&lt;/code&gt;å’Œ&lt;code&gt;#broadcast_changes&lt;/code&gt;è¿™æ ·çš„â€œafter actionâ€ callback è´Ÿè´£å¯¹æ›´æ–°è¿›è¡Œæ’­å‘ã€‚ç°åœ¨æˆ‘ä»¬æ‰€æœ‰éœ€è¦åšçš„å°±æ˜¯åˆ‡æ¢åˆ°&lt;code&gt;Turbo::StreamChannel&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;def broadcast_changes
   return if item.errors.any?
   if item.destroyed?
-    ListChannel.broadcast_to list, type: &quot;deleted&quot;, id: item.id
+    Turbo::StreamsChannel.broadcast_remove_to workspace, target: item
   else
-    ListChannel.broadcast_to list, type: &quot;updated&quot;, id: item.id, desc: item.desc, completed: item.completed
+    Turbo::StreamsChannel.broadcast_replace_to workspace, target: item, partial: &quot;items/item&quot;, locals: { item }
   end
 end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ¬¡è¿ç§»å¾ˆé¡ºç•…ï¼Œå‡ ä¹â€”â€”å› ä¸ºæ‰€æœ‰æ£€éªŒæ’­å‘ï¼ˆ&lt;code&gt;#have_broadcasted_to&lt;/code&gt;ï¼‰çš„ controller å•å…ƒæµ‹è¯•éƒ½å¤±è´¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸å¹¸çš„æ˜¯ï¼ŒTurbo Rails æ²¡æœ‰æä¾›ä»»ä½•æµ‹è¯•å·¥å…·ï¼ˆ?ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä¸å¾—ä¸è‡ªå·±å†™ä¸€ä¸ªï¼Œä»¥&lt;a href=&quot;https://github.com/rails/rails/pull/33659&quot;&gt;è‡ªå·±ç†Ÿæ‚‰çš„æ–¹å¼&lt;/a&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-ruby&quot;&gt;module Turbo::HaveBroadcastedToTurboMatcher
  include Turbo::Streams::StreamName

  def have_broadcasted_turbo_stream_to(*streamables, action:, target:) # rubocop:disable Naming/PredicateName
    target = target.respond_to?(:to_key) ? ActionView::RecordIdentifier.dom_id(target) : target
    have_broadcasted_to(stream_name_from(streamables))
      .with(a_string_matching(%(turbo-stream action=&quot;#{action}&quot; target=&quot;#{target}&quot;)))
  end
end

RSpec.configure do |config|
  config.include Turbo::HaveBroadcastedToTurboMatcher
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸‹é¢æ˜¯æˆ‘å¦‚ä½•æŠŠè¿™ä¸ªæ–°çš„åŒ¹é…å™¨ç”¨åœ¨æµ‹è¯•ä¸Šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-diff&quot;&gt;it &quot;broadcasts a deleted message&quot; do
-  expect { subject }.to have_broadcasted_to(ListChannel.broadcasting_for(list))
-    .with(type: &quot;deleted&quot;, id: item.id)
+  expect { subject }.to have_broadcasted_turbo_stream_to(
+    workspace, action: :remove, target: item
+  )
 end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½¿ç”¨ Turbo çš„å®æ—¶å¤„ç†è¿›å±•é¡ºåˆ©ï¼ä¸€å¤§å †ä»£ç éƒ½è¢«ç§»é™¤äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è€Œæˆ‘ä»¬ä»ç„¶è¿˜æ˜¯ä¸€è¡Œ JavaScript ä»£ç éƒ½æ²¡æœ‰å†™ã€‚è¿™ä¹Ÿå¤ªä¸çœŸå®äº†å§ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¸è¿‡æ˜¯ä¸ªå¹»æ¢¦å—ï¼Ÿä½•æ—¶æˆ‘ä¼šé†’æ¥ï¼Ÿå¥½å§ï¼Œå°±æ˜¯ç°åœ¨ã€‚&lt;/p&gt;

&lt;h2 id=&quot;beyond-turbo-or-using-stimulus-and-custom-elements&quot;&gt;Beyond Turbo, or using Stimulus and custom elements&lt;/h2&gt;

&lt;p&gt;åœ¨å‘ Turbo è¿ç§»çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ç¢°åˆ°äº†å¥½å‡ ä¸ªåœºæ™¯ï¼Œä½¿ç”¨å·²æœ‰çš„ API æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆä¸å¾—ä¸ç¼–å†™ä¸€äº› JavaScript ä»£ç ï¼&lt;/p&gt;

&lt;p&gt;åœºæ™¯ä¸€ï¼šå‘ dashboard å®æ—¶æ·»åŠ æ–°çš„åˆ—è¡¨ã€‚è¿™è·Ÿå‰é¢æåˆ°çš„åˆ—è¡¨ä¸­æ¡ç›®çš„ç¤ºä¾‹æœ‰ä½•ä¸åŒï¼Ÿåœ¨äºæ ‡è®°ã€‚æ¥çœ‹ä¸€ä¸‹ dashboard layoutï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div id=&quot;workspace_1&quot;&amp;gt;
  &amp;lt;div id=&quot;list_1&quot;&amp;gt;...&amp;lt;/div&amp;gt;
  &amp;lt;div id=&quot;list_2&quot;&amp;gt;...&amp;lt;/div&amp;gt;
  &amp;lt;div id=&quot;new_list&quot;&amp;gt;
    &amp;lt;form&amp;gt;...&amp;lt;/form&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åä¸€ä¸ªå…ƒç´ æ€»æ˜¯æ–°åˆ—è¡¨çš„ form å®¹å™¨ã€‚ä¸ç®¡æˆ‘ä»¬ä½•æ—¶æ·»åŠ æ–°åˆ—è¡¨ï¼Œå®ƒéƒ½ä¼šè¢«æ’å…¥åˆ°&lt;code&gt;#new_list&lt;/code&gt;èŠ‚ç‚¹ä¹‹å‰ã€‚è¿˜è®°å¾— Turbo Streams ä»…ä»…æ”¯æŒäº”ç§ actions ä¸ï¼Ÿæ˜ç™½é—®é¢˜æ‰€åœ¨äº†å—ï¼Ÿä¸‹é¢æ˜¯æˆ‘èµ·åˆä½¿ç”¨çš„ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;handleUpdate(data) {
  this.formTarget.insertAdjacentHTML(&quot;beforebegin&quot;, data.html);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¦ä½¿ç”¨ Turbo Streams å®ç°ç±»ä¼¼çš„è¡Œä¸ºï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ª hackï¼Œåœ¨åˆ—è¡¨è¢«é€šè¿‡ stream æ·»åŠ ä¹‹åç«‹å³æŠŠå…¶ç§»åŠ¨åˆ°æ­£ç¡®çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œæ¥æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„ JavaScript ä»£ç å§ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæ¥ç»™æˆ‘ä»¬çš„ä»»åŠ¡ä¸€ä¸ªæ­£å¼çš„å®šä¹‰ï¼šâ€œå½“ä¸€ä¸ªæ–°åˆ—è¡¨è¢« append åˆ° workspace å®¹å™¨æ—¶ï¼Œå®ƒåº”è¯¥å‡ºç°åœ¨é‚£ä¸ª new form å…ƒç´ ä¹‹å‰çš„æ­£ç¡®ä½ç½®ä¸Šã€‚â€ã€‚è¿™é‡Œçš„â€œå½“â€æ„å‘³ç€æˆ‘ä»¬éœ€è¦è§‚å¯Ÿ DOM å¹¶å¯¹å˜æ›´ä½œå‡ºååº”ã€‚æ˜¯ä¸æ˜¯å¬èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬å·²ç»æåˆ°è¿‡ä¸ Stimulus æœ‰å…³çš„ MutationObserver APIï¼ç”¨å®ƒå°±å¯¹äº†ã€‚&lt;/p&gt;

&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸æ˜¯å¿…é¡»ç¼–å†™é«˜é˜¶çš„ JavaScript æ‰èƒ½ä½¿ç”¨è¯¥ç‰¹æ€§ï¼›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;a href=&quot;https://github.com/stimulus-use/stimulus-use&quot;&gt;stimulus-use&lt;/a&gt;ï¼ˆæŠ±æ­‰ä½¿ç”¨è¿™ç§é‡è¨€å¼è¯­æ³•ã€‚ã€è¯‘è€…æ³¨ï¼šåŸæ–‡æ˜¯ use stimulus-useï¼Œæ‰€ä»¥ä½œè€…è¿™ä¹ˆè¯´ã€‘ï¼‰ã€‚Stimulus Use æ˜¯ä¸€ä¸ª Stimulus controllers å¾ˆæœ‰ç”¨çš„è¡Œä¸ºçš„é›†åˆï¼Œä»¥ç®€å•çš„ä»£ç ç‰‡æ®µè§£å†³å¤æ‚çš„é—®é¢˜ã€‚æˆ‘ä»¬è¿™å„¿ï¼Œéœ€è¦ &lt;a href=&quot;https://github.com/stimulus-use/stimulus-use/blob/master/docs/use-mutation.md&quot;&gt;useMutation&lt;/a&gt; è¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹çš„ controller ä»£ç ç›¸å½“ç®€æ´ï¼Œå«ä¹‰ä¸è¨€è‡ªæ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;import { Controller } from &quot;stimulus&quot;;
import { useMutation } from &quot;stimulus-use&quot;;

export default class extends Controller {
  static targets = [&quot;lists&quot;, &quot;newForm&quot;];

  connect() {
    [this.observeLists, this.unobserveLists] = useMutation(this, {
      element: this.listsTarget,
      childList: true,
    });
  }

  mutate(entries) {
    // There should be only one entry in case of adding a new list via streams
    const entry = entries[0];

    if (!entry.addedNodes.length) return;

    // Disable observer while we modify the childList
    this.unobserveLists();
    // Move newForm to the end of the childList
    this.listsTarget.append(this.newFormTarget);
    this.observeLists();
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é—®é¢˜å°±è¿™æ ·è§£å†³äº†ã€‚&lt;/p&gt;

&lt;p&gt;æ¥è®¨è®ºä¸‹ç¬¬äºŒä¸ªè¾¹ç•Œåœºæ™¯ï¼šå®ç°èŠå¤©å®¤åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„èŠå¤©å®¤é™„åœ¨æ¯ä¸ª dashboard ä¸Šï¼šç”¨æˆ·å¯ä»¥å‘é€ä¸´æ—¶æ¶ˆæ¯ï¼ˆä¸ä¼šè¢«å­˜å‚¨åˆ°ä»»ä½•åœ°æ–¹ï¼‰å’Œå®æ—¶æ¥æ”¶å®ƒä»¬ã€‚æ¶ˆæ¯å…·æœ‰ä¾èµ–äºä¸Šä¸‹æ–‡çš„ä¸åŒå¤–è§‚ï¼šè‡ªå·±çš„æ¶ˆæ¯æœ‰ç»¿è‰²è¾¹æ¡†ï¼Œé å·¦ï¼›å…¶ä»–æ¶ˆæ¯åˆ™æ˜¯ç°è‰²ï¼Œé å³ã€‚è€Œæˆ‘ä»¬æ˜¯å‘æ¯ä¸ªæ‰€è¿æ¥çš„å®¢æˆ·ç«¯æ’­å‘ç›¸åŒçš„ HTMLã€‚è¦å¦‚ä½•ä½¿å¾—ç”¨æˆ·çœ‹åˆ°è¿™ç§åŒºåˆ«å‘¢ï¼Ÿè¿™å¯¹äºèŠå¤©å®¤ç±»çš„åº”ç”¨æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜ï¼Œä¸”ä¸€èˆ¬è€Œè¨€ï¼Œå®ƒé€šè¿‡è¦ä¹ˆå‘æ¯ä¸ªç”¨æˆ· channel å‘é€ä¸ªæ€§åŒ–çš„ HTMLï¼Œè¦ä¹ˆå¢å¼ºæ‰€æ”¶åˆ°çš„ HTML åœ¨å®¢æˆ·ç«¯æ¥è§£å†³ã€‚æˆ‘æ›´å–œæ¬¢ç¬¬äºŒç§ï¼Œæ‰€ä»¥æ¥å®ç°å®ƒå§ã€‚&lt;/p&gt;

&lt;p&gt;è¦æŠŠå½“å‰ç”¨æˆ·çš„ä¿¡æ¯ä¼ é€’ç»™ JavaScriptï¼Œæˆ‘ä½¿ç”¨ meta tagsï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- layouts/application.html.erb --&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;% if logged_in? %&amp;gt;
    &amp;lt;meta name=&quot;current-user-name&quot; content=&quot;&amp;lt;%= current_user.name %&amp;gt;&quot; data-turbo-track=&quot;reload&quot;&amp;gt;
    &amp;lt;meta name=&quot;current-user-id&quot; content=&quot;&amp;lt;%= current_user.id %&amp;gt;&quot; data-turbo-track=&quot;reload&quot;&amp;gt;
  &amp;lt;% end %&amp;gt;
  &amp;lt;!-- ... --&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å’Œä¸€ä¸ªå°çš„ JS helper æ¥è·å–è¿™äº› valuesï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;let user;

export const currentUser = () =&amp;gt; {
  if (user) return user;

  const id = getMeta(&quot;id&quot;);
  const name = getMeta(&quot;name&quot;);

  user = { id, name };
  return user;
};

function getMeta(name) {
  const element = document.head.querySelector(
    `meta[name='current-user-${name}']`
  );
  if (element) {
    return element.getAttribute(&quot;content&quot;);
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¦æ’­å‘èŠå¤©å®¤æ¶ˆæ¯ï¼Œæˆ‘ä»¬å°†ä¼šä½¿ç”¨&lt;code&gt;Turbo::StreamChannel&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-ruby&quot;&gt;def create
  Turbo::StreamsChannel.broadcast_append_to(
    workspace,
    target: ActionView::RecordIdentifier.dom_id(workspace, :chat_messages),
    partial: &quot;chats/message&quot;,
    locals: { message: params[:message], name: current_user.name, user_id: current_user.id }
  )
  # ...
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸‹é¢æ˜¯åˆå§‹çš„&lt;code&gt;chat/message&lt;/code&gt;æ¨¡æ¿ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;div class=&quot;chat--msg&quot;&amp;gt;
  &amp;lt;%= message %&amp;gt;
  &amp;lt;span data-role=&quot;author&quot; class=&quot;chat--msg--author&quot;&amp;gt;&amp;lt;%= name %&amp;gt;&amp;lt;/span&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»¥åŠå‰è¿°æ ¹æ®å½“å‰ç”¨æˆ·èµ‹äºˆä¸åŒæ ·å¼çš„ JS ä»£ç ï¼Œè¿™äº›ä»£ç æˆ‘ä»¬å¾ˆå¿«å°±è¦å»æ‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;// Don't get attached to it
appendMessage(html, mine) {
  this.messagesTarget.insertAdjacentHTML(&quot;beforeend&quot;, html);
  const el = this.messagesTarget.lastElementChild;
  el.classList.add(mine ? &quot;mine&quot; : &quot;theirs&quot;);

  if (mine) {
    const authorElement = el.querySelector('[data-role=&quot;author&quot;]');
    if (authorElement) authorElement.innerText = &quot;You&quot;;
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨ï¼Œå½“ Turbo è´Ÿè´£æ›´æ–° HTML æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšç‚¹ä¸åŒçš„äº‹ã€‚å½“ç„¶ï¼Œ&lt;code&gt;useMutaion&lt;/code&gt;ä¹Ÿä¼šåœ¨è¿™é‡Œè¢«ç”¨åˆ°ã€‚å¹¶ä¸”è¿™æœ‰å¯èƒ½æ˜¯æˆ‘å°†ç”¨åœ¨&lt;em&gt;ç°å®&lt;/em&gt;é¡¹ç›®ä¸Šçš„ã€‚ç„¶è€Œï¼Œæˆ‘ä»Šå¤©çš„ç›®æ ‡æ˜¯æ¼”ç¤ºä»¥ä¸åŒçš„æ–¹å¼æ¥è§£å†³é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;è¿˜è®°å¾—æˆ‘ä»¬ä¸€ç›´åœ¨è°ˆè®º Custom Elementsï¼ˆå“¦ï¼Œé‚£æ˜¯å¥½å‡ é¡µä¹‹å‰äº†ï¼ŒæŠ±æ­‰ï¼Œè¿™è¯´æ˜æˆ‘ä»¬é˜…è¯»å¤ªä¹…äº†ï¼‰ï¼Ÿå®ƒæ­£æ˜¯ä»¤ Turbo ä¹‹æ‰€ä»¥å¼ºå¤§çš„ Web APIã€‚æˆ‘ä»¬å¹²å˜›ä¸ç”¨å‘¢ï¼&lt;/p&gt;

&lt;p&gt;è®©æˆ‘å…ˆåˆ†äº«ä¸€ä¸ª&lt;em&gt;æ›´æ–°åçš„&lt;/em&gt; HTML æ¨¡æ¿ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;any-chat-message class=&quot;chat--msg&quot; data-author-id=&quot;&amp;lt;%= user_id %&amp;gt;&amp;gt;
  &amp;lt;%= message %&amp;gt;
  &amp;lt;span data-role=&quot;author&quot; class=&quot;chat--msg--author&quot;&amp;gt;&amp;lt;%= name %&amp;gt;&amp;lt;/span&amp;gt;
&amp;lt;/any-chat-message&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬åªæ·»åŠ äº†&lt;code&gt;data-author-id&lt;/code&gt;å±æ€§ï¼Œå¹¶æŠŠ&lt;code&gt;&amp;lt;div&amp;gt;&lt;/code&gt;æ›¿æ¢ä¸ºè‡ªå®šä¹‰ tag â€”â€”&lt;code&gt;&amp;lt;any-chat-message&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ç°åœ¨æ¥å¯¹ custom element è¿›è¡Œæ³¨å†Œï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-js&quot;&gt;import { currentUser } from &quot;../utils/current_user&quot;;

// This is how you create custom HTML elements with a modern API
export class ChatMessageElement extends HTMLElement {
  connectedCallback() {
    const mine = currentUser().id == this.dataset.authorId;

    this.classList.add(mine ? &quot;mine&quot; : &quot;theirs&quot;);

    const authorElement = this.querySelector('[data-role=&quot;author&quot;]');

    if (authorElement &amp;amp;&amp;amp; mine) authorElement.innerText = &quot;You&quot;;
  }
}

customElements.define(&quot;any-chat-message&quot;, ChatMessageElement);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤§åŠŸå‘Šæˆï¼ç°åœ¨å½“ä¸€ä¸ªæ–°çš„&lt;code&gt;&amp;lt;any-chat-message&amp;gt;&lt;/code&gt;å…ƒç´ è¢«æ·»åŠ åˆ°é¡µé¢æ—¶ï¼Œå¦‚æœå®ƒæ¥è‡ªäºå½“å‰ç”¨æˆ·å°±è‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚è€Œä¸”ç”šè‡³æˆ‘ä»¬ä¸ºæ­¤éƒ½ä¸å†éœ€è¦ Stimulus äº†ï¼&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥åœ¨&lt;a href=&quot;https://github.com/anycable/anycable_rails_demo/pull/16&quot;&gt;è¿™ä¸ª PR&lt;/a&gt; ä¸­æ‰¾åˆ°æœ¬æ–‡æœ‰å…³çš„å…¨éƒ¨æºä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œé‚£ä¹ˆé›¶ JavaScript çš„ Reactive Rails åˆ°åº•å­˜åœ¨å—ï¼Ÿå¹¶ä¸ã€‚æˆ‘ä»¬ç§»é™¤äº†å¾ˆå¤š JS ä»£ç ï¼Œä½†æœ€åä¸å¾—ä¸ç”¨ä¸€äº›æ–°ä¸œè¥¿æ¥æ›¿ä»£ã€‚è¿™äº›æ–°ä¸œè¥¿è·Ÿä¹‹å‰çš„æœ‰æ‰€åŒºåˆ«ï¼šå®ƒæ›´åŠ ï¼Œæˆ‘å¾—è¯´ï¼Œ&lt;strong&gt;&lt;em&gt;å®ç”¨ä¸»ä¹‰&lt;/em&gt;&lt;/strong&gt;ã€‚å®ƒä¹Ÿæ›´åŠ é«˜é˜¶ï¼Œéœ€è¦å¯¹ JavaScript ä»¥åŠæœ€æ–°æµè§ˆå™¨ APIs æœ‰å¾ˆå¥½çš„äº†è§£ï¼Œè¿™è‚¯å®šæ˜¯è¦æƒè¡¡è€ƒè™‘çš„ã€‚&lt;/p&gt;

&lt;p&gt;é™„ï¼šæˆ‘å¯¹ CableReady å’Œ StimulusReflex ä¹Ÿæœ‰ä¸€ä¸ª&lt;a href=&quot;https://github.com/anycable/anycable_rails_demo/pull/12&quot;&gt;ç±»ä¼¼çš„ PR&lt;/a&gt;ã€‚ä½ å¯ä»¥æŠŠå®ƒè·Ÿ Hotwire çš„è¿™ä¸ª PR è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨ &lt;a href=&quot;https://twitter.com/evilmartians&quot;&gt;Twitter&lt;/a&gt; ä¸Šä¸æˆ‘ä»¬åˆ†äº«ä½ çš„è§‚ç‚¹ã€‚&lt;/p&gt;

</description>
        <pubDate>Sat, 24 Apr 2021 00:00:00 +0000</pubDate>
        <link>/2021/04/hotwire-reactive-rails-with-no-javascript/</link>
        <guid isPermaLink="true">/2021/04/hotwire-reactive-rails-with-no-javascript/</guid>
        
        <category>ruby</category>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        <category>stimulus</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Tailwindcssåº•å±‚åŸºçŸ³çš„ç†å¿µ</title>
        <description>&lt;p&gt;Tailwindcss ä» 2019 å¹´å¼€å§‹é€æ¸åœ¨å›½å¤–çš„ Web å¼€å‘åœˆå­å†…ç››è¡Œèµ·æ¥ã€‚å›½å†…å€’æ˜¯è‡³ä»Šä»ç„¶ä¸æ¸©ä¸ç«ã€‚2020 å¹´çš„ Ruby China ä¸Š&lt;strong&gt;&lt;em&gt;è¿‡çº¯ä¸­&lt;/em&gt;&lt;/strong&gt;åšè¿‡ä¸€æ¬¡åœ¨é¡¹ç›®ä¸Šä½¿ç”¨ tailwindcss ä½“éªŒçš„æœ‰å…³æ¼”è®²ã€‚æˆ‘åœ¨ 2020 å¹´ä¹Ÿå†™è¿‡ä¸€ç¯‡æœ‰å…³çš„åšå®¢â€œ&lt;a href=&quot;http://xfyuan.github.io/2020/07/integrate-stimulus-and-tailwindcss-with-rails6/&quot;&gt;åœ¨ Rails 6 ä¸­æ•´åˆ Stimulus å’Œ Tailwind CSS&lt;/a&gt;â€ï¼ˆè¢«å‰è€…åœ¨æ¼”è®²ä¸­æ‰€å¼•ç”¨^_^ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« æ¥èŠä¸€ä¸‹æœ‰å…³ Tailwindcss åº•å±‚ç†å¿µçš„ä¸œè¥¿ã€‚äº†è§£äº†è¿™ä¸ªï¼Œå†æ¥çœ‹å®ƒå°±ä¸è§‰å¾—æ¯«æ— å¤´ç»ªè€Œç•æƒ§äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ Tailwindcss ä¸­ï¼Œ&lt;strong&gt;â€œå·¥å…·ç±»ä¸ºä¸€ç­‰å…¬æ°‘ï¼ˆutility classes are kingï¼‰â€&lt;/strong&gt;ã€‚è¿™ç§å·¥å…·ç±»åœ¨ Bootstrap ä¸­æ—©å·²ä¸ºäººç†ŸçŸ¥ï¼Œå¹¶éä»€ä¹ˆæ–°é²œäº‹ç‰©ï¼Œæ¯”å¦‚&lt;code&gt;text-muted&lt;/code&gt;,&lt;code&gt;bg-success&lt;/code&gt;ã€‚ä½† Tailwindcss åˆæœ‰æ‰€ä¸åŒï¼Œæ­£æ˜¯è¿™äº›ä¸åŒä½¿å¾—å®ƒæ›´â€œTailwindâ€ã€‚&lt;/p&gt;

&lt;p&gt;å¤§éƒ¨åˆ†æ—¶é—´å†…ï¼Œåœ¨ä½¿ç”¨ Tailwindcss æ—¶éƒ½é¢å¯¹ä¸¤ç±»å¯¹è±¡ã€‚ä¸€ä¸ªæ˜¯ themeï¼Œé€šç”¨æ€§é…ç½®ã€‚å¦ä¸€ä¸ªæ˜¯ä¸€å¤§å †çš„ property åˆ—è¡¨ï¼Œå¯æŠŠå®ƒä»¬ç”¨åœ¨ theme ä¸Šã€‚theme æœ‰ä¸€ç³»åˆ—çš„ç»†ç²’åº¦å¯¹è±¡ï¼Œæä¾›äº†è¶…å¤šçš„å¯é…ç½®é¡¹ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚è¯´ï¼Œåœ¨å¼€å§‹ä¸€ä¸ª theme çš„è®¾è®¡æ—¶ï¼Œä¼šä»è¿™ä¸‰ç§é…ç½®å¼€å§‹ï¼šscreenã€colorã€spacingã€‚é¦–å…ˆæ¥çœ‹ color å’Œ spacingï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Color ä» 0 å¼€å§‹ï¼Œä¸€ç›´åˆ° 900ã€‚è¶Šæ¥è¿‘ 900ï¼Œcolor å°±è¶Šæš—ï¼Œåä¹‹åˆ™è¶Šäº®ã€‚&lt;/li&gt;
  &lt;li&gt;Spacing æ˜¯ space ä¹‹æ•°å­—ï¼Œæˆ–å¯¹è±¡ä¹‹å¤§å°ï¼Œåœ¨ 0 - 96 ä¹‹é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è¿˜æœ‰ä¸Šé¢æ‰€æåˆ°çš„é‚£äº› propertyï¼Œæ¯”å¦‚&lt;code&gt;margin&lt;/code&gt;,&lt;code&gt;width&lt;/code&gt;,&lt;code&gt;padding&lt;/code&gt;ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;åªè¦æœ‰äº†è¿™ä¸¤ç§â€œå˜é‡â€ï¼Œä½ å°±å¯ä»¥æŠŠå®ƒä»¬å¦‚æ­¤ç»„åˆèµ·æ¥ï¼š&lt;code&gt;{property}-{color/spacing}&lt;/code&gt;ã€‚å¦‚æœæƒ³è¦ä¸€ä¸ªæš—çº¢è‰²çš„èƒŒæ™¯ï¼Œå°±å†™&lt;code&gt;bg-red-900&lt;/code&gt;ï¼Œè€Œå¦‚æœæƒ³è¦ 6 ä¸ªåƒç´ çš„ paddingï¼Œå°±å†™&lt;code&gt;p-6&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å†çœ‹ screenã€‚Screen ç”¨äºå“åº”å¼çš„ breakpointï¼Œå¦‚ desktop / tablet / mobile çš„è®¾è®¡ä¸Šï¼ˆ&lt;code&gt;sm&lt;/code&gt;,&lt;code&gt;md&lt;/code&gt;,&lt;code&gt;lg&lt;/code&gt;,&lt;code&gt;xl&lt;/code&gt;ï¼‰ã€‚æœ‰äº† screen ä¹‹åï¼Œä¸Šé¢çš„å…¬å¼å°±å˜ä¸º&lt;code&gt;{screen}:{property}-{color/spacing}&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ç”¨ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹æ¥æ¼”ç¤ºã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘æƒ³è¦ä¸€ä¸ªæœ‰æš—çº¢è‰²èƒŒæ™¯ï¼Œç™½è‰²æ–‡å­—ï¼Œä»¥åŠ padding ä¸º 6 çš„ DIVï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div class=&quot;bg-red-900 text-white p-6&quot;&amp;gt;Messi&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¥ä¸‹æ¥å¯ä»¥å†æ·»åŠ ä¸€äº›åˆ«çš„å·¥å…·ç±»ã€‚æƒ³è¦æŠŠè¿™ä¸ª DIV åœ¨æµè§ˆå™¨å†…å±…ä¸­ï¼Œå¯ç”¨&lt;code&gt;mx-auto&lt;/code&gt;ã€‚æƒ³è¦è®©å…¶å®½åº¦è‡ªåŠ¨æ‰©å±•ï¼Œå¯ç”¨&lt;code&gt;w-auto&lt;/code&gt;ã€‚æœ€åï¼Œæƒ³è¦è®©å…¶æ–‡å­—å±…ä¸­ï¼Œæ˜¾ç„¶ï¼Œç”¨&lt;code&gt;text-center&lt;/code&gt;å³å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div class=&quot;bg-red-900 p-6 mx-auto w-auto 
            text-white text-center &quot;&amp;gt;Messi&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ï¼Œåœ¨ desktop ä¸Šçœ‹èµ·æ¥å·²ç»å¾ˆå¥½äº†ã€‚ä¸è¿‡ï¼Œæˆ‘æƒ³åœ¨ mobile ä¸Š padding è¦æ›´å°ä¸€ç‚¹ã€‚æ­¤æ—¶ï¼Œå°±æ˜¯ screen å‘æŒ¥ä½œç”¨çš„æ—¶å€™äº†ã€‚é€‚é…ä¸åŒçš„ breakpoint å’Œ property èƒ½å¸¦æ¥å¾ˆå¤šå¥½å¤„ã€‚å‡è®¾é»˜è®¤ padding ä¸º 3ï¼Œè€Œä» phone è¿‡æ¸¡åˆ° tablet çš„å°ºå¯¸ï¼Œåˆ™ä½¿å…¶ padding å˜ä¸º 6ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div class=&quot;bg-red-900 p-3 md:p-6 mx-auto 
            w-auto text-white text-center&quot;&amp;gt;Messi&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€åï¼Œå†é’ˆå¯¹å„ breakpoint åˆ†åˆ«é€‚é…ä»¥é€‚å½“çš„æ–‡å­—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div class=&quot;bg-red-900 text-center p-3 
            mx-auto w-auto text-white text-center 
            text-md md:text-lg lg:text-2xl &quot;&amp;gt;Messi&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tailwindcss è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç±»ä¼¼çš„å·¥å…·ç±»ï¼Œ å®ƒçš„å®˜æ–¹æ–‡æ¡£ä¸­éƒ½æœ‰è¯¦ç»†è®²è¿°ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸€åˆ‡çœ‹èµ·æ¥æ˜¯â€œè¿‡åº¦è®¾è®¡â€äº†ï¼Œç„¶è€Œ Tailwindcss çš„é—ªå…‰ä¹‹å¤„ï¼Œå°±æ˜¯â€œç»„ä»¶é©±åŠ¨è®¾è®¡ï¼ˆcomponent driven designï¼‰â€ã€‚æŠŠè¿™äº›å·¥å…·ç±»ç”¨äºç»„ä»¶ä¹‹ä¸Šï¼Œç„¶åç»„ä»¶ç”¨äºç³»ç»Ÿå„å¤„ã€‚å¤šä¸ªç»„ä»¶åˆ™å¯æ„æˆç»„ä»¶åº“ã€‚ç»„ä»¶åº“å³ç±»ä¼¼äº Bootstrap é‡Œçš„ modal ä¹‹ç±»ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ä¸€äº›ç›¸å…³çš„-tailwindcss-component-é“¾æ¥&quot;&gt;ä¸€äº›ç›¸å…³çš„ Tailwindcss component é“¾æ¥&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;https://tailwindui.com/ Tailwindcss å®˜æ–¹çš„ UI kit ç«™ç‚¹&lt;/li&gt;
  &lt;li&gt;https://tailwindcomponents.com/ ä¸€ä¸ªç¤¾åŒºç±» components é›†åˆç«™ç‚¹&lt;/li&gt;
  &lt;li&gt;https://tailwind.build/editor ä¸€ä¸ª Tailwindcss component builder&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Sat, 10 Apr 2021 00:00:00 +0000</pubDate>
        <link>/2021/04/the-foundation-of-how-tailwindcss-works/</link>
        <guid isPermaLink="true">/2021/04/the-foundation-of-how-tailwindcss-works/</guid>
        
        <category>css</category>
        
        <category>tailwindcss</category>
        
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Hotwireä¹‹æ„å»ºTurboåº”ç”¨</title>
        <description>&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹æ„å»º Turbo åº”ç”¨çš„å…·ä½“æè¿°ï¼ŒåŸæ–‡å‡ºè‡ªï¼šhttps://turbo.hotwire.dev/handbook/buildingã€‚&lt;/p&gt;

&lt;p&gt;Turbo ä¹‹æ‰€ä»¥å¿«æ˜¯å› ä¸ºå½“ä½ ç‚¹å‡»é“¾æ¥æˆ–è€…æäº¤è¡¨å•æ—¶å®ƒé˜²æ­¢äº†æ•´ä¸ªé¡µé¢çš„é‡æ–°åŠ è½½ã€‚ä½ çš„åº”ç”¨æˆä¸ºæµè§ˆå™¨ä¸­å¸¸é©»è€Œä¸åœè¿è½¬çš„è¿›ç¨‹ã€‚è¿™å°±éœ€è¦ä½ é‡æ–°è€ƒè™‘ç»„ç»‡ä½ çš„ JavaScript çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;ç‰¹åˆ«æ˜¯ï¼Œä½ å¯ä»¥ä¸å†ä¾èµ–äºé¡µé¢çš„æ¯æ¬¡å¯¼èˆªæ—¶æ•´ä¸ªé¡µé¢çš„è½½å…¥æ¥é‡ç½®ä½ çš„ç¯å¢ƒã€‚JavaScript çš„&lt;code&gt;window&lt;/code&gt;å’Œ&lt;code&gt;document&lt;/code&gt;å¯¹è±¡åœ¨é¡µé¢å˜æ›´æœŸé—´ä¿æŒå…¶çŠ¶æ€ï¼Œè€Œä»»ä½•å…¶ä»–ä½ æ”¾å…¥å†…å­˜çš„å¯¹è±¡å°†ä¼šç•™åœ¨å†…å­˜ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†è¿™ä¸ªæ„è¯†ï¼Œå¹¶ç¨å¾®å°å¿ƒä¸€ç‚¹ï¼Œä½ å°±èƒ½å¯¹åº”ç”¨è¿›è¡Œè®¾è®¡ä»¥ä¼˜é›…åœ°å¤„ç†è¿™ç§çº¦æŸï¼Œè€Œæ— éœ€ä¸ Turbo ç´§å¯†è€¦åˆåœ¨ä¸€èµ·ã€‚&lt;/p&gt;

&lt;h2 id=&quot;working-with-script-elements&quot;&gt;Working with Script Elements&lt;/h2&gt;

&lt;p&gt;æµè§ˆå™¨ä¼šè‡ªåŠ¨è½½å…¥å¹¶æ‰§è¡Œä»»ä½•åˆå§‹é¡µé¢åŠ è½½çš„&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;å…ƒç´ ã€‚&lt;/p&gt;

&lt;p&gt;å½“ä½ å¯¼èˆªåˆ°ä¸€ä¸ªæ–°é¡µé¢æ—¶ï¼ŒTurbo Drive å°±æŸ¥æ‰¾åœ¨æ–°é¡µé¢çš„&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­çš„ä»»ä½•&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œä¸”å…¶æœªå‡ºç°äºå½“å‰é¡µé¢ä¸Šã€‚ç„¶åï¼ŒTurbo Drive æŠŠå®ƒä»¬ append åˆ°å½“å‰çš„&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ï¼Œæµè§ˆå™¨å¯¹å…¶è¿›è¡ŒåŠ è½½å’Œæ‰§è¡Œã€‚ä½ å¯ä»¥ç”±æ­¤æ¥æŒ‰éœ€åŠ è½½é¢å¤–çš„ JavaScript æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Drive åœ¨æ¯æ¬¡æ¸²æŸ“é¡µé¢æ—¶æ‰§è¡Œè¯¥é¡µé¢&lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt;ä¸­çš„&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;å…ƒç´ ã€‚ä½ å¯ä»¥ä½¿ç”¨ inline body script æ¥å»ºç«‹æ¯ä¸ªé¡µé¢çš„ JavaScript çŠ¶æ€æˆ–è€…å¯åŠ¨å®¢æˆ·ç«¯çš„ modelã€‚è¦å»ºç«‹æŸäº›è¡Œä¸ºï¼Œæˆ–åœ¨é¡µé¢å˜æ›´æ—¶æ‰§è¡Œæ›´å¤æ‚çš„æ“ä½œï¼Œé¿å…ä½¿ç”¨ script å…ƒç´ ï¼Œä½¿ç”¨&lt;code&gt;turbo:load&lt;/code&gt;äº‹ä»¶æ¥ä»£æ›¿ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ ä¸æƒ³ Turbo åœ¨é¡µé¢æ¸²æŸ“åæ‰§è¡Œ&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œå°±ä½¿ç”¨&lt;code&gt;data-turbo-eval=&quot;false&quot;&lt;/code&gt;å¯¹å…¶è¿›è¡Œæ³¨è§£ã€‚æ³¨æ„ï¼Œè¿™ç§æ³¨è§£ä¸ä¼šé˜²æ­¢æµè§ˆå™¨åœ¨åˆå§‹é¡µé¢åŠ è½½æ—¶æ‰§è¡Œè¿™äº› scriptsã€‚&lt;/p&gt;

&lt;h3 id=&quot;loading-your-applications-javascript-bundle&quot;&gt;Loading Your Applicationâ€™s JavaScript Bundle&lt;/h3&gt;

&lt;p&gt;è¦æ€»æ˜¯ç¡®ä¿åœ¨&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­ä½¿ç”¨&lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;å…ƒç´ æ¥åŠ è½½ä½ åº”ç”¨çš„ JavaScript æ‰“åŒ…æ–‡ä»¶ã€‚å¦åˆ™ï¼ŒTurbo Drive å°†ä¼šåœ¨æ¯æ¬¡é¡µé¢å˜æ›´æ—¶éƒ½é‡è½½å®ƒã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;head&amp;gt;
  ...
  &amp;lt;script src=&quot;/application-cbd3cd4.js&quot; defer&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ ä¹Ÿåº”è¯¥è€ƒè™‘æŠŠ asset æ‰“åŒ…ç³»ç»Ÿé…ç½®æˆç»™æ¯ä¸ª script åŠ ä¸ŠæŒ‡çº¹ï¼Œè¿™æ ·å½“å…¶å†…å®¹å˜åŠ¨æ—¶å°±ä¼šæ˜¯ä¸€ä¸ªæ–°çš„ URLã€‚ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨&lt;code&gt;data-turbo-track&lt;/code&gt;å±æ€§æ¥å¼ºåˆ¶å½“éƒ¨ç½²äº†æ–° JavaScript æ‰“åŒ…æ–‡ä»¶ä¹‹ååšä¸€æ¬¡å…¨é¡µé¢é‡è½½ã€‚å‚çœ‹ &lt;a href=&quot;https://turbo.hotwire.dev/handbook/drive#reloading-when-assets-change&quot;&gt;Assets å˜æ›´åé‡è½½&lt;/a&gt; å¯è·å¾—æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;

&lt;h2 id=&quot;understanding-caching&quot;&gt;Understanding Caching&lt;/h2&gt;

&lt;p&gt;Turbo Drive ç»´æŠ¤ç€è¿‘æœŸè®¿é—®é¡µé¢çš„ä¸€ä¸ªç¼“å­˜ã€‚è¯¥ç¼“å­˜æœ‰ä¸¤ä¸ªç›®çš„ï¼šåœ¨ restoration è®¿é—®æœŸé—´å±•ç¤ºé¡µé¢æ— éœ€è®¿é—®ç½‘ç»œï¼Œå’Œåœ¨ application è®¿é—®æœŸé—´é€šè¿‡æ˜¾ç¤ºä¸´æ—¶æ€§çš„é¢„è§ˆæ¥æå‡å¯æ„ŸçŸ¥çš„æ€§èƒ½ã€‚&lt;/p&gt;

&lt;p&gt;å½“é€šè¿‡ history å¯¼èˆªï¼ˆä»¥ &lt;a href=&quot;https://turbo.hotwire.dev/handbook/drive#restoration-visits&quot;&gt;Restoration è®¿é—®&lt;/a&gt;ï¼‰ï¼Œåªè¦å¯èƒ½ï¼ŒTurbo Drive å°†ä»ç¼“å­˜æ¢å¤é¡µé¢è€Œæ— éœ€ä»ç½‘ç»œåŠ è½½ä¸€ä¸ªå…¨æ–°çš„æ‹·è´ã€‚&lt;/p&gt;

&lt;p&gt;å¦åˆ™ï¼Œåœ¨æ ‡å‡†å¯¼èˆªæœŸé—´ï¼ˆä»¥ &lt;a href=&quot;https://turbo.hotwire.dev/handbook/drive#application-visits&quot;&gt;Application è®¿é—®&lt;/a&gt;ï¼‰ï¼ŒTurbo Drive å°†ä»ç¼“å­˜ä¸­ç«‹å³æ¢å¤é¡µé¢ä½œä¸ºä¸€ä¸ªé¢„è§ˆï¼Œå¹¶åŒæ—¶ä»ç½‘ç»œåŠ è½½ä¸€ä¸ªå…¨æ–°æ‹·è´ã€‚è¿™å°±ç»™ç»å¸¸è®¿é—®çš„ä½ç½®å¸¦æ¥äº†ç¬æ—¶é¡µé¢åŠ è½½çš„é”™è§‰ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Drive åœ¨æ¸²æŸ“æ–°é¡µé¢ä¹‹å‰ï¼ŒæŠŠå½“å‰é¡µé¢çš„ä¸€ä¸ªæ‹·è´ä¿å­˜åˆ°å…¶ç¼“å­˜ä¸­ã€‚æ³¨æ„ï¼ŒTurbo Drive ä½¿ç”¨äº†&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode&quot;&gt;&lt;code&gt;cloneNode(true)&lt;/code&gt;&lt;/a&gt; æ¥æ‹·è´é¡µé¢ï¼Œè¿™æ„å‘³ç€ä»»ä½• attach çš„äº‹ä»¶ç›‘å¬åŠå…³è”æ•°æ®éƒ½è¢«ä¸¢å¼ƒæ‰ã€‚&lt;/p&gt;

&lt;h3 id=&quot;preparing-the-page-to-be-cached&quot;&gt;Preparing the Page to be Cached&lt;/h3&gt;

&lt;p&gt;å¦‚æœä½ éœ€è¦åœ¨ Turbo Drive ç¼“å­˜å¯¹å…¶ä¹‹å‰å‡†å¤‡ documentï¼Œå¯ä»¥ç›‘å¬&lt;code&gt;turbo-cache&lt;/code&gt;äº‹ä»¶ã€‚ä½¿ç”¨è¯¥äº‹ä»¶æ¥é‡ç½®è¡¨å•ã€æ”¶èµ·æ‰€å±•å¼€çš„ UI å…ƒç´ ã€æˆ–æ¸…ç†ä»»ä½•ç¬¬ä¸‰æ–¹çš„ widgetsï¼Œä»¥ä¾¿å‡†å¤‡å¥½é‡æ–°æ˜¾ç¤ºè¯¥é¡µé¢ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;document.addEventListener(&quot;turbo:before-cache&quot;, function() {
  // ...
})
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;detecting-when-a-preview-is-visible&quot;&gt;Detecting When a Preview is Visible&lt;/h3&gt;

&lt;p&gt;å½“ Turbo Drive ä»ç¼“å­˜ä¸­å±•ç¤ºä¸€ä¸ªé¢„è§ˆæ—¶ï¼Œå®ƒå‘&lt;code&gt;&amp;lt;html&amp;gt;&lt;/code&gt;å…ƒç´ ä¸Šæ·»åŠ äº†ä¸€ä¸ª&lt;code&gt;turbo-preview&lt;/code&gt;å±æ€§ã€‚å½“ä¸€ä¸ªé¢„è§ˆå¯è§çš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥æ£€æŸ¥è¯¥å±æ€§çš„å­˜åœ¨è€Œæœ‰é€‰æ‹©åœ°å¯ç”¨æˆ–ç¦ç”¨è¡Œä¸ºã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;if (document.documentElement.hasAttribute(&quot;data-turbo-preview&quot;)) {
  // Turbo Drive is displaying a preview
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;opting-out-of-caching&quot;&gt;Opting Out of Caching&lt;/h3&gt;

&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡åœ¨é¡µé¢çš„&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­åŒ…å«&lt;code&gt;&amp;lt;meta name =&quot;turbo-cache-control&quot;&amp;gt;&lt;/code&gt;å…ƒç´ å¹¶å£°æ˜ä¸€ä¸ªç¼“å­˜æŒ‡ä»¤æ¥æ§åˆ¶æ¯ä¸ªé¡µé¢çš„ç¼“å­˜è¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨&lt;code&gt;no-preview&lt;/code&gt;æŒ‡ä»¤æ¥æŒ‡å®šåœ¨ application è®¿é—®æœŸé—´ï¼Œé¡µé¢çš„ä¸€ä¸ªç¼“å­˜ç‰ˆæœ¬ä¸ä½œä¸ºé¢„è§ˆè¢«æ˜¾ç¤ºã€‚è¢«æ ‡æ³¨äº† no-preview çš„é¡µé¢å°†åªè¢«ç”¨äº restoration è®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;è¦æŒ‡å®šä¸€ä¸ªé¡µé¢å®Œå…¨ä¸åº”è¯¥è¢«ç¼“å­˜ï¼Œä½¿ç”¨&lt;code&gt;no-cache&lt;/code&gt;æŒ‡ä»¤ã€‚è¢«æ ‡æ³¨äº† no-cache çš„é¡µé¢å°†æ€»æ˜¯é€šè¿‡ç½‘ç»œè·å–ï¼ŒåŒ…æ‹¬åœ¨ restoration è®¿é—®æœŸé—´ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;head&amp;gt;
  ...
  &amp;lt;meta name=&quot;turbo-cache-control&quot; content=&quot;no-cache&quot;&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¦å®Œå…¨ç¦ç”¨åº”ç”¨ä¸­çš„ç¼“å­˜ï¼Œå°±è¦ç¡®ä¿æ¯ä¸ªé¡µé¢éƒ½åŒ…å« no-cache æŒ‡ä»¤ã€‚&lt;/p&gt;

&lt;h2 id=&quot;installing-javascript-behavior&quot;&gt;Installing JavaScript Behavior&lt;/h2&gt;

&lt;p&gt;ä½ å¯èƒ½ä¹ æƒ¯äºåŠ å…¥ JavaScript è¡Œä¸ºæ¥å“åº”&lt;code&gt;window.onload&lt;/code&gt;ï¼Œ&lt;code&gt;DOMContentLoaded&lt;/code&gt;ï¼Œæˆ–è€… JQuery çš„&lt;code&gt;ready&lt;/code&gt;äº‹ä»¶ã€‚ä½¿ç”¨ Turbo æ—¶ï¼Œè¿™äº›äº‹ä»¶å°†åªåœ¨åˆå§‹é¡µé¢åŠ è½½æ—¶è¢«è§¦å‘ï¼Œä¹‹åçš„ä»»ä½•åç»­é¡µé¢å˜æ›´éƒ½ä¸ä¼šè§¦å‘ã€‚æˆ‘ä»¬æ¥æ¯”è¾ƒä¸‹æŠŠ JavaScript è¡Œä¸ºè¿æ¥åˆ° DOM çš„ä¸¤ç§ç­–ç•¥ã€‚&lt;/p&gt;

&lt;h3 id=&quot;observing-navigation-events&quot;&gt;Observing Navigation Events&lt;/h3&gt;

&lt;p&gt;Turbo Drive åœ¨å¯¼èˆªæœŸé—´è§¦å‘ä¸€ç³»åˆ—äº‹ä»¶ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯&lt;code&gt;turbo:load&lt;/code&gt;äº‹ä»¶ï¼Œå…¶åªåœ¨åˆå§‹é¡µé¢åŠ è½½æ—¶è§¦å‘ä¸€æ¬¡ï¼Œå¹¶åœ¨æ¯æ¬¡ Turbo Drive è®¿é—®æ—¶è§¦å‘ä¸€æ¬¡ã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥åœ¨&lt;code&gt;DOMContentLoaded&lt;/code&gt;å†…ç›‘å¬&lt;code&gt;turbo:load&lt;/code&gt;äº‹ä»¶æ¥åœ¨æ¯æ¬¡é¡µé¢å˜æ›´æ—¶å»ºç«‹ JavaScript è¡Œä¸ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;document.addEventListener(&quot;turbo:load&quot;, function() {
  // ...
})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è®°ä½ï¼Œå½“è¯¥äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œä½ çš„åº”ç”¨ä¸ä¼šæ€»æ˜¯åœ¨ä¸€ä¸ªå´­æ–°çš„çŠ¶æ€ï¼Œè€Œä½ å°±å¯èƒ½éœ€è¦æ¸…ç†å‰ä¸€ä¸ªé¡µé¢æ‰€å»ºç«‹çš„è¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;ä¹Ÿè¦æ³¨æ„ï¼ŒTurbo Drive çš„å¯¼èˆªå¯èƒ½ä¸æ˜¯ä½ åº”ç”¨ä¸­çš„é¡µé¢æ›´æ–°çš„å”¯ä¸€æºå¤´ï¼Œæ‰€ä»¥ä½ å¯èƒ½æœŸæœ›æŠŠä½ çš„åˆå§‹åŒ–ä»£ç ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°å†…ï¼Œä½ å¯ä»¥ä»&lt;code&gt;turbo:load&lt;/code&gt;å’Œä»»ä½•å…¶ä»–å¯èƒ½å˜æ›´ DOM çš„åœ°æ–¹æ¥è°ƒç”¨å®ƒ&lt;/p&gt;

&lt;p&gt;å¯èƒ½çš„è¯ï¼Œé¿å…ä½¿ç”¨&lt;code&gt;turbo:load&lt;/code&gt;äº‹ä»¶æ¥æŠŠå…¶ä»–äº‹ä»¶ç›‘å¬å™¨ç›´æ¥æ·»åŠ åˆ°é¡µé¢ body çš„å…ƒç´ ä¸Šã€‚ç›¸åï¼Œè€ƒè™‘ä½¿ç”¨&lt;a href=&quot;https://learn.jquery.com/events/event-delegation/&quot;&gt;äº‹ä»¶å§”æ‰˜&lt;/a&gt;æ¥æŠŠäº‹ä»¶ç›‘å¬å™¨æ³¨å†Œåˆ°&lt;code&gt;document&lt;/code&gt;æˆ–&lt;code&gt;window&lt;/code&gt;ä»…ä¸€æ¬¡ã€‚&lt;/p&gt;

&lt;p&gt;å‚çœ‹&lt;a href=&quot;https://turbo.hotwire.dev/reference/events&quot;&gt;å…¨éƒ¨äº‹ä»¶åˆ—è¡¨&lt;/a&gt;è·å–æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;

&lt;h3 id=&quot;attaching-behavior-with-stimulus&quot;&gt;Attaching Behavior With Stimulus&lt;/h3&gt;

&lt;p&gt;æ–° DOM å…ƒç´ å¯ä»¥åœ¨ä»»ä½•æ—¶åˆ»å‘ˆç°åœ¨é¡µé¢ä¸Šï¼Œé€šè¿‡ frame å¯¼èˆªã€stream ä¿¡æ¯ã€æˆ–å®¢æˆ·ç«¯æ¸²æŸ“æ“ä½œç­‰æ–¹å¼ï¼Œè€Œè¿™äº›å…ƒç´ ç»å¸¸éœ€è¦å¦‚åŒå‡ºç°äºä¸€ä¸ªå…¨æ–°é¡µé¢åŠ è½½é‚£æ ·è¢«åˆå§‹åŒ–ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºæ‰€æœ‰è¿™äº›æ›´æ–°ï¼ŒåŒ…æ‹¬ä» Turbo Drive é¡µé¢åŠ è½½çš„æ›´æ–°ï¼Œä½ å¯ä»¥å€ŸåŠ©äº Turbo çš„å…„å¼Ÿæ¡†æ¶ &lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;Stimulus&lt;/a&gt; æ‰€æä¾›çš„çº¦å®šå’Œå›è°ƒç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹æ¥å¤„ç†å®ƒä»¬ã€‚&lt;/p&gt;

&lt;p&gt;Stimulus è®©ä½ ä½¿ç”¨ controllerã€action å’Œ target å±æ€§å¯¹ HTML è¿›è¡Œæ³¨é‡Šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div data-controller=&quot;hello&quot;&amp;gt;
  &amp;lt;input data-hello-target=&quot;name&quot; type=&quot;text&quot;&amp;gt;
  &amp;lt;button data-action=&quot;click-&amp;gt;hello#greet&quot;&amp;gt;Greet&amp;lt;/button&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®ç°å…¶ç›¸åº”çš„ controller å¹¶ç”± Stimulus è‡ªåŠ¨è¿æ¥åˆ°å®ƒï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;// hello_controller.js
import { Controller } from &quot;stimulus&quot;

export default class extends Controller {
  greet() {
    console.log(`Hello, ${this.name}!`)
  }

  get name() {
    return this.targets.find(&quot;name&quot;).value
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Stimulus ä½¿ç”¨ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver&quot;&gt;MutationObserver&lt;/a&gt; APIï¼Œåªè¦ document å‘ç”Ÿå˜æ›´ï¼Œè¿™äº› controllers å’Œå®ƒä»¬ç›¸å…³è”çš„äº‹ä»¶å¤„ç†å™¨å°±ä¼šè¢«è¿æ¥åŠæ–­å¼€è¿æ¥ã€‚ç»“æœå°±æ˜¯ï¼Œå®ƒä¼šå¤„ç† Turbo Drive é¡µé¢å˜æ›´ã€Turbo Frames å¯¼èˆªã€ä»¥åŠ Turbo Streams ä¿¡æ¯ï¼Œä»¥å®ƒå¤„ç†å…¶ä»–ç±»å‹ DOM æ›´æ–°å®Œå…¨åŒæ ·çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;h2 id=&quot;making-transformations-idempotent&quot;&gt;Making Transformations Idempotent&lt;/h2&gt;

&lt;p&gt;ä½ ç»å¸¸ä¼šæƒ³è¦åœ¨å®¢æˆ·ç«¯å¯¹æ¥æ”¶è‡ªæœåŠ¡ç«¯çš„ HTML æ‰§è¡Œå˜æ¢ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³åˆ©ç”¨æµè§ˆå™¨å¯¹ç”¨æˆ·å½“å‰æ—¶åŒºçš„äº†è§£æ¥æŒ‰æ—¥æœŸå¯¹å…ƒç´ é›†åˆè¿›è¡Œåˆ†ç»„ã€‚&lt;/p&gt;

&lt;p&gt;å‡è®¾ä½ å·²ç»å¯¹ä¸€ç»„å…ƒç´ æ³¨é‡Šä»¥&lt;code&gt;data-timestamp&lt;/code&gt;å±æ€§æ¥æŒ‡ç¤ºå…¶ UTC åˆ›å»ºæ—¶é—´ã€‚ä½ æœ‰ä¸€ä¸ª JavaScript å‡½æ•°æ¥æŸ¥è¯¢ document ä¸­æ‰€æœ‰è¿™æ ·çš„å…ƒç´ ï¼ŒæŠŠæ—¶é—´æˆ³è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´ï¼Œå¹¶åœ¨æ¯ä¸ªå‘ç”Ÿäºæ–°çš„ä¸€å¤©çš„å…ƒç´ ä¹‹å‰æ’å…¥æ—¥æœŸè¡¨å¤´ã€‚&lt;/p&gt;

&lt;p&gt;è€ƒè™‘ä¸‹å¦‚æœä½ å·²ç»é…ç½®å¥½è¯¥å‡½æ•°åœ¨&lt;code&gt;turbo:load&lt;/code&gt;ä¸Šæ‰§è¡Œçš„è¯ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å½“ä½ å¯¼èˆªåˆ°è¯¥é¡µé¢ï¼Œä½ çš„å‡½æ•°æ’å…¥äº†æ—¥æœŸè¡¨å¤´ã€‚å†ç¦»å¼€è¯¥é¡µé¢ï¼Œåˆ™ Turbo Drive æŠŠä¸€ä¸ªå˜æ¢åé¡µé¢çš„æ‹·è´å­˜å…¥ç¼“å­˜ã€‚ç°åœ¨æŒ‰ä¸‹æµè§ˆå™¨å›é€€æŒ‰é’®â€”â€”Turbo Drive æ¢å¤é¡µé¢ï¼Œå†æ¬¡è§¦å‘&lt;code&gt;turbo:load&lt;/code&gt;ï¼Œåˆ™ä½ çš„å‡½æ•°æ’å…¥ç¬¬äºŒä¸ªæ—¥æœŸè¡¨å¤´ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦è®©ä½ çš„è½¬æ¢å‡½æ•°æ˜¯&lt;em&gt;å¹‚ç­‰çš„&lt;/em&gt;ã€‚å¹‚ç­‰è½¬æ¢èƒ½å®‰å…¨åœ°æ‰§è¡Œå¤šæ¬¡è€Œä¸ä¼šæ”¹å˜å…¶æœ€åˆåº”ç”¨çš„ç»“æœã€‚&lt;/p&gt;

&lt;p&gt;ä½¿è½¬æ¢å¹‚ç­‰çš„ä¸€ç§æŠ€æœ¯æ˜¯é€šè¿‡åœ¨æ¯ä¸ªå¤„ç†çš„å…ƒç´ ä¸Šè®¾ç½®ä¸€ä¸ª&lt;code&gt;data&lt;/code&gt;å±æ€§æ¥è·Ÿè¸ªæ˜¯å¦å·²ç»æ‰§è¡Œäº†å˜æ¢ã€‚å½“ Turbo Drive ä»ç¼“å­˜ä¸­æ¢å¤é¡µé¢æ—¶ï¼Œè¿™äº›å±æ€§ä¼šä»ç„¶å­˜åœ¨ã€‚åœ¨ä½ çš„å‡½æ•°ä¸­æ£€æµ‹è¿™äº›å±æ€§ä»¥ç¡®å®šå“ªä¸ªå…ƒç´ å·²ç»è¢«å¤„ç†è¿‡äº†ã€‚&lt;/p&gt;

&lt;p&gt;æ›´å¥å£®çš„ä¸€ç§æŠ€æœ¯æ˜¯ç®€å•åœ°æ£€æµ‹è½¬æ¢è‡ªèº«ã€‚åœ¨ä¸Šé¢æ—¥æœŸåˆ†ç»„çš„ç¤ºä¾‹ä¸­ï¼Œè¿™æ„å‘³ç€åœ¨æ’å…¥ä¸€ä¸ªæ–°æ—¥æœŸåˆ†å‰²çº¿ä¹‹å‰æ£€æŸ¥å…¶å­˜åœ¨ä¸å¦ã€‚è¿™ä¸ªæ–¹æ¡ˆä¼˜é›…åœ°å¤„ç†äº†æœªè¢«åˆå§‹è½¬æ¢æ‰€å¤„ç†çš„æ–°æ’å…¥å…ƒç´ ã€‚&lt;/p&gt;

&lt;h2 id=&quot;persisting-elements-across-page-loads&quot;&gt;Persisting Elements Across Page Loads&lt;/h2&gt;

&lt;p&gt;Turbo Drive å…è®¸ä½ æŠŠæŸäº›å…ƒç´ æ ‡æ³¨ä¸º &lt;em&gt;permanent&lt;/em&gt;ã€‚Permanent å…ƒç´ åœ¨é¡µé¢åŠ è½½ä¹‹é—´éƒ½å­˜ç•™ç€ï¼Œæ‰€ä»¥ä½ å¯¹è¿™äº›å…ƒç´ çš„ä»»ä½•å˜æ›´éƒ½ä¸éœ€è¦åœ¨é¡µé¢å¯¼èˆªä¹‹åå†æ¬¡èµ‹äºˆã€‚&lt;/p&gt;

&lt;p&gt;è€ƒè™‘ä¸‹ä¸€ä¸ªå¸¦è´­ç‰©è½¦çš„ Turbo Drive åº”ç”¨ã€‚åœ¨æ¯ä¸ªé¡µé¢é¡¶éƒ¨éƒ½æ˜¯ä¸€ä¸ªå›¾æ ‡ï¼Œæœ‰å½“å‰åœ¨è´­ç‰©è½¦å†…çš„å•†å“æ•°é‡ã€‚è¿™ä¸ªè®¡æ•°å™¨æ˜¯å€ŸåŠ© JavaScript åŠ¨æ€æ›´æ–°çš„ï¼Œå½“å•†å“è¢«æ·»åŠ å’Œç§»é™¤æ—¶ã€‚&lt;/p&gt;

&lt;p&gt;ç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·åœ¨è¯¥åº”ç”¨ä¸­å·²ç»å¯¼èˆªåˆ°è¿‡å¤šä¸ªé¡µé¢ã€‚å¥¹æ·»åŠ ä¸€ä¸ªå•†å“åˆ°è´­ç‰©è½¦ï¼Œç„¶åæŒ‰ä¸‹æµè§ˆå™¨å›é€€æŒ‰é’®ã€‚Turbo Drive ä»ç¼“å­˜ä¸­æ¢å¤äº†å‰ä¸€ä¸ªé¡µé¢çš„çŠ¶æ€ï¼Œè€Œè´­ç‰©è½¦çš„å•†å“è®¡æ•°è¢«é”™è¯¯åœ°ä» 1 å˜ä¸º 0ã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ä½¿è®¡æ•°å™¨å…ƒç´  permanent æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚è¦åˆ¶å®šå…ƒç´ ä¸º permanentï¼Œèµ‹äºˆå®ƒä»¬ä¸€ä¸ª HTML &lt;code&gt;id&lt;/code&gt;ï¼Œå¹¶ä»¥&lt;code&gt;data-turbo-permanent&lt;/code&gt;æ¥æ³¨é‡Šå®ƒä»¬ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div id=&quot;cart-counter&quot; data-turbo-permanent&amp;gt;1 item&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¯æ¬¡æ¸²æŸ“ä¹‹å‰ï¼ŒTurbo Drive é€šè¿‡ ID åŒ¹é…åˆ°æ‰€æœ‰çš„ permanent å…ƒç´ ï¼Œå¹¶æŠŠå®ƒä»¬ä»åˆå§‹é¡µé¢è½¬æ¢åˆ°æ–°é¡µé¢ï¼Œä¿ç•™å…¶æ•°æ®å’Œäº‹ä»¶ç›‘å¬å™¨ã€‚&lt;/p&gt;

</description>
        <pubDate>Fri, 26 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/hotwire-build-turbo-application/</link>
        <guid isPermaLink="true">/2021/03/hotwire-build-turbo-application/</guid>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Hotwireä¹‹ä½¿ç”¨Turbo Streamsç„•å‘æ´»åŠ›</title>
        <description>&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹ Turbo Streams çš„è¯¦ç»†è¯´æ˜ï¼ŒåŸæ–‡å‡ºè‡ªï¼š&lt;a href=&quot;https://turbo.hotwire.dev/handbook/streams&quot;&gt;https://turbo.hotwire.dev/handbook/streams&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Streams å°†é¡µé¢çš„æ›´æ”¹å‘å¸ƒä¸ºåŒ…åœ¨è‡ªè§£é‡Šçš„&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ä¸­çš„ HTML ç‰‡æ®µã€‚æ¯ä¸ª stream å…ƒç´ éƒ½ä¼šåŒæ—¶æŒ‡å®šä¸€ä¸ª action å’Œ target IDï¼Œä»¥å£°æ˜å…¶å†…çš„ HTML ä¼šæ€æ ·å¤„ç†ã€‚è¿™äº›å…ƒç´ è¢«æœåŠ¡ç«¯é€šè¿‡ WebSocketã€SSE æˆ–å…¶ä»–ä¼ è¾“æ–¹å¼å‘å¸ƒï¼Œå€ŸåŠ©ç”±å…¶ä»–ç”¨æˆ·æˆ–è¿›ç¨‹è¿›è¡Œçš„æ›´æ–°ä½¿åº”ç”¨ç¨‹åºç„•å‘æ´»åŠ›ã€‚æŠµè¾¾ä½ çš„ imbox çš„æ–°é‚®ä»¶å°±æ˜¯ä¸€ä¸ªç»ä½³çš„èŒƒä¾‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;stream-messages-and-actions&quot;&gt;Stream Messages and Actions&lt;/h2&gt;

&lt;p&gt;ä¸€ä¸ª Turbo Streams æ¶ˆæ¯æ˜¯ä¸€ä¸ªç”±&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ç»„æˆçš„ HTML ç‰‡æ®µã€‚ä¸‹é¢çš„ stream æ¶ˆæ¯æ¼”ç¤ºäº†äº”ç§å¯ç”¨çš„ stream actionsï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-stream action=&quot;append&quot; target=&quot;messages&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;
      This div will be appended to the element with the DOM ID &quot;messages&quot;.
    &amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;

&amp;lt;turbo-stream action=&quot;prepend&quot; target=&quot;messages&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;
      This div will be prepended to the element with the DOM ID &quot;messages&quot;.
    &amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;

&amp;lt;turbo-stream action=&quot;replace&quot; target=&quot;message_1&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;
      This div will replace the existing element with the DOM ID &quot;message_1&quot;.
    &amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;

&amp;lt;turbo-stream action=&quot;update&quot; target=&quot;unread_count&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;!-- The contents of this template will replace the
    contents of the element with ID &quot;unread_count&quot;. --&amp;gt;
    1
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;

&amp;lt;turbo-stream action=&quot;remove&quot; target=&quot;message_1&quot;&amp;gt;
  &amp;lt;!-- The element with DOM ID &quot;message_1&quot; will be removed.
  The contents of this stream element are ignored. --&amp;gt;
&amp;lt;/turbo-stream&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼Œæ¯ä¸ª&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ éƒ½å¿…é¡»æŠŠå®ƒå†…å«çš„ HTML åŒ…è£¹åœ¨ä¸€ä¸ª&lt;code&gt;&amp;lt;template&amp;gt;&lt;/code&gt;å…ƒç´ ä¹‹å†…ã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬çš„ stream æ¶ˆæ¯ä¸­æ¸²æŸ“ä»»æ„æ•°é‡çš„ stream å…ƒç´ ï¼Œè¯¥æ¶ˆæ¯æ¥è‡ªäº WebSocketã€SSE æˆ–è€…æ˜¯ä¸€ä¸ªè¡¨å•æäº¤åçš„å“åº”ã€‚&lt;/p&gt;

&lt;h2 id=&quot;streaming-from-http-responses&quot;&gt;Streaming From HTTP Responses&lt;/h2&gt;

&lt;p&gt;Turbo çŸ¥é“è‡ªåŠ¨é™„å¸¦ä¸Šé‚£äº›&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œå½“å®ƒä»¬ä»¥&lt;code&gt;&amp;lt;form&amp;gt;&lt;/code&gt;æäº¤çš„å“åº”è¿”å›å¹¶å£°æ˜äº†ä¸€ä¸ª&lt;code&gt;text/vnd.turbo-stream.html&lt;/code&gt;çš„ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types&quot;&gt;MIME type&lt;/a&gt; æ—¶ã€‚å½“æäº¤å…¶ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#attr-method&quot;&gt;method&lt;/a&gt; å±æ€§è¢«è®¾ç½®ä¸º&lt;code&gt;POST&lt;/code&gt;ã€&lt;code&gt;PUT&lt;/code&gt;ã€&lt;code&gt;PATCH&lt;/code&gt;æˆ–&lt;code&gt;DELETE&lt;/code&gt; çš„ &lt;code&gt;&amp;lt;form&amp;gt;&lt;/code&gt;å…ƒç´ æ—¶ï¼ŒTurbo å°±ä¼šæŠŠ &lt;code&gt;text/vnd.turbo-stream.html&lt;/code&gt; æ³¨å…¥åˆ°è¯·æ±‚çš„ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept&quot;&gt;Accept&lt;/a&gt; header ä¸­çš„å“åº”æ ¼å¼é›†ä¹‹å†…ã€‚åœ¨å¯¹å…¶ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept&quot;&gt;Accept&lt;/a&gt; header åŒ…å«äº†è¿™äº›å€¼çš„è¯·æ±‚è¿›è¡Œå“åº”æ—¶ï¼ŒæœåŠ¡ç«¯å°±å¯ä»¥è°ƒæ•´ç›¸åº”ä»¥å¤„ç† Turbo Streamsï¼ŒHTTP é‡å®šå‘ï¼Œæˆ–è€…ä¸æ”¯æŒ streams çš„å…¶ä»–ç±»å‹çš„å®¢æˆ·ç«¯ï¼ˆæ¯”å¦‚åŸç”Ÿåº”ç”¨ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä¸€ä¸ª Rails controller ä¸­ï¼Œçœ‹èµ·æ¥ä¼šæ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-ruby&quot;&gt;def destroy
  @message = Message.find(params[:id])
  @message.destroy

  respond_to do |format|
    format.turbo_stream { render turbo_stream: turbo_stream.remove(@message) }
    format.html         { redirect_to messages_url }
  end
end
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;reusing-server-side-templates&quot;&gt;Reusing Server-Side Templates&lt;/h2&gt;

&lt;p&gt;Turbo Streams çš„å…³é”®æ˜¯é‡ç”¨ä½ ç°æœ‰çš„æœåŠ¡ç«¯æ¨¡æ¿ä»¥æ‰§è¡Œå®æ—¶çš„éƒ¨åˆ†é¡µé¢æ›´æ”¹çš„èƒ½åŠ›ã€‚åœ¨é¡µé¢é¦–æ¬¡åŠ è½½æ—¶ç”¨æ¥æ¸²æŸ“æ¶ˆæ¯åˆ—è¡¨ä¸­æ¯ä¸€æ¡æ¶ˆæ¯çš„ HTML æ¨¡æ¿ï¼Œè·Ÿç”¨æ¥åœ¨ä¹‹ååŠ¨æ€æ·»åŠ åˆ°åˆ—è¡¨çš„ä¸€æ¡æ–°æ¶ˆæ¯çš„æ¨¡æ¿ï¼Œä¼šæ˜¯ç›¸åŒçš„ã€‚&lt;strong&gt;è¿™å°±æ˜¯ HTML-over-the-wire æ–¹æ¡ˆçš„æœ¬è´¨å’Œç²¾åï¼šä½ ä¸éœ€è¦å†æŠŠæ–°æ¶ˆæ¯åºåˆ—åŒ–ä¸º JSONï¼Œåœ¨ JavaScript ä¸­æ¥æ”¶å®ƒï¼Œå¹¶æ¸²æŸ“ä¸€ä¸ªå®¢æˆ·ç«¯çš„æ¨¡æ¿ã€‚&lt;/strong&gt;å®ƒå°±æ˜¯æ ‡å‡†çš„å¯é‡ç”¨çš„æœåŠ¡ç«¯æ¨¡æ¿ã€‚&lt;/p&gt;

&lt;p&gt;å¦ä¸€ä¸ª Rails ä¸­çš„ä¾‹å­çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-erb&quot;&gt;&amp;lt;!-- app/views/messages/_message.html.erb --&amp;gt;
&amp;lt;div id=&quot;&amp;lt;%= dom_id message %&amp;gt;&quot;&amp;gt;
  &amp;lt;%= message.content %&amp;gt;
&amp;lt;/div&amp;gt;

&amp;lt;!-- app/views/messages/index.html.erb --&amp;gt;
&amp;lt;h1&amp;gt;All the messages&amp;lt;/h1&amp;gt;
&amp;lt;%= render partial: &quot;messages/message&quot;, collection: @messages %&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&quot;language-ruby&quot;&gt;# app/controllers/messages_controller.rb
class MessagesController &amp;lt; ApplicationController
  def index
    @messages = Message.all
  end

  def create
    message = Message.create!(params.require(:message).permit(:content))

    respond_to do |format|
      format.turbo_stream do
        render turbo_stream: turbo_stream.append(:messages, partial: &quot;messages/message&quot;,
          locals: { message: message })
      end

      format.html { redirect_to messages_url }
    end
  end
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“åˆ›å»ºä¸€æ¡æ–°æ¶ˆæ¯çš„è¡¨å•æäº¤ç»™&lt;code&gt;MessagesController#create&lt;/code&gt; action æ—¶ï¼Œè·Ÿ&lt;code&gt;MessagesController#index&lt;/code&gt;ä¸­ç”¨æ¥æ¸²æŸ“æ¶ˆæ¯åˆ—è¡¨å®Œå…¨åŒæ ·çš„ partial æ¨¡æ¿è¢«ç”¨æ¥æ¸²æŸ“ turbo-stream actionã€‚è¿™å°†ä½œä¸ºå¦‚ä¸‹æ‰€ç¤ºçš„å“åº”å‡ºç°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;Content-Type: text/vnd.turbo-stream.html; charset=utf-8

&amp;lt;turbo-stream action=&quot;append&quot; target=&quot;messages&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;
      The content of the message.
    &amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ª&lt;code&gt;messages/message&lt;/code&gt; partial æ¨¡æ¿ç„¶åå¯ä»¥è¢«ç”¨æ¥æ¸²æŸ“åç»­ edit/update æ“ä½œçš„æ¶ˆæ¯ï¼Œæˆ–è€…æ”¯æŒç”±å…¶ä»–ç”¨æˆ·é€šè¿‡ WebSocket æˆ– SSE è¿æ¥æ‰€åˆ›å»ºçš„æ–°æ¶ˆæ¯ã€‚èƒ½å¤Ÿåœ¨æ•´ä¸ªä½¿ç”¨èŒƒå›´å†…é‡ç”¨ç›¸åŒçš„æ¨¡æ¿éå¸¸å¼ºå¤§ï¼Œè¿™æ˜¯å‡å°‘åˆ›å»ºè¿™äº›ç°ä»£ï¼Œå¿«é€Ÿåº”ç”¨ç¨‹åºæ‰€éœ€å·¥ä½œé‡çš„å…³é”®ã€‚&lt;/p&gt;

&lt;h2 id=&quot;progressively-enhance-when-necessary&quot;&gt;Progressively Enhance When Necessary&lt;/h2&gt;

&lt;p&gt;ä¸€å¼€å§‹ä½ çš„äº¤äº’è®¾è®¡ä¸å€ŸåŠ© Turbo Streams æ˜¯ä¸€ç§å¥½çš„å®è·µã€‚å½“ Turbo Streams ä¸å¯ç”¨æ—¶ï¼Œè®©æ•´ä¸ªåº”ç”¨ç¨‹åºå¦‚é¢„æœŸé‚£æ ·è¿è¡Œï¼Œç„¶åå°†å®ƒä»¬åˆ†å±‚å‡çº§ã€‚è¿™æ„å‘³ç€ä½ å°†ä¸å¿…ä¾èµ–æ›´æ–°æ¥å¤„ç†é‚£äº›éœ€è¦åœ¨åŸç”Ÿåº”ç”¨æˆ–å…¶ä»–æ²¡æœ‰å®ƒä»¬çš„åœ°æ–¹éƒ½èƒ½æ­£å¸¸å·¥ä½œçš„æµç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äº WebSocket æ›´æ–°ä¹Ÿæ˜¯åŒæ ·çš„ã€‚åœ¨è¿æ¥ä¸å¥½ï¼Œæˆ–æœ‰æœåŠ¡ç«¯é—®é¢˜ï¼Œä½ çš„ WebSocket å¯èƒ½ä¼šä¸­æ–­ã€‚å¦‚æœåº”ç”¨ç¨‹åºè¢«è®¾è®¡ä¸ºä¸å€ŸåŠ©äºå®ƒè€Œæ­£å¸¸å·¥ä½œï¼Œè¿™å°±æ›´æœ‰é€‚åº”æ€§ã€‚&lt;/p&gt;

&lt;h2 id=&quot;but-what-about-running-javascript&quot;&gt;But What About Running JavaScript?&lt;/h2&gt;

&lt;p&gt;Turbo Streams æœ‰æ„è¯†åœ°æŠŠæ‰€èƒ½æ‰§è¡Œçš„ actions é™åˆ¶ä¸ºäº”ç§ï¼šappendã€prependã€replaceã€update å’Œ removeã€‚å¦‚æœä½ åœ¨æ‰§è¡Œè¿™äº› actions æ—¶æƒ³è¦è§¦å‘é¢å¤–çš„è¡Œä¸ºï¼Œé‚£ä½ åº”è¯¥ä½¿ç”¨ &lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;Stimulus&lt;/a&gt; controller æ¥é™„åŠ è¿™äº›è¡Œä¸ºã€‚è¿™ç§é™åˆ¶è®© Turbo Streams ä¸“æ³¨äºé€šè¿‡ç½‘ç»œå‘å¸ƒ HTML çš„æœ¬è´¨ä»»åŠ¡ï¼ŒæŠŠé¢å¤–çš„é€»è¾‘ç•™ç»™ä¸“é—¨çš„ JavaScript  æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;æ‹¥æŠ±è¿™äº›çº¦æŸå°†ä½¿ä½ é¿å…å°†å•ä¸ªå“åº”è½¬å˜ä¸ºæ— æ³•é‡å¤ä½¿ç”¨çš„è¡Œä¸ºï¼Œä»è€Œä½¿åº”ç”¨ç¨‹åºéš¾ä»¥éµå¾ªã€‚å¾—è‡ªäº Turbo Streams çš„å…³é”®å—ç›Šæ˜¯é‡ç”¨åˆå§‹åŒ–æ¸²æŸ“é¡µé¢çš„æ¨¡æ¿çš„èƒ½åŠ›ï¼Œè´¯ç©¿äºæ‰€æœ‰åç»­æ›´æ–°çš„è¿‡ç¨‹ä¸­ã€‚&lt;/p&gt;

&lt;h2 id=&quot;integration-with-server-side-frameworks&quot;&gt;Integration with Server-Side Frameworks&lt;/h2&gt;

&lt;p&gt;åœ¨ Turbo é™„å¸¦çš„æ‰€æœ‰æŠ€æœ¯ä¸­ï¼Œä¸ Turbo Streams ä¸€èµ·ä½¿ç”¨ï¼Œä½ å°†çœ‹åˆ°ä¸åç«¯æ¡†æ¶çš„ç´§å¯†é›†æˆæ‰€å¸¦æ¥çš„æœ€å¤§ä¼˜åŠ¿ã€‚ä½œä¸ºå®˜æ–¹ Hotwire å¥—ä»¶çš„ä¸€å‘˜ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†è¿™ç§é›†æˆçœ‹èµ·æ¥å¦‚ä½•çš„ä¸€ä¸ªå®ç°å‚è€ƒï¼Œå³ &lt;a href=&quot;https://github.com/hotwired/turbo-rails&quot;&gt;turbo-rails gem&lt;/a&gt;ã€‚è¯¥ gem ä¾èµ–äº Rails ä¸­å†…ç½®çš„ WebSocket å’Œ å¼‚æ­¥æ¸²æŸ“çš„æ”¯æŒï¼Œå…¶åˆ†åˆ«é€šè¿‡ Action Cable å’Œ Active Job æ¡†æ¶ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨åŠ å…¥ Active Record å…¶ä¸­çš„ &lt;a href=&quot;https://github.com/hotwired/turbo-rails/blob/main/app/models/concerns/turbo/broadcastable.rb&quot;&gt;Broadcastable&lt;/a&gt; concernï¼Œä½ å°±å¯ä»¥ç›´æ¥è§¦å‘æ¥è‡ª é¢†åŸŸæ¨¡å‹ï¼ˆdomain modelï¼‰çš„ WebSocket æ›´æ–°ã€‚è€Œä½¿ç”¨  &lt;a href=&quot;https://github.com/hotwired/turbo-rails/blob/main/app/models/turbo/streams/tag_builder.rb&quot;&gt;Turbo::Streams::TagBuilder&lt;/a&gt;ï¼Œä½ å°±å¯ä»¥æ¸²æŸ“åœ¨ inline controller å“åº”æˆ–ä¸“é—¨æ¨¡æ¿ä¸­çš„&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„ DSL æ‰§è¡Œé‚£äº”ç§ actions ä»¥åŠç›¸å…³çš„æ¸²æŸ“ã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯ï¼ŒTurbo æœ¬èº«æ˜¯å®Œå…¨ä¸åç«¯æ— å…³çš„ã€‚å› æ­¤æˆ‘ä»¬é¼“åŠ±å…¶ä»–ç”Ÿæ€åœˆä¸­çš„å…¶ä»–æ¡†æ¶æ¥çœ‹çœ‹é’ˆå¯¹ Rails æä¾›çš„å®ç°å‚è€ƒï¼Œä»¥åˆ›å»ºå®ƒä»¬è‡ªå·±çš„ç´§å¯†æ•´åˆã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ï¼Œå°†ä»»ä½•åç«¯åº”ç”¨ç¨‹åºä¸ Turbo Streams é›†æˆçš„ç›´æ¥æ–¹æ³•æ˜¯ä¾é  &lt;a href=&quot;https://mercure.rocks/&quot;&gt;Mercure åè®®&lt;/a&gt;ã€‚Mercure é€šè¿‡ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events&quot;&gt;Server-Sent Events (SSE)&lt;/a&gt;ï¼Œä¸ºæœåŠ¡ç«¯æŠŠé¡µé¢å˜æ›´æ’­å‘åˆ°æ¯ä¸ªæ‰€è¿æ¥çš„å®¢æˆ·ç«¯æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼ã€‚&lt;a href=&quot;https://mercure.rocks/docs/ecosystem/hotwire&quot;&gt;è¿™é‡Œå¯ä»¥å­¦ä¹ å¦‚ä½• Turbo Streams æ˜¯å¦‚ä½•è·Ÿ Mercure ä¸€èµ·ä½¿ç”¨çš„&lt;/a&gt;ã€‚&lt;/p&gt;

</description>
        <pubDate>Fri, 19 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/hotwire-turbo-streams/</link>
        <guid isPermaLink="true">/2021/03/hotwire-turbo-streams/</guid>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Hotwireä¹‹ä½¿ç”¨Turbo Frameè§£æ„é¡µé¢</title>
        <description>&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹ Turbo Frame çš„è¯¦ç»†è¯´æ˜ï¼ŒåŸæ–‡å‡ºè‡ªï¼š&lt;a href=&quot;https://turbo.hotwire.dev/handbook/frames&quot;&gt;https://turbo.hotwire.dev/handbook/frames&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Frames å…è®¸ä½ é¢„å®šä¹‰é¡µé¢ä¸­é‚£äº›æ ¹æ®éœ€è¦æ¥æ›´æ–°çš„éƒ¨åˆ†ã€‚ä»»ä½• frame å†…çš„é“¾æ¥å’Œè¡¨å•éƒ½ä¼šè¢«æ•è·ï¼Œè€Œ frame çš„å†…å®¹ä¼šåœ¨æ¥æ”¶åˆ°å“åº”åè¢«è‡ªåŠ¨æ›´æ–°ã€‚ä¸ç®¡æœåŠ¡ç«¯æä¾›çš„æ˜¯æ•´ä¸ª documentï¼Œè¿˜æ˜¯ä»…åŒ…å«æ‰€è¯·æ±‚ frame çš„æ›´æ–°ç‰ˆæœ¬çš„ç‰‡æ®µï¼Œéƒ½åªæœ‰é‚£ä¸ªç‰¹å®šçš„ frame ä¼šä»å“åº”ä¸­è¢«æå–å‡ºæ¥ä»¥æ›¿ä»£ç°æœ‰çš„å†…å®¹ã€‚&lt;/p&gt;

&lt;p&gt;æŠŠé¡µé¢çš„æŸä¸€éƒ¨åˆ†åŒ…åœ¨&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;å…ƒç´ ä¸­å°±åˆ›å»ºäº† Frames ã€‚æ¯ä¸ªå…ƒç´ å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€ IDï¼Œç”¨æ¥ä»æœåŠ¡ç«¯è¯·æ±‚è¡Œé¡µé¢æ—¶åŒ¹é…è¦è¢«æ›¿æ¢çš„å†…å®¹ã€‚ä¸€ä¸ªå•ç‹¬é¡µé¢å¯ä»¥æœ‰å¤šä¸ª framesï¼Œæ¯ä¸€ä¸ªéƒ½ç¡®ç«‹å…¶è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;div id=&quot;navigation&quot;&amp;gt;Links targeting the entire page&amp;lt;/div&amp;gt;

  &amp;lt;turbo-frame id=&quot;message_1&quot;&amp;gt;
    &amp;lt;h1&amp;gt;My message title&amp;lt;/h1&amp;gt;
    &amp;lt;p&amp;gt;My message content&amp;lt;/p&amp;gt;
    &amp;lt;a href=&quot;/messages/1/edit&quot;&amp;gt;Edit this message&amp;lt;/a&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;

  &amp;lt;turbo-frame id=&quot;comments&quot;&amp;gt;
    &amp;lt;div id=&quot;comment_1&quot;&amp;gt;One comment&amp;lt;/div&amp;gt;
    &amp;lt;div id=&quot;comment_2&quot;&amp;gt;Two comments&amp;lt;/div&amp;gt;

    &amp;lt;form action=&quot;/messages/comments&quot;&amp;gt;...&amp;lt;/form&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªé¡µé¢æœ‰ä¸¤ä¸ª framesï¼šä¸€ä¸ªå±•ç¤ºæ¶ˆæ¯ï¼Œå¸¦ä¸€ä¸ªç¼–è¾‘é“¾æ¥ï¼›ä¸€ä¸ªåˆ—å‡ºæ‰€æœ‰è¯„è®ºï¼Œå¸¦ä¸€ä¸ªè¡¨å•ä»¥æ·»åŠ è¯„è®ºã€‚æ¯ä¸ª frame éƒ½åˆ›å»ºäº†å…¶è‡ªèº«çš„ä¸Šä¸‹æ–‡ï¼Œæ¥æ•è·å…¶ä¸­çš„é“¾æ¥å’Œè¡¨å•æäº¤ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç¼–è¾‘æ¶ˆæ¯çš„é“¾æ¥è¢«ç‚¹å‡»æ—¶ï¼Œç”±&lt;code&gt;/messages/1/edit&lt;/code&gt;æä¾›çš„å“åº”ä¼šæŠŠå®ƒçš„&lt;code&gt;&amp;lt;trubo-frame id=&quot;message_1&quot;&amp;gt;&lt;/code&gt;éƒ¨åˆ†æå–å‡ºæ¥ï¼Œè€Œå…¶å†…å®¹åˆ™ä¼šæ›¿æ¢åˆ°é“¾æ¥ç‚¹å‡»æ‰€åœ¨çš„ frame ä¸Šã€‚ç¼–è¾‘æ¶ˆæ¯çš„å“åº”å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Editing message&amp;lt;/h1&amp;gt;

  &amp;lt;turbo-frame id=&quot;message_1&quot;&amp;gt;
    &amp;lt;form action=&quot;/messages/1&quot;&amp;gt;
      &amp;lt;input name=&quot;message[name]&quot; type=&quot;text&quot; value=&quot;My message title&quot;&amp;gt;
      &amp;lt;textarea name=&quot;message[name]&quot;&amp;gt;My message content&amp;lt;/textarea&amp;gt;
      &amp;lt;input type=&quot;submit&quot;&amp;gt;
    &amp;lt;/form&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼Œ&lt;code&gt;&amp;lt;h1&amp;gt;&lt;/code&gt;å¹¶ä¸åœ¨&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;å†…ã€‚è¿™æ„å‘³ç€å½“è¡¨å•æ›¿æ¢å±•ç¤ºçš„æ¶ˆæ¯æ—¶å®ƒä¼šè¢«å¿½ç•¥æ‰ã€‚åªæœ‰æ‰€åŒ¹é…çš„&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;ä¹‹å†…çš„å†…å®¹æ‰ä¼šåœ¨ frame è¢«æ›´æ–°æ—¶ç”¨åˆ°ã€‚&lt;/p&gt;

&lt;p&gt;å› æ­¤ï¼Œä½ çš„é¡µé¢å°±å¯è½»æ¾å®ç°åŒé‡ç›®çš„ï¼šåœ¨æ•´ä¸ªé¡µé¢ä¸“ç”¨äºæ“ä½œçš„ frame ä¹‹å†…æˆ–ä¹‹å¤–è¿›è¡Œç¼–è¾‘ã€‚&lt;/p&gt;

&lt;h2 id=&quot;lazily-loading-frames&quot;&gt;Lazily Loading Frames&lt;/h2&gt;

&lt;p&gt;å½“é¡µé¢åŠ è½½æ—¶ï¼Œå…¶ä¸­æ‰€åŒ…å«çš„ frames å¹¶ä¸å¿…éƒ½å¡«å……å†…å®¹ã€‚å¦‚æœ&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;ä¸Šæœ‰ä¸€ä¸ª&lt;code&gt;&amp;lt;src&amp;gt;&lt;/code&gt;å±æ€§ï¼Œé‚£ä¹ˆä¸€æ—¦è¯¥ tag å‡ºç°åœ¨é¡µé¢ä¸Šæ—¶å…¶ä¸­çš„ URL å°±å°†è¢«è‡ªåŠ¨åŠ è½½ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Imbox&amp;lt;/h1&amp;gt;

  &amp;lt;div id=&quot;emails&quot;&amp;gt;
    ...
  &amp;lt;/div&amp;gt;

  &amp;lt;turbo-frame id=&quot;set_aside_tray&quot; src=&quot;/emails/set_aside&quot;&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;

  &amp;lt;turbo-frame id=&quot;reply_later_tray&quot; src=&quot;/emails/reply_later&quot;&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªé¡µé¢åœ¨åŠ è½½åä¼šç«‹å³åˆ—å‡ºä½ çš„ imbox ä¸­æ‰€æœ‰çš„å¯ç”¨é‚®ä»¶ï¼Œä½†éšåä¼šå‘é€ä¸¤ä¸ªåç»­è¯·æ±‚ï¼Œç”¨æ¥åœ¨é¡µé¢åº•éƒ¨ä¸ºæç½®æˆ–ç­‰å¾…ç¨åå›å¤çš„é‚®ä»¶å±•ç°å°æ‰˜ç›˜ã€‚è¿™äº›æ‰˜ç›˜éƒ½æ˜¯æ ¹æ®&lt;code&gt;src&lt;/code&gt;ä¸­æ‰€æŒ‡å®šçš„ URL æ‰€å‘å‡ºçš„å•ç‹¬ HTTP è¯·æ±‚è€Œåˆ›å»ºçš„ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ‰˜ç›˜èµ·åˆéƒ½æ˜¯ç©ºçš„ï¼Œä½†å…¶ä¹Ÿå¯ä»¥å¡«å……ä¸€äº›åˆå§‹åŒ–å†…å®¹ï¼Œå½“ä»&lt;code&gt;src&lt;/code&gt;è·å–åˆ°äº†å†…å®¹æ—¶ï¼Œè¿™äº›åˆå§‹åŒ–å†…å®¹å°±ä¼šè¢«è¦†ç›–æ‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-frame id=&quot;set_aside_tray&quot; src=&quot;/emails/set_aside&quot;&amp;gt;
  &amp;lt;img src=&quot;/icons/spinner.gif&quot;&amp;gt;
&amp;lt;/turbo-frame&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŠ è½½ imbox é¡µé¢åï¼Œ&lt;code&gt;set-aside&lt;/code&gt;æ‰˜ç›˜ä¼šä»&lt;code&gt;/emails/set_aside&lt;/code&gt;è½½å…¥å†…å®¹ï¼Œè€Œå“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªè·ŸåŸå§‹ç”¨ä¾‹ä¸­ç›¸å¯¹åº”çš„&lt;code&gt;&amp;lt;turbo-frame id=&quot;set_aside_tray&quot;&amp;gt;&lt;/code&gt;å…ƒç´ ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Set Aside Emails&amp;lt;/h1&amp;gt;

  &amp;lt;p&amp;gt;These are emails you've set aside&amp;lt;/p&amp;gt;

  &amp;lt;turbo-frame id=&quot;set_aside_tray&quot;&amp;gt;
    &amp;lt;div id=&quot;emails&quot;&amp;gt;
      &amp;lt;div id=&quot;email_1&quot;&amp;gt;
        &amp;lt;a href=&quot;/emails/1&quot;&amp;gt;My important email&amp;lt;/a&amp;gt;
      &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯¥é¡µé¢ç°åœ¨ä»¥å…¶æœ€å°åŒ–å½¢å¼å·¥ä½œï¼Œå³ä»…å°†å…·æœ‰å•ç‹¬é‚®ä»¶çš„&lt;code&gt;div&lt;/code&gt;åŠ è½½åˆ° imbox é¡µé¢ä¸Šçš„æ‰˜ç›˜ frame ä¸­ï¼Œè€Œä¸”è¿˜å¯ä»¥ä½œä¸ºæä¾› header å’Œæè¿°çš„ç›´æ¥ç›®æ ‡ã€‚ å°±åƒåœ¨å¸¦æœ‰ç¼–è¾‘æ¶ˆæ¯è¡¨å•çš„ç¤ºä¾‹ä¸­é‚£æ ·ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼Œåœ¨&lt;code&gt;/emails/set_aside&lt;/code&gt;ä¸Šçš„&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt;ä¸åŒ…å«&lt;code&gt;src&lt;/code&gt;å±æ€§ã€‚è¿™ä¸ªå±æ€§ä»…ä»…æ·»åŠ åˆ°éœ€è¦ lazy åŠ è½½å†…å®¹çš„ frame ä¸Šï¼Œè€Œä¸æ˜¯æ·»åŠ åˆ°æä¾›å†…å®¹çš„è¢«æ¸²æŸ“çš„ frame ä¸Šã€‚&lt;/p&gt;

&lt;h2 id=&quot;cache-benefits-to-lazily-loading-frames&quot;&gt;Cache Benefits to Lazily Loading Frames&lt;/h2&gt;

&lt;p&gt;æŠŠé¡µé¢ç‰‡æ®µè½¬æ¢æˆ frames èƒ½å¤Ÿå¸®åŠ©ä½¿å¾—é¡µé¢å®ç°æ›´åŠ ç®€å•ï¼Œä½†åŒæ ·é‡è¦çš„æ˜¯è¿™æ ·åšèƒ½å¤Ÿæ”¹å–„ç¼“å­˜åŠ¨æ€ã€‚å¸¦æœ‰å¾ˆå¤šç‰‡æ®µçš„å¤æ‚é¡µé¢éš¾ä»¥è¢«æœ‰æ•ˆç¼“å­˜ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå®ƒä»¬å°†è®¸å¤šäººå…±äº«çš„å†…å®¹ä¸ä¸“é—¨é’ˆå¯¹å•ä¸ªç”¨æˆ·çš„å†…å®¹æ··åˆåœ¨ä¸€èµ·çš„è¯ã€‚è¿™äº›ç‰‡æ®µè¶Šå¤šï¼Œéœ€è¦ç¼“å­˜æŸ¥æ‰¾çš„ä¾èµ–çš„ key è¶Šå¤šï¼Œç¼“å­˜æµå¤±çš„é¢‘ç‡å°±è¶Šé«˜ã€‚&lt;/p&gt;

&lt;p&gt;Frames æ˜¯å¯¹åœ¨ä¸åŒæ—¶é—´èŒƒå›´å’Œä¸åŒå—ä¼—ä¸Šå˜åŒ–çš„ç‰‡æ®µè¿›è¡Œåˆ†ç¦»çš„ç†æƒ³é€‰æ‹©ã€‚æœ‰æ—¶ï¼ŒæŠŠé¡µé¢ä¸­é’ˆå¯¹æ¯ä¸ªç”¨æˆ·çš„å…ƒç´ è½¬æ¢ä¸º frame æ˜¯æœ‰é“ç†çš„ï¼Œå¦‚æœé¡µé¢å…¶ä»–éƒ¨åˆ†éƒ½æ˜¯ç”±æ‰€æœ‰ç”¨æˆ·å…±äº«çš„è¯ã€‚æœ‰æ—¶ï¼Œåˆ™æ˜¯ç›¸åçš„åšæ³•æ›´æœ‰ç†ç”±ï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªé‡åº¦çš„ä¸ªäººåŒ–é¡µé¢ï¼ŒæŠŠä¸€ä¸ªå…±äº«çš„ç‰‡æ®µè½¬æ¢ä¸º frame ä»¥ä¾¿å…±äº«ç¼“å­˜æœåŠ¡äºå®ƒã€‚&lt;/p&gt;

&lt;p&gt;è™½ç„¶è·å– lazy åŠ è½½çš„ frames çš„å¼€é”€é€šå¸¸å¾ˆä½ï¼Œä½†æ˜¯ä½ ä»ç„¶åº”è¯¥æ˜æ™ºåœ°ç¡®å®šè¦åŠ è½½çš„æ•°é‡ï¼Œç‰¹åˆ«æ˜¯å¦‚æœè¿™äº› frames ä¼šåœ¨é¡µé¢ä¸Šé€ æˆåŠ è½½æŠ–åŠ¨æ—¶ã€‚ç„¶è€Œï¼Œå¦‚æœå…¶å†…å®¹åœ¨é¡µé¢åŠ è½½æ—¶ä¸æ˜¯ç«‹å³å¯è§çš„ï¼Œé‚£ä¹ˆ frames åŸºæœ¬ä¸Šéƒ½æ˜¯ free çš„ã€‚å¯èƒ½æ˜¯å› ä¸ºå®ƒä»¬éšè—äº modal æˆ–é¦–å±ä¹‹ä¸‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;targeting-navigation-into-or-out-of-a-frame&quot;&gt;Targeting Navigation Into or Out of a Frame&lt;/h2&gt;

&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ä¸€ä¸ª frame å†…éƒ¨çš„å¯¼èˆªå°±åªé’ˆå¯¹é‚£ä¸ª frameã€‚å¯¹äºç‚¹å‡»é“¾æ¥å’Œæäº¤è¡¨å•éƒ½æ˜¯å¦‚æ­¤ã€‚ä½†é€šè¿‡è®¾ç½®ç›®æ ‡ä¸º&lt;code&gt;_top&lt;/code&gt;ï¼Œå¯¼èˆªå¯ä»¥åˆ‡æ¢åˆ°æ•´ä¸ªé¡µé¢è€Œéé—­åˆçš„ frameã€‚æˆ–è€…ä¹Ÿå¯ä»¥åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå‘½å frame ä¸Šï¼Œé€šè¿‡è®¾ç½®ç›®æ ‡åˆ°è¯¥ frame çš„ ID çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ set-aside tray çš„ç¤ºä¾‹ä¸­ï¼Œtray ä¹‹å†…åˆ°é“¾æ¥æŒ‡å‘å•ç‹¬çš„é‚®ä»¶ã€‚ä½ ä¸ä¼šæƒ³è¦è¿™äº›é“¾æ¥å»æ‰¾åŒ¹é…&lt;code&gt;set_aside_tray&lt;/code&gt; ID çš„ frame tagã€‚ä½ æƒ³è¦çš„æ˜¯ç›´æ¥å¯¼èˆªåˆ°é‚£äº›é‚®ä»¶ã€‚è¿™é€šè¿‡æŠŠ tray frames æ ‡è®°å…¶&lt;code&gt;target&lt;/code&gt;å±æ€§æ¥å®ç°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Imbox&amp;lt;/h1&amp;gt;
  ...
  &amp;lt;turbo-frame id=&quot;set_aside_tray&quot; src=&quot;/emails/set_aside&quot; target=&quot;_top&quot;&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;

&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Set Aside Emails&amp;lt;/h1&amp;gt;
  ...
  &amp;lt;turbo-frame id=&quot;set_aside_tray&quot; target=&quot;_top&quot;&amp;gt;
    ...
  &amp;lt;/turbo-frame&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ‰æ—¶ï¼Œä½ æƒ³è¦å¤§å¤šæ•°é“¾æ¥åœ¨ frame ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œæ“ä½œï¼Œä½†å°‘éƒ¨åˆ†ä¸æ˜¯ã€‚å¯¹äºè¡¨å•ä¹Ÿæ˜¯åŒæ ·çš„ã€‚é‚£ä¹ˆä½ å¯ä»¥æŠŠ&lt;code&gt;data-trubo-frame&lt;/code&gt;å±æ€§æ·»åŠ åˆ°é frame çš„å…ƒç´ ä¸Šæ¥å®ç°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;body&amp;gt;
  &amp;lt;turbo-frame id=&quot;message_1&quot;&amp;gt;
    ...
    &amp;lt;a href=&quot;/messages/1/edit&quot;&amp;gt;
      Edit this message (within the current frame)
    &amp;lt;/a&amp;gt;

    &amp;lt;a href=&quot;/messages/1/permission&quot; data-turbo-frame=&quot;_top&quot;&amp;gt;
      Change permissions (replace the whole page)
    &amp;lt;/a&amp;gt;
  &amp;lt;/turbo-frame&amp;gt;

  &amp;lt;form action=&quot;/messages/1/delete&quot; data-turbo-frame=&quot;message_1&quot;&amp;gt;
    &amp;lt;input type=&quot;submit&quot; value=&quot;Delete this message&quot;&amp;gt;
    (with a confirmation shown in a specific frame)
  &amp;lt;/form&amp;gt;
&amp;lt;/body&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

</description>
        <pubDate>Tue, 16 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/hotwire-turbo-frame/</link>
        <guid isPermaLink="true">/2021/03/hotwire-turbo-frame/</guid>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>Hotwireä¹‹ä½¿ç”¨Turbo Driveå¯¼èˆª</title>
        <description>&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹ Turbo Drive çš„è¯¦ç»†è¯´æ˜ï¼ŒåŸæ–‡å‡ºè‡ªï¼š&lt;a href=&quot;https://turbo.hotwire.dev/handbook/drive&quot;&gt;https://turbo.hotwire.dev/handbook/drive&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Drive æ˜¯ Turbo çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå¢å¼ºé¡µé¢çº§åˆ«çš„å¯¼èˆªã€‚å®ƒç›‘æ§ç€ç‚¹å‡»é“¾æ¥å’Œè¡¨å•æäº¤ï¼Œä½¿å…¶åœ¨åå°æ‰§è¡Œï¼Œå¹¶æ›´æ–°é¡µé¢è€Œæ— éœ€åšå…¨é¡µé¢çš„é‡è½½ã€‚å®ƒæ˜¯&lt;a href=&quot;https://github.com/turbolinks/turbolinks&quot;&gt;Turbolinks&lt;/a&gt; åº“çš„è¿›åŒ–ç‰ˆæœ¬ã€‚&lt;/p&gt;

&lt;h2 id=&quot;page-navigation-basics&quot;&gt;Page Navigation Basics&lt;/h2&gt;

&lt;p&gt;Turbo Drive æŠŠé¡µé¢å¯¼èˆªå»ºæ¨¡ä¸ºä½¿ç”¨ä¸€ç§è¡Œä¸ºå¯¹ä¸€ä¸ªé¡µé¢ä½ç½®ï¼ˆURLï¼‰çš„è®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç§è®¿é—®å±•ç°äº†ä»ç‚¹å‡»åˆ°æ¸²æŸ“çš„æ•´ä¸ªå¯¼èˆªç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…å«æ›´æ”¹æµè§ˆå™¨è®¿é—®å†å²ï¼Œå‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œä»ç¼“å­˜ä¸­æ¢å¤ä¸€ä¸ªé¡µé¢çš„æ‹·è´ï¼Œæ¸²æŸ“æœ€ç»ˆçš„å“åº”ï¼Œä»¥åŠæ›´æ–°é¡µé¢æ»šåŠ¨çš„ä½ç½®ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰ä¸¤ç§ç±»å‹çš„è®¿é—®ï¼šä¸€ç§æ˜¯ &lt;em&gt;application&lt;/em&gt; è®¿é—®ï¼Œå…¶è¡Œä¸ºæ˜¯ &lt;em&gt;advance&lt;/em&gt; æˆ– &lt;em&gt;replace&lt;/em&gt;ã€‚è€Œå¦ä¸€ç§æ˜¯ &lt;em&gt;restoration&lt;/em&gt; è®¿é—®ï¼Œå…¶è¡Œä¸ºæ˜¯ &lt;em&gt;restore&lt;/em&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&quot;application-visits&quot;&gt;Application Visits&lt;/h2&gt;

&lt;p&gt;Application è®¿é—®ç”±ä¸€ä¸ªå¯ç”¨ Turbo Drive çš„é“¾æ¥ï¼Œæˆ–è€…ç¨‹åºä¸­è°ƒç”¨&lt;code&gt;Turbo.visit(location)&lt;/code&gt;ï¼Œè€Œè¢«åˆå§‹åŒ–çš„ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ª application è®¿é—®æ€»æ˜¯ä¼šå‘å‡ºä¸€ä¸ªç½‘ç»œè¯·æ±‚ã€‚å½“å“åº”è¿”å›ï¼ŒTurbo Drive å°±æ¸²æŸ“å…¶é¡µé¢å¹¶ç»“æŸè¿™æ¬¡è®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;å¯èƒ½çš„è¯ï¼ŒTurbo Drive ä¼šåœ¨è®¿é—®å¼€å§‹æ—¶ç«‹å³ä»ç¼“å­˜ä¸­æ¸²æŸ“ä¸€ä¸ªé¡µé¢çš„é¢„è§ˆã€‚è¿™å°±æé«˜äº†åœ¨ç›¸åŒé¡µé¢é—´é¢‘ç¹å¯¼èˆªçš„æ„ŸçŸ¥é€Ÿåº¦ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœè®¿é—®çš„ä½ç½®åŒ…å«ä¸€ä¸ªé”šç‚¹ï¼ŒTurbo Drive ä¼šå°è¯•æ»šåŠ¨åˆ°æ‰€é”šä½çš„å…ƒç´ ã€‚å¦åˆ™ï¼Œä¼šæ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨ã€‚&lt;/p&gt;

&lt;p&gt;Application è®¿é—®ä¼šå¯¼è‡´æµè§ˆå™¨è®¿é—®å†å²çš„å˜æ›´ï¼Œè€Œè®¿é—®çš„è¡Œä¸ºå†³å®šäº†è¯¥å˜æ›´æ˜¯æ€æ ·çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://s3.amazonaws.com/turbolinks-docs/images/advance.svg&quot; alt=&quot;https://s3.amazonaws.com/turbolinks-docs/images/advance.svg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;é»˜è®¤çš„è®¿é—®è¡Œä¸ºæ˜¯ &lt;em&gt;advance&lt;/em&gt;ã€‚åœ¨ä¸€æ¬¡ advance è®¿é—®æœŸé—´ï¼ŒTurbo Drive ä½¿ç”¨&lt;code&gt;history.pushState&lt;/code&gt;å‘æµè§ˆå™¨è®¿é—®å†å²æ¨å…¥ä¸€ä¸ªæ–°æ¡ç›®ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ Turbo Drive çš„ &lt;a href=&quot;https://github.com/hotwired/turbo-ios&quot;&gt;iOS adapter&lt;/a&gt; çš„åº”ç”¨ç¨‹åºé€šå¸¸å¤„ç† advance è®¿é—®æ˜¯æ¨å…¥ä¸€ä¸ªæ–°çš„ view controller åˆ°å¯¼èˆªå †æ ˆä¹‹ä¸Šã€‚ç±»ä¼¼åœ°ï¼Œä½¿ç”¨ &lt;a href=&quot;https://github.com/hotwired/turbo-android&quot;&gt;Android adapter&lt;/a&gt; çš„åº”ç”¨ç¨‹åºé€šå¸¸æ˜¯æ¨å…¥ä¸€ä¸ªæ–°çš„ activity åˆ° back stack ä¹‹ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://s3.amazonaws.com/turbolinks-docs/images/replace.svg&quot; alt=&quot;https://s3.amazonaws.com/turbolinks-docs/images/replace.svg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ä½ å¯èƒ½æƒ³è¦è®¿é—®ä¸€ä¸ªä½ç½®è€Œä¸æ¨å…¥ä¸€ä¸ªæ–°è®¿é—®å†å²æ¡ç›®åˆ°å†å²å †æ ˆä¹‹ä¸Šã€‚&lt;em&gt;replace&lt;/em&gt; è¡Œä¸ºä½¿ç”¨&lt;code&gt;history.replaceState&lt;/code&gt;æ¥ä¸¢å¼ƒæœ€é¡¶å±‚çš„å†å²æ¡ç›®ï¼Œå¹¶ä»¥æ–°çš„ä½ç½®æ¥æ›¿æ¢å®ƒã€‚&lt;/p&gt;

&lt;p&gt;è¦æŒ‡å®šå¦‚ä¸‹é“¾æ¥èƒ½è§¦å‘ä¸€ä¸ª replace è®¿é—®ï¼Œä»¥&lt;code&gt;data-turbo-action=&quot;replace&quot;&lt;/code&gt;æ³¨é‡Šé“¾æ¥å³å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;a href=&quot;/edit&quot; data-turbo-action=&quot;replace&quot;&amp;gt;Edit&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¦åœ¨ç¨‹åºä¸­ä»¥ replace è¡Œä¸ºè®¿é—®ä¸€ä¸ªä½ç½®ï¼ŒæŠŠ&lt;code&gt;action: &quot;replace&quot;&lt;/code&gt;é€‰é¡¹ä¼ å…¥&lt;code&gt;Turbo.visit&lt;/code&gt;å³å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;Turbo.visit(&quot;/edit&quot;, { action: &quot;replace&quot; })
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½¿ç”¨ Turbo Drive çš„ &lt;a href=&quot;https://github.com/hotwired/turbo-ios&quot;&gt;iOS adapter&lt;/a&gt; çš„åº”ç”¨ç¨‹åºé€šå¸¸å¤„ç† replace è®¿é—®æ˜¯æ”¾å¼ƒæœ€é¡¶å±‚çš„ view controller å¹¶æ¨å…¥ä¸€ä¸ªæ–°çš„ view controller åˆ°å¯¼èˆªå †æ ˆä¹‹ä¸Šï¼Œä¸å¸¦åŠ¨ç”»çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;h2 id=&quot;restoration-visits&quot;&gt;Restoration Visits&lt;/h2&gt;

&lt;p&gt;å½“ä½ ä½¿ç”¨æµè§ˆå™¨çš„åé€€æˆ–å‰è¿›æŒ‰é’®å¯¼èˆªæ—¶ï¼ŒTurbo Drive ä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸€ä¸ªå¤ä½è®¿é—®ã€‚ä½¿ç”¨ &lt;a href=&quot;https://github.com/hotwired/turbo-ios&quot;&gt;iOS&lt;/a&gt; æˆ– &lt;a href=&quot;https://github.com/hotwired/turbo-android&quot;&gt;Android&lt;/a&gt; adapters çš„åº”ç”¨ç¨‹åºåœ¨å¯¼èˆªå †æ ˆä¸­åç§»æ—¶ä¼šåˆå§‹åŒ–ä¸€ä¸ªå¤ä½è®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://s3.amazonaws.com/turbolinks-docs/images/restore.svg&quot; alt=&quot;https://s3.amazonaws.com/turbolinks-docs/images/restore.svg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¯èƒ½çš„è¯ï¼ŒTurbo Drive å°±ä»ç¼“å­˜ä¸­æ¸²æŸ“ä¸€ä¸ªé¡µé¢çš„æ‹·è´è€Œä¸å‘å‡ºè¯·æ±‚ã€‚å¦åˆ™ï¼Œå®ƒå°†ä¼šé€šè¿‡ç½‘ç»œè·å–ä¸€ä¸ªé¡µé¢çš„å…¨æ–°æ‹·è´ã€‚æŸ¥çœ‹ä¸‹é¢çš„ Understanding Caching ä»¥äº†è§£æ›´å¤šç»†èŠ‚ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Drive åœ¨å¯¼èˆªç¦»å¼€æ¯ä¸ªé¡µé¢æ—¶éƒ½ä¼šè®°ä½å…¶æ»šåŠ¨ä½ç½®ï¼Œåœ¨å¤ä½è®¿é—®æ—¶ä¼šè‡ªåŠ¨æ»šåŠ¨å›è¯¥ä½ç½®å¤„ã€‚&lt;/p&gt;

&lt;p&gt;å¤ä½è®¿é—®æœ‰ä¸€ä¸ª &lt;em&gt;restore&lt;/em&gt; è¡Œä¸ºï¼ŒTurbo Drive é¢„ç•™å®ƒä»¬æ˜¯ä¸ºäº†å†…éƒ¨ä½¿ç”¨ã€‚ä½ æ— éœ€å°è¯•ä½¿ç”¨&lt;code&gt;restore&lt;/code&gt;çš„è¡Œä¸ºæ¥æ³¨é‡Šé“¾æ¥æˆ–æ‰§è¡Œ&lt;code&gt;Turbo.visit&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&quot;canceling-visits-before-they-start&quot;&gt;Canceling Visits Before They Start&lt;/h2&gt;

&lt;p&gt;Application è®¿é—®åœ¨å…¶å¼€å§‹ä¹‹å‰æ˜¯å¯ä»¥è¢«å–æ¶ˆçš„ï¼Œè€Œä¸ç®¡å®ƒä»¬æ˜¯ç”±ç‚¹å‡»é“¾æ¥è¿˜æ˜¯ç”±è°ƒç”¨&lt;code&gt;Turbo.visit&lt;/code&gt;æ¥åˆå§‹åŒ–çš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è®¿é—®å¼€å§‹çš„æ—¶å€™ç›‘å¬&lt;code&gt;turbo:before-visit&lt;/code&gt;äº‹ä»¶ï¼Œå¹¶ä½¿ç”¨&lt;code&gt;event.detail.url&lt;/code&gt;ï¼ˆä½¿ç”¨ jQuery æ—¶æ˜¯&lt;code&gt;$event.originalEvent.detail.url&lt;/code&gt;ï¼‰æ¥æ£€æŸ¥è®¿é—®çš„ä½ç½®ã€‚ç„¶åé€šè¿‡è°ƒç”¨&lt;code&gt;event.preventDefault()&lt;/code&gt;æ¥å–æ¶ˆè®¿é—®ã€‚&lt;/p&gt;

&lt;p&gt;å¤ä½è®¿é—®ä¸èƒ½è¢«å–æ¶ˆï¼Œä¸”ä¸ä¼šè§¦å‘&lt;code&gt;turbo:before-visit&lt;/code&gt;ã€‚Turbo Drive å‘å‡ºå¤ä½è®¿é—®æ¥å“åº”å¯¹å·²æœ‰çš„å†å²è®°å½•è¿›è¡Œå¯¼èˆªï¼Œé€šå¸¸æ˜¯é€šè¿‡æµè§ˆå™¨çš„åé€€æˆ–å‰è¿›æŒ‰é’®ã€‚&lt;/p&gt;

&lt;h2 id=&quot;disabling-turbo-drive-on-specific-links-or-forms&quot;&gt;Disabling Turbo Drive on Specific Links or Forms&lt;/h2&gt;

&lt;p&gt;å¯ä»¥ç¦ç”¨ä¸€ä¸ªå…ƒç´ çš„Turbo Driveï¼Œé€šè¿‡åœ¨å®ƒæˆ–å…¶ä¸Šçº§å…ƒç´ ä¸Šæ·»åŠ &lt;code&gt;data-turbo=&quot;fale&quot;&lt;/code&gt;çš„æ–¹å¼ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;a href=&quot;/&quot; data-turbo=&quot;false&quot;&amp;gt;Disabled&amp;lt;/a&amp;gt;

&amp;lt;form action=&quot;/messages&quot; method=&quot;post&quot; data-turbo=&quot;false&quot;&amp;gt;
  ...
&amp;lt;/form&amp;gt;

&amp;lt;div data-turbo=&quot;false&quot;&amp;gt;
  &amp;lt;a href=&quot;/&quot;&amp;gt;Disabled&amp;lt;/a&amp;gt;
  &amp;lt;form action=&quot;/messages&quot; method=&quot;post&quot;&amp;gt;
    ...
  &amp;lt;/form&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ä¸Šçº§å…ƒç´ å·²ç¦ç”¨æ—¶è¦é‡æ–°å¯ç”¨ï¼Œä½¿ç”¨&lt;code&gt;data-turbo=&quot;true&quot;&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;div data-turbo=&quot;false&quot;&amp;gt;
  &amp;lt;a href=&quot;/&quot; data-turbo=&quot;true&quot;&amp;gt;Enabled&amp;lt;/a&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¦ç”¨äº† Turbo Drive çš„é“¾æ¥å’Œè¡¨å•ä»ç„¶ä¼šè¢«æµè§ˆå™¨æ­£å¸¸å¤„ç†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;displaying-progress&quot;&gt;&lt;a href=&quot;https://turbo.hotwire.dev/handbook/drive#displaying-progress&quot;&gt;ï¹Ÿ&lt;/a&gt;Displaying Progress&lt;/h2&gt;

&lt;p&gt;åœ¨ Turbo Drive å¯¼èˆªæœŸé—´ï¼Œæµè§ˆå™¨å°†ä¸ä¼šå±•ç¤ºå…¶åŸç”Ÿçš„è¿›åº¦æ¡äº†ã€‚Turbo Drive å®‰è£…äº†ä¸€ä¸ªåŸºäº CSS çš„è¿›åº¦æ¡æ¥åœ¨å‘å‡ºè¯·æ±‚æ—¶ç»™ä»¥åé¦ˆã€‚&lt;/p&gt;

&lt;p&gt;è¯¥è¿›åº¦æ¡é»˜è®¤æ˜¯å¯ç”¨çš„ã€‚å®ƒå¯¹ä»»ä½•è½½å…¥æ—¶é—´è¶…è¿‡ 500 ms çš„é¡µé¢éƒ½ä¼šè‡ªåŠ¨æ˜¾ç¤ºã€‚ï¼ˆä½ å¯ä»¥ä½¿ç”¨&lt;code&gt;Turbo.setProgressBarDelay&lt;/code&gt;æ–¹æ³•ä¿®æ”¹è¿™ä¸ªå€¼ã€‚ï¼‰&lt;/p&gt;

&lt;p&gt;è¯¥è¿›åº¦æ¡æ˜¯ä¸€ä¸ª&lt;code&gt;&amp;lt;div&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œå…¶ class åä¸º&lt;code&gt;turbo-progress-bar&lt;/code&gt;ã€‚å®ƒçš„é»˜è®¤æ ·å¼ä¼šé¦–å…ˆå‘ˆç°äº documentï¼Œä¸”å¯ä»¥è¢«ä¹‹åçš„è§„åˆ™æ‰€è¦†ç›–ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹å¦‚ï¼Œä¸‹é¢çš„ CSS å°†ä¼šå‘ˆç°ä¸€ä¸ªç»¿è‰²çš„çª„è¿›åº¦æ¡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;.turbo-progress-bar {
  height: 5px;
  background-color: green;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¦å®Œå…¨ç¦ç”¨è¯¥è¿›åº¦æ¡ï¼ŒæŠŠå…¶&lt;code&gt;visibility&lt;/code&gt;æ ·å¼è®¾ä¸º&lt;code&gt;hidden&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-css&quot;&gt;.turbo-progress-bar {
  visibility: hidden;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;reloading-when-assets-change&quot;&gt;Reloading When Assets Change&lt;/h2&gt;

&lt;p&gt;Turbo Drive å¯ä»¥åœ¨ä¸€ä¸ªé¡µé¢åˆ°å¦ä¸€ä¸ªé¡µé¢æ—¶è·Ÿè¸ª&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­çš„ asset å…ƒç´ çš„ URLï¼Œå¦‚æœå®ƒä»¬æœ‰æ‰€å˜åŠ¨åˆ™è‡ªåŠ¨è¯·æ±‚ä¸€æ¬¡å…¨é‡é‡è½½ã€‚è¿™ç¡®ä¿äº†ç”¨æˆ·å§‹ç»ˆä¼šæ‹¥æœ‰ä½ åº”ç”¨ç¨‹åºçš„ script å’Œ style çš„æœ€æ–°ç‰ˆæœ¬ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨&lt;code&gt;data-turbo-track=&quot;reload&quot;&lt;/code&gt;æ³¨é‡Š asset å…ƒç´ å¹¶åœ¨ asset URL ä¸­åŒ…å«ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ç¬¦ã€‚è¯¥æ ‡è¯†ç¬¦å¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªæœ€è¿‘ä¿®æ”¹çš„æ—¶é—´æˆ³ï¼Œæˆ–è€…æ›´å¥½ç‚¹ï¼Œä¸€ä¸ª asset å†…å®¹çš„ digestï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;head&amp;gt;
  ...
  &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/application-258e88d.css&quot; data-turbo-track=&quot;reload&quot;&amp;gt;
  &amp;lt;script src=&quot;/application-cbd3cd4.js&quot; data-turbo-track=&quot;reload&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;ensuring-specific-pages-trigger-a-full-reload&quot;&gt;Ensuring Specific Pages Trigger a Full Reload&lt;/h2&gt;

&lt;p&gt;ä½ å¯ä»¥é€šè¿‡åœ¨é¡µé¢çš„&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­åŒ…å«ä¸€ä¸ª&lt;code&gt;&amp;lt;meta name=&quot;turbo-visit-control&quot;&amp;gt;&lt;/code&gt;å…ƒç´ æ¥ç¡®ä¿åœ¨è®¿é—®æŸä¸ªé¡µé¢æ—¶å§‹ç»ˆä¼šè§¦å‘ä¸€æ¬¡å…¨é‡é‡è½½ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;head&amp;gt;
  ...
  &amp;lt;meta name=&quot;turbo-visit-control&quot; content=&quot;reload&quot;&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªè®¾ç½®å¯èƒ½åœ¨ç¬¬ä¸‰æ–¹ JavaScript åº“ä¸èƒ½å¾ˆå¥½åœ°è·Ÿ Turbo Drive é¡µé¢å˜æ›´è¿›è¡Œäº¤äº’æ—¶æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;h2 id=&quot;setting-a-root-location&quot;&gt;Setting a Root Location&lt;/h2&gt;

&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒTurbo Drive åªä¼šåŠ è½½åŒæº URLâ€”â€”æ¯”å¦‚ï¼Œè·Ÿå½“å‰é¡µé¢ç›¸åŒçš„åè®®ï¼ŒåŸŸåï¼Œç«¯å£ã€‚è®¿é—®ä»»ä½•å…¶ä»– URL éƒ½ä¼šå¯¼è‡´ä¸€æ¬¡å…¨é‡çš„é¡µé¢åŠ è½½ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº›åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½æƒ³è¦è¿›ä¸€æ­¥å®šä¹‰ Turbo Drive åˆ°åŒæºçš„ä¸€ä¸ª path ä¸Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ Turbo Drive åº”ç”¨ä½äº&lt;code&gt;/app&lt;/code&gt;ï¼Œè€Œé Turbo Drive çš„å¸®åŠ©ç«™ç‚¹ä½äº&lt;code&gt;/help&lt;/code&gt;ï¼Œä»å‰è€…åˆ°åè€…çš„é“¾æ¥ä¸åº”è¯¥ä½¿ç”¨ Turbo Driveã€‚&lt;/p&gt;

&lt;p&gt;åœ¨é¡µé¢çš„&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;ä¸­åŒ…å«ä¸€ä¸ª&lt;code&gt;&amp;lt;meta name=&quot;turbo-root&quot;&amp;gt;&lt;/code&gt;å…ƒç´ ä»¥å®šä¹‰ Turbo Drive åˆ°ç‰¹å®šçš„ root ä½ç½®ã€‚Turbo Drive å°†åªåŠ è½½é‚£ä¸ª path å‰ç¼€çš„åŒæº URLã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;head&amp;gt;
  ...
  &amp;lt;meta name=&quot;turbo-root&quot; content=&quot;/app&quot;&amp;gt;
&amp;lt;/head&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;redirecting-after-a-form-submission&quot;&gt;Redirecting After a Form Submission&lt;/h2&gt;

&lt;p&gt;Turbo Drive ä»¥ä¸€ç§ç±»ä¼¼äºé“¾æ¥ç‚¹å‡»çš„æ–¹å¼å¤„ç†è¡¨å•æäº¤ã€‚å…³é”®åŒºåˆ«æ˜¯è¡¨å•æäº¤å¯ä»¥ä½¿ç”¨ HTTP POST æ–¹æ³•å‘å‡ºæœ‰çŠ¶æ€çš„è¯·æ±‚ï¼Œè€Œé“¾æ¥ç‚¹å‡»åªä¼šå‘å‡ºæ— çŠ¶æ€çš„ HTTP GET è¯·æ±‚ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æœ‰çŠ¶æ€çš„è¡¨å•æäº¤åï¼ŒTurbo Drive æœŸæœ›æœåŠ¡ç«¯è¿”å›ä¸€ä¸ª &lt;a href=&quot;https://en.wikipedia.org/wiki/HTTP_303&quot;&gt;HTTP 303 redirect response&lt;/a&gt;ï¼Œå…¶å°†è¢«ç”¨ä»¥å¯¼èˆªå’Œé¡µé¢æ›´æ–°è€Œæ— éœ€é‡è½½ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ¡è§„åˆ™çš„ä¾‹å¤–æƒ…å†µæ˜¯å½“å“åº”æ˜¯ 4xx æˆ– 5xx çš„æ—¶å€™ã€‚è¿™å¯ä»¥è®©æœåŠ¡ç«¯å“åº”ä¸º&lt;code&gt;422 Unprocessable Entity&lt;/code&gt;æ—¶å‘ˆç°è¡¨å•çš„æ ¡éªŒé”™è¯¯ï¼Œä»¥åŠå“åº”ä¸º&lt;code&gt;500 Internal Server Error&lt;/code&gt;æ—¶æ˜¾ç¤ºæœåŠ¡ç«¯å‡ºé”™äº†ã€‚&lt;/p&gt;

&lt;p&gt;Turbo ä¸å…è®¸å¯¹äº 200 çš„å¸¸è§„æ¸²æŸ“çš„åŸå› æ˜¯æµè§ˆå™¨å·²æœ‰å†…ç½®çš„è¡Œä¸ºæ¥å¤„ç† POST è®¿é—®çš„é‡è½½ï¼Œä¼šå±•ç¤ºä¸€ä¸ªâ€œä½ ç¡®è®¤æƒ³è¦é‡æ–°æäº¤è¡¨å•å—ï¼Ÿâ€çš„å¯¹è¯æ¡†ï¼Œè¿™æ˜¯ Turbo æ— æ³•å¤åˆ¶çš„ã€‚ç›¸åï¼ŒTurbo ä¼šåœ¨ä¸€ä¸ªè¡¨å•æäº¤åå°è¯•æ¸²æŸ“é¡µé¢æ—¶é©»ç•™åœ¨å½“å‰ URL ä¸Šï¼Œè€Œä¸æ˜¯å˜æ›´åˆ°è¡¨å•çš„ actionï¼Œå› ä¸ºé‡è½½ä¼šå‘å‡ºåˆ°é‚£ä¸ª action æ‰€æŒ‡å‘ URL çš„ä¸€ä¸ª GET è¯·æ±‚ï¼Œè€Œè¯¥ URL ç”šè‡³å¯èƒ½æ ¹æœ¬ä¸å­˜åœ¨ã€‚&lt;/p&gt;

&lt;h2 id=&quot;streaming-after-a-form-submission&quot;&gt;Streaming After a Form Submission&lt;/h2&gt;

&lt;p&gt;æœåŠ¡ç«¯ä¹Ÿå¯ä»¥å€ŸåŠ© &lt;a href=&quot;https://turbo.hotwire.dev/handbook/streams&quot;&gt;Turbo Streams&lt;/a&gt; æ¶ˆæ¯ï¼Œé€šè¿‡å‘é€ header &lt;code&gt;Content-Type: text/vnd.turbo-stream.html&lt;/code&gt;ï¼Œç„¶ååœ¨å“åº”å†…å®¹ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œæ¥å“åº”è¡¨å•æäº¤ï¼Œè¿™è®©ä½ å¯ä»¥æ— éœ€å¯¼èˆªå³å¯æ›´æ–°é¡µé¢çš„å¤šä¸ªéƒ¨åˆ†ã€‚&lt;/p&gt;

</description>
        <pubDate>Sat, 13 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/hotwire-turbo-drive/</link>
        <guid isPermaLink="true">/2021/03/hotwire-turbo-drive/</guid>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>è®©ä½ çš„NeoVim Builtin LSPç¾è½®ç¾å¥‚</title>
        <description>&lt;p&gt;åœ¨é…ç½® NeoVim Builtin LSP çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å®ƒè‡ªå¸¦çš„åŸç”Ÿ UI ç•Œé¢å®åœ¨ç®€é™‹äº†äº›ã€‚è™½ç„¶åŠŸèƒ½ç”¨èµ·æ¥æ²¡é—®é¢˜ï¼Œä½†è¿œè¿œå¤Ÿä¸ä¸Šèµå¿ƒæ‚¦ç›®çš„ç¨‹åº¦ã€‚è¿™å¯¹äºåƒæˆ‘è¿™æ ·çš„â€œè§†è§‰åŠ¨ç‰©â€æ¥è¯´ï¼Œå®åœ¨æ˜¯åšå†³ä¸èƒ½å®¹å¿çš„â€œå¤§ç½ªâ€äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç»è¿‡ä¸€ç•ªæœå¯»ï¼Œç»ˆäºæ‰¾åˆ°ä¸€ä¸ªå¾ˆä¸é”™çš„ NeoVim Builtin LSP å¢å¼ºæ’ä»¶ï¼š&lt;a href=&quot;https://github.com/glepnir/lspsaga.nvim&quot;&gt;lspsaga.nvim&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;å®ƒå¯¹è‡ªå·±çš„ä»‹ç»æ˜¯ï¼šâ€œA light-weight lsp plugin based on neovim built-in lsp with highly a performant UI.â€ï¼Œå¯è§å…¶å®Œå…¨èšç„¦äºæ‰“é€ ä¸€ä¸ªä¼˜é›…ç²¾è‡´çš„ UI ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;å®ƒçš„å®‰è£…å’Œé…ç½®éƒ½æ²¡ä»€ä¹ˆå¯è¯´çš„ï¼ŒæŒ‰ç…§ Readme æ–‡æ¡£çš„æ¥å°±æ˜¯äº†ã€‚&lt;/p&gt;

&lt;p&gt;é‡ç‚¹æ˜¯æ¥ç…ç…å®ƒçš„ä¸€äº›èŒƒä¾‹ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å¼‚æ­¥ LSP æŸ¥æ‰¾&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/41671631/107140076-ae77ec00-695a-11eb-8329-0b9d8361bfeb.gif&quot; alt=&quot;https://user-images.githubusercontent.com/41671631/107140076-ae77ec00-695a-11eb-8329-0b9d8361bfeb.gif&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/41671631/106566308-1dc09b00-656b-11eb-85e2-2ab5b23599c9.gif&quot; alt=&quot;https://user-images.githubusercontent.com/41671631/106566308-1dc09b00-656b-11eb-85e2-2ab5b23599c9.gif&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å˜é‡é‡å‘½å&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/41671631/106115648-f6915480-618b-11eb-9818-003cfb15c8ac.gif&quot; alt=&quot;https://user-images.githubusercontent.com/41671631/106115648-f6915480-618b-11eb-9818-003cfb15c8ac.gif&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;æµ®åŠ¨ç»ˆç«¯çª—å£&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/41671631/105658287-2c6ed880-5f01-11eb-8af6-daa6fd23576c.gif&quot; alt=&quot;https://user-images.githubusercontent.com/41671631/105658287-2c6ed880-5f01-11eb-8af6-daa6fd23576c.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç¡®å®ç›¸å½“ç²¾è‡´ï¼&lt;/p&gt;

&lt;p&gt;è¿™ç§ç‹¬æœ‰çš„ â€œTerminal ç¾å­¦â€ï¼ŒçœŸçš„æœ‰ä¸€ç§è®©äººæ¬²ç½¢ä¸èƒ½çš„é­…åŠ›ã€‚&lt;/p&gt;
</description>
        <pubDate>Thu, 11 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/a-awesome-neovim-lsp-plugin/</link>
        <guid isPermaLink="true">/2021/03/a-awesome-neovim-lsp-plugin/</guid>
        
        <category>neovim</category>
        
        
        <category>Tool</category>
        
      </item>
    
      <item>
        <title>Hotwireä¹‹Turboä»‹ç»</title>
        <description>&lt;p&gt;æˆ‘å»å¹´ 7 æœˆçš„åšå®¢&lt;a href=&quot;https://xfyuan.github.io/2020/07/dhh-talk-about-heystack/&quot;&gt;å¯¹ Hey.com æŠ€æœ¯æ ˆçš„æœŸå¾…&lt;/a&gt; ä¸­æåˆ°äº† DHH åœ¨ HEY ä¸­æ‰€ä½¿ç”¨çš„æ–°æŠ€æœ¯æ ˆã€‚è€Œåœ¨å»å¹´ 12 æœˆ 23 æ—¥ï¼ŒDHH ä¸è´Ÿæ‰€æœ›ï¼Œå¦‚æœŸå®£å¸ƒäº†ä»–çš„â€œNEW MAGICâ€ï¼š&lt;a href=&quot;https://hotwire.dev/&quot;&gt;Hotwire&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/xfyuan/ossimgs@master/uPic/LQ2YA5.png&quot; alt=&quot;LQ2YA5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hotwire ç”± &lt;a href=&quot;https://turbo.hotwire.dev/&quot;&gt;Turbo&lt;/a&gt;ã€&lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;Stimulus&lt;/a&gt; å’Œ Stradaï¼ˆå°†äº2021å…¬å¸ƒï¼‰ æ„æˆã€‚Strada å°šæœªå‘å¸ƒå…ˆä¸è®ºï¼ŒStimulus ä¹Ÿæ˜¯æ—©å°±å‘å¸ƒçš„æŠ€æœ¯ï¼Œå¹¶éæ–°äº‹ç‰©ï¼Œæ‰€ä»¥çœŸæ­£çš„ç„¦ç‚¹å°±æ˜¯ Turbo äº†ã€‚è¿™ç¯‡åšå®¢å³æ˜¯ Turbo çš„ä¸€ä¸ªæ¦‚è§ˆã€‚åŸæ–‡å‡ºè‡ªï¼š&lt;a href=&quot;https://turbo.hotwire.dev/handbook/introduction&quot;&gt;https://turbo.hotwire.dev/handbook/introduction&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;Turbo æŠŠå‡ ç§æŠ€æœ¯é›†æˆåˆ°ä¸€èµ·ä»¥åˆ›å»ºå¿«é€Ÿçš„ã€ç°ä»£çš„ã€æ¸è¿›å¼å¢å¼ºçš„ Web åº”ç”¨è€Œæ¯‹éœ€ä½¿ç”¨å¤ªå¤šçš„ JavaScriptã€‚å¯¹äºæµè¡Œçš„æŠŠæ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½ç½®äºå‰ç«¯ï¼Œä¸”æŠŠæœåŠ¡ç«¯é™åˆ¶åœ¨ä»…æä¾› JSON API çš„é‚£äº›å®¢æˆ·ç«¯æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ç®€å•çš„æ›¿ä»£æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;å€ŸåŠ© Turboï¼Œä½ è®©æœåŠ¡ç«¯ç›´æ¥å‘å¸ƒ HTMLï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼Œè¯¸å¦‚æƒé™æ£€æŸ¥ã€ç›´æ¥ä¸ä½ çš„é¢†åŸŸæ¨¡å‹äº¤äº’ï¼Œä»¥åŠç¼–å†™åº”ç”¨ç¨‹åºæ‰€éœ€çš„å…¶ä»–ä¸€åˆ‡ï¼Œéƒ½èƒ½æˆ–å¤šæˆ–å°‘åœ°åªç”¨ä½ æ‰€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€å³å¯å®ç°ã€‚è€Œä¸ç”¨å†æŠŠè¿™äº›é€»è¾‘åœ¨è¢« JSON æ‰€åˆ’åˆ†çš„ä¸¤ç«¯éƒ½é•œåƒå®ç°ã€‚æ‰€æœ‰çš„é€»è¾‘éƒ½ä½äºæœåŠ¡ç«¯ï¼Œè€Œæµè§ˆå™¨åªå¤„ç†æœ€ç»ˆçš„ HTMLã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¯ä»¥åœ¨ &lt;a href=&quot;https://hotwire.dev/&quot;&gt;Hotwire ç«™ç‚¹&lt;/a&gt;é˜…è¯»åˆ°å…³äº HTML-over-the-wire æ–¹æ¡ˆçš„æ›´å¤šä¼˜ç‚¹ã€‚ä¸‹é¢åˆ™æ˜¯ Turbo å¸¦æ¥çš„ä½¿ä¹‹æˆä¸ºå¯èƒ½çš„æŠ€æœ¯ã€‚&lt;/p&gt;

&lt;h2 id=&quot;turbo-drive-navigate-within-a-persistent-process&quot;&gt;Turbo Drive: Navigate within a persistent process&lt;/h2&gt;

&lt;p&gt;ä¼ ç»Ÿå•é¡µé¢åº”ç”¨çš„å…³é”®å¸å¼•åŠ›ï¼Œæ¯”è¾ƒäºè€å¼ã€å•ç‹¬é¡µé¢çš„æ–¹æ¡ˆè€Œè¨€ï¼Œå°±æ˜¯å¯¼èˆªè·³è½¬çš„é€Ÿåº¦ã€‚SPA æ˜¯é€šè¿‡ä»…åœ¨ç¬¬ä¸€ä¸ªé¡µé¢åˆå§‹åŒ–è€Œéä¸æ–­åœ°ä¸­æ–­åº”ç”¨ç¨‹åºè¿›ç¨‹ä»è€Œè·å¾—å¦‚æ­¤é«˜çš„å“åº”é€Ÿåº¦çš„ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Drive é€šè¿‡ä½¿ç”¨åŒæ ·çš„æŒä¹…åŒ–è¿›ç¨‹æ¨¡å‹ä¸ºä½ èµ‹äºˆäº†åŒæ ·çš„é«˜é€Ÿå“åº”ï¼Œä½†æ— éœ€ä½ å›´ç»•èŒƒå¼æ¥æ„å»ºä½ çš„åº”ç”¨ã€‚æ²¡æœ‰äº†è¦ç»´æŠ¤çš„å®¢æˆ·ç«¯è·¯ç”±ï¼Œæ²¡æœ‰äº†è¦ä»”ç»†ç®¡ç†çš„å®¢æˆ·ç«¯çŠ¶æ€ã€‚æŒä¹…åŒ–è¿›ç¨‹ç”± Turbo æ¥ç®¡ç†ï¼Œè€Œä½ ç¼–å†™è‡ªå·±çš„æœåŠ¡ç«¯ä»£ç ï¼Œä»¿ä½›åˆå›åˆ°äº†æ—©å¹´é—´çš„æ—¶å…‰â€”â€”ä¸å½“ä»Š SPA æ€ªå…½çš„å¤æ‚æ€§å¹¸ç¦åœ°éš”ç¦»å¼€äº†ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é€šè¿‡æ‹¦æˆªæ‰€æœ‰åœ¨&lt;a href=&quot;&quot;&gt;é“¾æ¥ä¸Šçš„ç‚¹å‡»åˆ°ç›¸åŒçš„é¢†åŸŸè€Œå®ç°ã€‚å½“ä½ ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æ—¶ï¼ŒTurbo Drive é˜»æ­¢æµè§ˆå™¨çš„å“åº”ï¼Œä½¿ç”¨&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/History&quot;&gt;History API&lt;/a&gt;æ”¹å˜æµè§ˆå™¨çš„ URLï¼Œä½¿ç”¨ &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/fetch&quot;&gt;&lt;code&gt;fetch&lt;/code&gt;&lt;/a&gt; æ¥è·å–æ–°é¡µé¢ï¼Œç„¶åæ¸²æŸ“ HTML å“åº”ã€‚&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¯¹äºè¡¨å•æ˜¯åŒæ ·çš„å¤„ç†ã€‚å®ƒä»¬çš„æäº¤éƒ½è¢«è½¬åŒ–ä¸º &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/fetch&quot;&gt;&lt;code&gt;fetch&lt;/code&gt;&lt;/a&gt; è¯·æ±‚ï¼ŒTurbo Drive å°†æ ¹æ®è¿™äº›è¯·æ±‚éµå¾ªé‡å®šå‘å¹¶æ¸²æŸ“ HTML å“åº”ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨æ¸²æŸ“æœŸé—´ï¼ŒTurbo Drive ä¼šå®Œå…¨æ›¿æ¢æ‰å½“å‰çš„&lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt;å…ƒç´ å¹¶åˆå¹¶&lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;å…ƒç´ çš„å†…å®¹ã€‚JavaScript çš„ window å’Œ document å¯¹è±¡ï¼Œä»¥åŠ&lt;code&gt;&amp;lt;html&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œä¼šåœ¨ä¸€ä¸ªé¡µé¢åˆ°ä¸‹ä¸€ä¸ªé¡µé¢çš„æ¸²æŸ“ä¸­ä¿æŒæŒä¹…åŒ–ã€‚&lt;/p&gt;

&lt;p&gt;å°½ç®¡å¯ä»¥ç›´æ¥ä¸ Turbo Drive è¿›è¡Œäº¤äº’ä»¥æ§åˆ¶è®¿é—®å¦‚ä½•å‘ç”Ÿæˆ–è¿›å…¥è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸€ç§å³æ’å³ç”¨çš„æ›¿ä»£æ–¹æ³•ï¼Œåªéœ€éµå¾ªä¸€äº›çº¦å®šå³å¯å…è´¹äº«å—é‚£ç§é«˜é€Ÿå“åº”ã€‚&lt;/p&gt;

&lt;h2 id=&quot;turbo-frames-decompose-complex-pages&quot;&gt;Turbo Frames: Decompose complex pages&lt;/h2&gt;

&lt;p&gt;å¤§å¤šæ•° Web åº”ç”¨ç¨‹åºæ˜¾ç¤ºçš„é¡µé¢éƒ½åŒ…å«å‡ ä¸ªç‹¬ç«‹çš„ç‰‡æ®µã€‚å¯¹ä¸€ä¸ªè®¨è®ºåŒºé¡µé¢ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªå¯¼èˆªæ åœ¨é¡¶éƒ¨ï¼Œä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨åœ¨ä¸­é—´ï¼Œä¸€ä¸ªè¡¨å•åœ¨åº•éƒ¨ä»¥æ·»åŠ æ–°æ¶ˆæ¯ï¼Œä»¥åŠä¸€ä¸ªåŒ…å«ç›¸å…³ä¸»é¢˜çš„ä¾§è¾¹æ ã€‚ç”Ÿæˆè¿™ç§è®¨è®ºåŒºé¡µé¢é€šå¸¸æ„å‘³ç€ä»¥ä¸€ç§åºåˆ—åŒ–æ–¹å¼ç”Ÿæˆæ¯ä¸ªç‰‡æ®µï¼ŒæŠŠå®ƒä»¬æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç„¶åæŠŠç»“æœä»¥å•ä¸ª HTML çš„å“åº”å‘å¸ƒç»™æµè§ˆå™¨ã€‚&lt;/p&gt;

&lt;p&gt;å€ŸåŠ© Turbo Framesï¼Œä½ å¯ä»¥æŠŠè¿™äº›ç‹¬ç«‹ç‰‡æ®µç½®äº frame å…ƒç´ ä¹‹å†…ï¼Œä»¥é™åˆ¶å…¶å¯¼èˆªèŒƒç•´å¹¶åšæ‡’å¼åŠ è½½ã€‚é™åˆ¶å…¶å¯¼èˆªèŒƒç•´æ„å‘³ç€æ‰€æœ‰äº¤äº’åœ¨ frame å†…éƒ¨ï¼Œæ¯”å¦‚ç‚¹å‡»é“¾æ¥æˆ–è€…æäº¤è¡¨å•ï¼Œéƒ½å‘ç”Ÿäºé‚£ä¸ª frame ä¹‹å†…ï¼Œè€Œé¿å…æ›´æ”¹æˆ–é‡æ–°åŠ è½½é¡µé¢çš„å…¶ä½™éƒ¨åˆ†ã€‚&lt;/p&gt;

&lt;p&gt;è¦å°†ä¸€ä¸ªç‹¬ç«‹ç‰‡æ®µå°è£…åœ¨å®ƒè‡ªå·±çš„å¯¼èˆªä¸Šä¸‹æ–‡ä¸­ï¼ŒæŠŠå®ƒåŒ…åœ¨ä¸€ä¸ª&lt;code&gt;&amp;lt;turbo-frame&amp;gt;&lt;/code&gt; æ ‡ç­¾å†…å³å¯ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-frame id=&quot;new_message&quot;&amp;gt;
  &amp;lt;form action=&quot;/messages&quot; method=&quot;post&quot;&amp;gt;
    ...
  &amp;lt;/form&amp;gt;
&amp;lt;/turbo-frame&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“ä½ æäº¤ä¸Šé¢çš„è¡¨å•æ—¶ï¼ŒTurbo æŠŠåŒ¹é…çš„&lt;code&gt;&amp;lt;turbo-frame id=&quot;new_message&quot;&amp;gt;&lt;/code&gt;å…ƒç´ ä»é‡å®šå‘çš„ HTML å“åº”ä¸­æå–å‡ºæ¥ï¼Œå¹¶æŠŠå…¶å†…å®¹äº¤æ¢åˆ°å·²æœ‰çš„çš„&lt;code&gt;new_message&lt;/code&gt; frame å…ƒç´ ä¸­ã€‚é¡µé¢çš„å…¶ä½™éƒ¨åˆ†ä¿æŒåŸæ ·ã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº†é™åˆ¶å¯¼èˆªèŒƒç•´ä¹‹å¤–ï¼ŒFrames ä¹Ÿå¯ä»¥æ‡’å¼åŠ è½½å…¶å†…å®¹ã€‚è¦æ‡’å¼åŠ è½½ä¸€ä¸ª frameï¼Œæ·»åŠ ä¸€ä¸ªå…¶å€¼ä¸º URL çš„&lt;code&gt;src&lt;/code&gt;å±æ€§å³å¯è‡ªåŠ¨åŠ è½½ã€‚ä¸ä½œç”¨åŸŸå¯¼èˆªä¸€æ ·ï¼ŒTurbo ä»å“åº”ç»“æœä¸­æŸ¥æ‰¾å¹¶æå–å‡ºåŒ¹é…çš„ frame å¹¶äº¤æ¢å…¶å†…å®¹åˆ°å®šä½ä¸­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-frame id=&quot;messages&quot; src=&quot;/messages&quot;&amp;gt;
  &amp;lt;p&amp;gt;This message will be replaced by the response from /messages.&amp;lt;/p&amp;gt;
&amp;lt;/turbo-frame&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™å¯èƒ½å¬èµ·æ¥å¾ˆåƒæ—§æ—¶çš„ framesï¼Œç”šè‡³&lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt;ï¼Œç„¶è€Œ Turbo Frames æ˜¯åŒä¸€ DOM çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤æ²¡æœ‰ä»»ä½•ä¸â€œçœŸå®â€ frames ç›¸å…³çš„æ€ªå¼‚æˆ–å¦¥åã€‚Turbo Frames ç”±åŒæ ·çš„ CSS å®šä¹‰æ ·å¼ï¼Œæ˜¯åŒä¸€ JavaScript ä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œä¸”ä¸å—ä»»ä½•å…¶ä»–å†…å®¹å®‰å…¨æ€§é™åˆ¶ã€‚&lt;/p&gt;

&lt;p&gt;é™¤äº†æŠŠä½ çš„ç‰‡æ®µè½¬åŒ–ä¸ºç‹¬ç«‹ä¸Šä¸‹æ–‡ï¼ŒTurbo Frames è¿˜ä¸ºä½ æä¾›äº†ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é«˜æ•ˆç¼“å­˜&lt;/strong&gt;ï¼šåœ¨ä¸Šé¢çš„è®¨è®ºåŒºé¡µé¢èŒƒä¾‹ä¸­ï¼Œç›¸å…³ä¸»é¢˜çš„ä¾§è¾¹æ å½“ä¸€ä¸ªæ–°ä¸»é¢˜å‘ˆç°æ—¶ï¼ˆç¼“å­˜ï¼‰å°±éœ€è¦è¿‡æœŸï¼Œä½†ä¸­é—´çš„æ¶ˆæ¯åˆ—è¡¨åˆ™ä¸ç”¨ã€‚æ‰€æœ‰ä¸œè¥¿åªåœ¨ä¸€ä¸ªé¡µé¢æ—¶ï¼Œä¸€æ—¦ä»»ä½•ä¸€ä¸ªç‰‡æ®µè¿‡æœŸåˆ™æ•´ä¸ªç¼“å­˜éƒ½ä¼šè¿‡æœŸã€‚å€ŸåŠ© framesï¼Œæ¯ä¸ªç‰‡æ®µéƒ½è¢«ç‹¬ç«‹ç¼“å­˜ï¼Œå› æ­¤ä½ å¯ä»¥è·å¾—æ›´å°‘ä¾èµ– key çš„å¯¿å‘½æ›´é•¿çš„ç¼“å­˜ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;å¹¶è¡Œæ‰§è¡Œ&lt;/strong&gt;ï¼šæ¯ä¸ªæ‡’å¼åŠ è½½çš„ frame éƒ½ç”±å…¶è‡ªå·±çš„ HTTP è¯·æ±‚/å“åº”æ‰€ç”Ÿæˆï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è¢«å•ä¸ªè¿›ç¨‹æ¥å¤„ç†ã€‚è¿™å…è®¸å¹¶è¡Œæ‰§è¡Œè€Œä¸ç”¨æ‰‹åŠ¨ç®¡ç†è¿›ç¨‹ã€‚ä¸€ä¸ªå¤æ‚çš„ç»„åˆé¡µé¢éœ€è¦èŠ±è´¹ 400 ms å®Œæˆç«¯åˆ°ç«¯æ¸²æŸ“ï¼Œåˆ™å¯ä»¥è¢«åˆ†è§£ä¸º framesï¼Œåˆå§‹è¯·æ±‚å¯èƒ½åªéœ€è¦ 50 msï¼Œè€Œä¸‰ä¸ªæ‡’å¼åŠ è½½çš„ frames æ¯ä¸ªéƒ½è€—è´¹ 50 msã€‚ç°åœ¨æ•´ä¸ªé¡µé¢ 100 ms å°±å¯åŠ è½½å®Œæˆï¼Œå› ä¸ºé‚£ä¸‰ä¸ª frames çš„50 ms è¯·æ±‚æ˜¯å¹¶å‘è€Œéåºåˆ—å¼çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Mobile å‹å¥½&lt;/strong&gt;ï¼šåœ¨ mobile app ä¸­ï¼Œä½ é€šå¸¸ä¸ä¼šæœ‰å¤§è€Œå¤æ‚çš„ç»„åˆé¡µé¢ã€‚æ¯ä¸ªç‰‡æ®µéƒ½éœ€è¦ä¸“ç”¨çš„å±å¹•ã€‚å€ŸåŠ© Turbo Frames æ„å»ºçš„åº”ç”¨ï¼Œä½ å°±å·²ç»å®Œæˆäº†æŠŠå¤æ‚é¡µé¢è½¬æ¢ä¸ºç‰‡æ®µçš„å·¥ä½œã€‚ç„¶åè¿™äº›ç‰‡æ®µå°±å¯ä»¥å‘ˆç°åœ¨åŸç”Ÿçš„è¡¨æ ¼å’Œå±å¹•ä¸­ï¼Œæ— éœ€æ”¹åŠ¨ï¼ˆå› ä¸ºå®ƒä»¬éƒ½æœ‰ç‹¬ç«‹çš„ URLï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;turbo-streams-deliver-live-page-changes&quot;&gt;Turbo Streams: Deliver live page changes&lt;/h2&gt;

&lt;p&gt;å“åº”å¼‚æ­¥æ“ä½œè€Œè¿›è¡Œé¡µé¢çš„éƒ¨åˆ†æ›´æ”¹æ˜¯æˆ‘ä»¬ä½¿åº”ç”¨ä¿æŒæ´»åŠ›çš„æ–¹å¼ã€‚å°½ç®¡ Turbo Frames ç»™äºˆäº†æˆ‘ä»¬è¿™ç§æ›´æ–°ä»¥å“åº”åœ¨å•ä¸ª frame å†…çš„ç›´æ¥äº¤äº’ï¼Œè€Œ Turbo Streams åˆ™è®©æˆ‘ä»¬å¾—ä»¥å“åº”é€šè¿‡ WebSocket è¿æ¥ã€SSE æˆ–å…¶ä»–ä¼ è¾“æ‰€å‘é€çš„æ›´æ–°æ¥æ›´æ”¹é¡µé¢çš„ä»»ä½•éƒ¨åˆ†ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Streams æä¾›äº†ä¸€ä¸ª&lt;code&gt;&amp;lt;turbo-stream&amp;gt;&lt;/code&gt;å…ƒç´ ï¼Œå¸¦æœ‰äº”ç§åŸºæœ¬è¡Œä¸ºï¼š&lt;code&gt;append&lt;/code&gt;ã€&lt;code&gt;prepend&lt;/code&gt;ã€&lt;code&gt;replace&lt;/code&gt;ã€&lt;code&gt;update&lt;/code&gt;å’Œ&lt;code&gt;remove&lt;/code&gt;ã€‚å€ŸåŠ©è¿™äº›è¡Œä¸ºï¼Œè·ŸæŒ‡å®šäº†ä½ æ‰€æƒ³æ“ä½œå…ƒç´ çš„ ID çš„&lt;code&gt;target&lt;/code&gt;å±æ€§ä¸€èµ·ï¼Œå°±å¯ä»¥ç¼–ç æ‰€æœ‰éœ€è¦çš„å˜æ›´å†…å®¹æ¥åˆ·æ–°é¡µé¢ã€‚ä½ ç”šè‡³å¯ä»¥ç»„åˆå‡ ä¸ª stream å…ƒç´ åœ¨ä¸€ä¸ªå•ç‹¬çš„ stream æ¶ˆæ¯ä¸­ã€‚åªç”¨æŠŠä½ éœ€è¦æ’å…¥æˆ–æ›¿æ¢çš„ HTML åŒ…å«åœ¨ä¸€ä¸ª &lt;strong&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Element/template&quot;&gt;template tag&lt;/a&gt;&lt;/strong&gt; ä¸­ï¼ŒTurbo ä¼šåšå¥½å‰©ä¸‹çš„ä¸€åˆ‡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-stream action=&quot;append&quot; target=&quot;messages&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;My new message!&amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯¥ stream å…ƒç´ å°†ä¼šè·å–å¸¦æ–°æ¶ˆæ¯çš„&lt;code&gt;div&lt;/code&gt;å¹¶æŠŠå®ƒ append åˆ° ID ä¸º&lt;code&gt;messages&lt;/code&gt;çš„å®¹å™¨ä¸­ã€‚è¦ç®€å•åœ°æ›¿æ¢æ‰å·²æœ‰çš„å…ƒç´ åˆ™å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;lt;turbo-stream action=&quot;replace&quot; target=&quot;message_1&quot;&amp;gt;
  &amp;lt;template&amp;gt;
    &amp;lt;div id=&quot;message_1&quot;&amp;gt;This changes the existing message!&amp;lt;/div&amp;gt;
  &amp;lt;/template&amp;gt;
&amp;lt;/turbo-stream&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ˜¯ Rails ä¸–ç•Œä¸­çš„ä¸€ç§æ¦‚å¿µä¸Šçš„æŒç»­ï¼ˆèµ·åˆè¢«ç§°ä½œ &lt;a href=&quot;https://weblog.rubyonrails.org/2006/3/28/rails-1-1-rjs-active-record-respond_to-integration-tests-and-500-other-things/&quot;&gt;RJS&lt;/a&gt;ï¼Œç„¶åè¢«ç§°ä½œ &lt;a href=&quot;https://signalvnoise.com/posts/3697-server-generated-javascript-responses&quot;&gt;SJR&lt;/a&gt;ï¼‰ï¼Œå´æ˜¯æ— éœ€ä»»ä½• JavaScript çš„ä¸€ç§å®ç°ã€‚ä¼˜ç‚¹æ˜¯åŒæ ·çš„ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;é‡ç”¨æœåŠ¡ç«¯æ¨¡æ¿&lt;/strong&gt;ï¼šå®æ—¶é¡µé¢æ”¹åŠ¨çš„ç”Ÿæˆéƒ½è·Ÿåˆæ¬¡åŠ è½½é¡µé¢ä¸€æ ·ä½¿ç”¨åŒæ ·çš„æœåŠ¡ç«¯æ¨¡æ¿ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;HTML over the wire&lt;/strong&gt;ï¼šç”±äºæ‰€æœ‰æˆ‘ä»¬æ‰€å‘é€çš„éƒ½æ˜¯ HTMLï¼Œä½ å°±æ— éœ€ä»»ä½•å®¢æˆ·ç«¯ JavaScript ï¼ˆè¶…è¶Š Turboï¼Œå½“ç„¶å¦‚æ­¤ï¼‰æ¥å¤„ç†æ›´æ–°äº†ã€‚æ˜¯çš„ï¼ŒHTML çš„è´Ÿè·å¯èƒ½æ¯” JSON è¦å¤§ä¸€ç‚¹ï¼Œä½†å€ŸåŠ© gzipï¼Œè¿™ç‚¹å·®å¼‚é€šå¸¸éƒ½æ˜¯å¾®ä¸è¶³é“çš„ï¼Œç„¶è€Œä½ èŠ‚çœäº†æ‰€æœ‰å®¢æˆ·çš„çš„å·¥ä½œï¼šè·å– JSON å¹¶æŠŠå…¶è½¬ä¸º HTMLã€‚&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;æ›´ç®€å•çš„æ§åˆ¶æµ&lt;/strong&gt;ï¼šå½“æ¶ˆæ¯é€šè¿‡ WebSocketã€SSE åˆ°è¾¾æˆ–è€…å“åº”è¡¨å•æäº¤æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæ˜¯å¾ˆæ¸…æ™°çš„ã€‚å†ä¹Ÿæ²¡æœ‰è·¯ç”±ã€äº‹ä»¶å†’æ³¡æˆ–å…¶ä»–çš„é—´æ¥å¤„ç†ã€‚å®ƒå°±ä»…æ˜¯è¢«å˜æ›´çš„ HTML è€Œå·²ï¼Œè¢«å°è£…åœ¨ä¸€ä¸ªå•ç‹¬çš„ tag ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ç°åœ¨ï¼Œä¸åƒ RJS å’Œ SJR ï¼Œè°ƒç”¨è‡ªå®šä¹‰çš„ JavaScript å‡½æ•°æ¥ä½œä¸º Turbo Streams è¡Œä¸ºçš„ä¸€éƒ¨åˆ†æ˜¯ä¸å¯èƒ½çš„äº†ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œä¸æ˜¯ bugã€‚å½“å‘é€å¤ªå¤š JavaScript è·Ÿå“åº”ä¸€èµ·æ—¶ï¼Œè¿™äº›æŠ€æœ¯å¾ˆå®¹æ˜“æœ€ç»ˆå¯¼è‡´ä¹±ä¸ƒå…«ç³Ÿçš„æ··ä¹±çŠ¶å†µã€‚Turbo ä¸“æ³¨äºä»…æ›´æ–° DOMï¼Œç„¶åå‡è®¾ä½ ä¼šä½¿ç”¨ &lt;a href=&quot;https://stimulus.hotwire.dev/&quot;&gt;Stimulus&lt;/a&gt; çš„ action å’Œç”Ÿå‘½å‘¨æœŸå›è°ƒæ¥è¿æ¥ä»»ä½•é¢å¤–è¡Œä¸ºã€‚&lt;/p&gt;

&lt;h2 id=&quot;turbo-native-hybrid-apps-for-ios--android&quot;&gt;Turbo Native: Hybrid apps for iOS &amp;amp; Android&lt;/h2&gt;

&lt;p&gt;Turbo Native æ˜¯æ„å»ºé€‚ç”¨äº iOS å’Œ Android çš„ hybrid apps çš„ç†æƒ³é€‰æ‹©ã€‚ä½ å¯ä»¥ä½¿ç”¨ä½ ç°æœ‰çš„æœåŠ¡ç«¯æ¸²æŸ“çš„ HTML æ¥å¾—åˆ°åœ¨ä¸€ä¸ªåŸç”Ÿå°è£…é‡Œçš„ app åŠŸèƒ½çš„åŸºçº¿èŒƒç•´ã€‚ç„¶åä½ å°±å¯ä»¥æŠŠæ‰€æœ‰èŠ‚çœä¸‹æ¥çš„æ—¶é—´èŠ±åœ¨ä½¿å—ç›Šäºé«˜ä¿çœŸåŸç”Ÿæ§ä»¶çš„å‡ ä¸ªå±å¹•å˜å¾—æ›´å¥½ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;åƒ Basecamp è¿™æ ·çš„åº”ç”¨ç”±ä¸Šç™¾ä¸ªå±å¹•ã€‚é‡å†™æ¯ä¸ªå•ç‹¬çš„å±å¹•éƒ½ä¼šæ˜¯ä¸€ä¸ªæ”¶ç›Šæä½çš„å·¨å¤§å·¥ä½œã€‚ä¸ºçœŸæ­£éœ€è¦é«˜ä¿çœŸçš„é‡åº¦äº¤äº’ä¿ç•™â€œç«åŠ›â€æ‰æ›´å¥½ã€‚ä¾‹å¦‚ï¼Œç±»ä¼¼äº Basecamp ä¸­çš„â€œNew For Youâ€ inboxï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è½»æ‰«æ§åˆ¶éœ€è¦æ°åˆ°å¥½å¤„ã€‚ä½†å¤§å¤šæ•°é¡µé¢ï¼Œæ¯”å¦‚æ˜¾ç¤ºä¸€æ¡å•ç‹¬æ¶ˆæ¯çš„é¡µé¢ï¼Œåˆ™ä¸ä¼šæ¯”å®Œå…¨åŸç”Ÿçš„åšåˆ°æ›´å¥½ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ hybrid ä¸ä»…å¯ä»¥åŠ å¿«å¼€å‘è¿‡ç¨‹ï¼Œè¿˜å¯ä»¥è®©ä½ æ‹¥æœ‰æ›´å¤§çš„è‡ªç”±æ¥å‡çº§ appï¼Œè€Œæ— éœ€ç»å†ç¼“æ…¢è€Œç¹ççš„åº”ç”¨å•†åº—å‘å¸ƒè¿‡ç¨‹ã€‚ä»»ä½• HTML åšæˆçš„ä¸œè¥¿éƒ½å¯ä»¥åœ¨ä½ çš„ web åº”ç”¨ç¨‹åºä¸­è¢«æ›´æ”¹ï¼Œå¹¶å³åˆ»ä¸ºæ‰€æœ‰ç”¨æˆ·æ‰€ç”¨ã€‚æ— éœ€ç­‰å¾…æŠ€æœ¯å¤§ç‰›æ¥æ‰¹å‡†ä½ çš„æ›´æ”¹ï¼Œä¹Ÿæ— éœ€è®©ç”¨æˆ·ç­‰å¾…å‡çº§ã€‚&lt;/p&gt;

&lt;p&gt;Turbo Native å‡è®¾ä½ æ­£åœ¨ä½¿ç”¨å¯¹äº iOS å’Œ Android æ‰€æ¨èçš„å¯ç”¨çš„å¼€å‘å®è·µã€‚å®ƒä¸æ˜¯ä¸€ä¸ªæŠ½è±¡å‡ºåŸç”Ÿ API æˆ–è€…ç”šè‡³è®©ä½ çš„åŸç”Ÿä»£ç åœ¨å¤šä¸ªå¹³å°ä¹‹é—´å…±äº«çš„æ¡†æ¶ã€‚å…±äº«çš„éƒ¨åˆ†æ˜¯åœ¨æœåŠ¡ç«¯æ¸²æŸ“çš„ HTMLã€‚ä½†æ˜¯åŸç”Ÿçš„æ§åˆ¶æ˜¯ç”±æ‰€æ¨èçš„åŸç”Ÿ API å†™å°±ã€‚&lt;/p&gt;

&lt;p&gt;å‚è€ƒ &lt;a href=&quot;https://github.com/hotwired/turbo-ios&quot;&gt;Turbo Native: iOS&lt;/a&gt; å’Œ &lt;a href=&quot;https://github.com/hotwired/turbo-android&quot;&gt;Turbo Native: Android&lt;/a&gt;  ä»£ç åº“çš„æ›´å¤šæ–‡æ¡£ã€‚å»çœ‹çœ‹ HEY åœ¨ &lt;a href=&quot;https://apps.apple.com/us/app/hey-email/id1506603805&quot;&gt;iOS&lt;/a&gt; å’Œ &lt;a href=&quot;https://play.google.com/store/apps/details?id=com.basecamp.hey&amp;amp;hl=en_US&amp;amp;gl=US&quot;&gt;Android&lt;/a&gt; ä¸Šçš„åŸç”Ÿ app ä»¥æ„Ÿå—ä¸‹ä½¿ç”¨ Turbo æ‰€åˆ¶ä½œçš„ hybrid app æœ‰å¤šä¹ˆå‡ºè‰²å§ã€‚&lt;/p&gt;

&lt;h2 id=&quot;integrate-with-backend-frameworks&quot;&gt;Integrate with backend frameworks&lt;/h2&gt;

&lt;p&gt;ä½ ä¸éœ€è¦ä»»ä½•åç«¯æ¡†æ¶å³å¯ä½¿ç”¨ Turboã€‚å®ƒçš„æ‰€æœ‰ç‰¹æ€§éƒ½å¯ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€æ›´å¤šçš„æŠ½è±¡ã€‚ä½†å¦‚æœä½ æœ‰æœºä¼šä½¿ç”¨ä¸€ä¸ªåç«¯æ¡†æ¶æ¥æ•´åˆ Turboï¼Œå°†ä¼šå‘ç°ä¸€åˆ‡å˜å¾—æ›´ç®€å•äº†ã€‚&lt;a href=&quot;https://github.com/hotwired/turbo-rails&quot;&gt;æˆ‘ä»¬å·²ç»ä¸ºä¸ Ruby on Rails åšè¿™æ ·çš„æ•´åˆåˆ›å»ºäº†ä¸€ä»½å®ç°çš„å‚è€ƒ&lt;/a&gt;ã€‚&lt;/p&gt;

</description>
        <pubDate>Wed, 10 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/hotwire-turbo-introduction/</link>
        <guid isPermaLink="true">/2021/03/hotwire-turbo-introduction/</guid>
        
        <category>rails</category>
        
        <category>hotwire</category>
        
        <category>turbo</category>
        
        
        <category>Translation</category>
        
        <category>Programming</category>
        
      </item>
    
      <item>
        <title>è¡Œäº‘æµæ°´èˆ¬çš„NeoVim Builtin LSPæ“ä½œ</title>
        <description>&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬çš„ NeoVim å·²ç»é…ç½®å¥½ Builtin LSP çš„ Server å’Œ Clientï¼Œå°±è¯¥æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒçš„é—®é¢˜äº†ï¼Œä¹Ÿå°±æ˜¯ç›¸å…³çš„ Keybinding è®¾å®šã€‚å¥½çš„ Keybinding è®¾å®šä¼šè®©äººåœ¨ä½¿ç”¨æ—¶è¿æŒ‡å¦‚é£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/neovim/nvim-lspconfig&quot;&gt;nvim-lspconfig&lt;/a&gt; çš„ Readme æ–‡æ¡£é‡Œå·²ç»ç»™å‡ºäº†å®ƒçš„é»˜è®¤ Keybinding è®¾ç½®ï¼Œæ¯”å¦‚ä¸‹é¢è¿™å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„ï¼ˆæ›´å¤šå¯å‚è€ƒå®ƒçš„æ–‡æ¡£ï¼‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-lua&quot;&gt;-- æŸ¥çœ‹å‡½æ•°å£°æ˜
buf_set_keymap('n', 'gD', '&amp;lt;Cmd&amp;gt;lua vim.lsp.buf.declaration()&amp;lt;CR&amp;gt;', opts)
-- æŸ¥çœ‹å‡½æ•°å®šä¹‰
buf_set_keymap('n', 'gd', '&amp;lt;Cmd&amp;gt;lua vim.lsp.buf.definition()&amp;lt;CR&amp;gt;', opts)
-- æŸ¥çœ‹å‡½æ•°å¸®åŠ©æ–‡æ¡£
buf_set_keymap('n', 'K', '&amp;lt;Cmd&amp;gt;lua vim.lsp.buf.hover()&amp;lt;CR&amp;gt;', opts)
-- æŸ¥çœ‹å‡½æ•°ç›¸å…³å¼•ç”¨
buf_set_keymap('n', 'gr', '&amp;lt;cmd&amp;gt;lua vim.lsp.buf.references()&amp;lt;CR&amp;gt;', opts)
-- æŸ¥çœ‹å‰ä¸€å¤„è¯­æ³•é”™è¯¯
buf_set_keymap('n', '[d', '&amp;lt;cmd&amp;gt;lua vim.lsp.diagnostic.goto_prev()&amp;lt;CR&amp;gt;', opts)
-- æŸ¥çœ‹åä¸€å¤„è¯­æ³•é”™è¯¯
buf_set_keymap('n', ']d', '&amp;lt;cmd&amp;gt;lua vim.lsp.diagnostic.goto_next()&amp;lt;CR&amp;gt;', opts)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶è€Œï¼Œè¯•ç”¨ä¹‹åå‘ç°ï¼Œè¿™æ ·çš„é…ç½®ç”¨èµ·æ¥å¹¶ä¸èˆ’æœã€‚è¿™äº›å¿«æ·é”®å®šä¹‰æ‚ä¹±æ— ç« ï¼Œä¸æ–¹ä¾¿è®°å¿†ï¼›å½“ç»“æœæœ‰å¤šä¸ªæ¡ç›®æ—¶ï¼Œå®ƒé»˜è®¤ä½¿ç”¨ Vim çš„ Quickfix çª—å£ï¼Œä¹Ÿä¸æ–¹ä¾¿æŸ¥è¯¢ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºåè€…ï¼Œ è‡ªç„¶è€Œç„¶å°±ä¼šæƒ³åˆ° FZF è¿™æŠŠçŠ€åˆ©çš„ç‘å£«å†›åˆ€ã€‚Google ä¹‹åï¼Œå‘ç°æ—©å°±æœ‰äººæƒ³åˆ°è¿™ç‚¹ï¼Œå·²ç»åšäº†ä¸€ä¸ªæ’ä»¶ï¼š&lt;a href=&quot;https://github.com/ojroques/nvim-lspfuzzy&quot;&gt;nvim-lspfuzzy&lt;/a&gt;ã€‚è¿™ä¸ªæ’ä»¶è®© NeoVim æŠŠ LSP çš„ç»“æœåˆ—è¡¨ä½¿ç”¨ FZF æ¥æ˜¾ç¤ºï¼Œå¹¶å¯è¿›è¡Œé«˜æ•ˆç­›é€‰ä»¥åŠä»£ç è·³è½¬ã€‚è¿™æ˜¯å®ƒçš„ demo æ¼”ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/ojroques/nvim-lspfuzzy/raw/main/demo.gif&quot; alt=&quot;https://github.com/ojroques/nvim-lspfuzzy/raw/main/demo.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å‚ç…§å…¶æ–‡æ¡£å®‰è£…å¥½ä¹‹åï¼Œåœ¨&lt;code&gt;~/.config/nvim/init.nvim&lt;/code&gt;ä¸­æ·»åŠ ä¸€è¡Œé…ç½®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-lua&quot;&gt;require('lspfuzzy').setup {}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åæˆ‘åœ¨&lt;code&gt;.vimrc&lt;/code&gt;ä¸­åšäº†è¿™æ ·çš„ Keybinding è®¾å®šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;ls &amp;lt;cmd&amp;gt;lua vim.lsp.buf.document_symbol()&amp;lt;CR&amp;gt;
nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;ll &amp;lt;cmd&amp;gt;lua vim.lsp.buf.references()&amp;lt;CR&amp;gt;
nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;lg &amp;lt;cmd&amp;gt;lua vim.lsp.buf.definition()&amp;lt;CR&amp;gt;
nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;la &amp;lt;cmd&amp;gt;lua vim.lsp.buf.code_action()&amp;lt;CR&amp;gt;
nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;l; &amp;lt;cmd&amp;gt;lua vim.lsp.diagnostic.goto_prev()&amp;lt;CR&amp;gt;
nnoremap &amp;lt;silent&amp;gt;&amp;lt;leader&amp;gt;l, &amp;lt;cmd&amp;gt;lua vim.lsp.diagnostic.goto_next()&amp;lt;CR&amp;gt;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æŠŠå…¨éƒ¨å¿«æ·é”®éƒ½å®šä¹‰ä¸ºä»¥&lt;code&gt;&amp;lt;leader&amp;gt;l&lt;/code&gt;å¼€å¤´ï¼Œè¿™æ ·å³æœ‰è§„å¾‹ï¼Œä¾¿äºè®°å¿†äº†ã€‚è€Œ FZF çš„åŠ æŒæ›´æ˜¯å¦‚è™æ·»ç¿¼ï¼Œå†™èµ·ä»£ç æ¥è¡Œäº‘æµæ°´ï¼Œæµç•…è‡ªå¦‚ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹ä¸€ç¯‡å†ä»‹ç»å¦ä¸€ä¸ªå¾ˆæ£’çš„ LSP æ’ä»¶ï¼Œè®©äººå†™èµ·ä»£ç æ¥æ›´åŠ èµå¿ƒæ‚¦ç›®ğŸ˜„&lt;/p&gt;
</description>
        <pubDate>Sat, 06 Mar 2021 00:00:00 +0000</pubDate>
        <link>/2021/03/neovim-builtin-lsp-keymappings/</link>
        <guid isPermaLink="true">/2021/03/neovim-builtin-lsp-keymappings/</guid>
        
        <category>neovim</category>
        
        
        <category>Tool</category>
        
      </item>
    
      <item>
        <title>NeoVim Builtin LSPçš„åŸºæœ¬é…ç½®</title>
        <description>&lt;p&gt;ä¸Šä¸€ç¯‡åšå®¢è¯´è¿‡ï¼Œç°åœ¨å®˜æ–¹å¯¹ NeoVim Builtin LSP çš„é…ç½®å·²ç»åšåˆ°äº†è¶³å¤Ÿç®€æ´æ˜“ç”¨çš„åœ°æ­¥ã€‚è¿™ä¸€ç¯‡å°±æ¥çœ‹çœ‹æ€æ ·æŒ‰ç…§ NeoVim å®˜æ–¹çš„è¯´æ˜ï¼Œä¸€æ­¥ä¸€æ­¥æŠŠ LSP ç»™é…ç½®ä¸ºå¯ç”¨äºå®é™…å¼€å‘ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†ç®€åŒ– LSP çš„å®‰è£…å’Œé…ç½®ï¼ŒNeoVim å®˜æ–¹ä¸“é—¨åˆ›å»ºäº† &lt;a href=&quot;https://github.com/neovim/nvim-lspconfig&quot;&gt;nvim-lspconfig&lt;/a&gt; æ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬ã€‚è¿™ä¸ªæ’ä»¶æŠŠæ‰€æœ‰ LSP èƒŒåçš„ç¹çéƒ½å°è£…åˆ°å…¶å†…éƒ¨ï¼Œè®©ä½¿ç”¨è€…å†ä¹Ÿæ¯‹éœ€æ‹…å¿ƒå‡ºç°è´¹äº†å¤§åŠå¤©åŠŸå¤«ç»“æœä»ç„¶æ— æ³•ç”¨èµ·æ¥çš„äº‹ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘è‡ªå·±çš„æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ä¸»è¦ä¼šç”¨åˆ° Rubyã€JavaScript å’Œ Golang è¿™å‡ ç§ç¼–ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥å½“ç„¶å°±éœ€è¦æŠŠ NeoVim çš„ LSP é…ç½®ä¸ºæ”¯æŒå®ƒä»¬äº†ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œå®‰è£…å¥½ nvim-lspconfig æ’ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;Plug 'neovim/nvim-lspconfig'
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åï¼ŒæŒ‰ç…§ nvim-lspconfig çš„æ–‡æ¡£è¯´æ˜ï¼Œæ‰“å¼€&lt;code&gt;~/.config/nvim/init.vim&lt;/code&gt;ï¼Œåœ¨å…¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-lua&quot;&gt;lua &amp;lt;&amp;lt; EOF
require'lspconfig'.solargraph.setup{}
require'lspconfig'.tsserver.setup{}
require'lspconfig'.gopls.setup{}
EOF
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯â€¦â€¦æ²¡äº†ï¼ğŸ˜„&lt;/p&gt;

&lt;p&gt;æˆ‘çš„ Rubyã€JavaScript å’Œ Golang ä¸‰ç§è¯­è¨€åœ¨ NeoVim ä¸Šçš„ LSP æ”¯æŒå°±æ­¤å®Œæˆï¼&lt;/p&gt;

&lt;p&gt;å½“ç„¶äº†ï¼Œå…¨éƒ¨å·¥ä½œå…¶å®è¿˜æ²¡å®Œã€‚ä½† NeoVim å±‚é¢çš„éƒ¨åˆ†ç¡®å®å·²ç»ç»“æŸäº†ï¼Œç®—æ˜¯è¶³å¤Ÿç®€æ´äº†å§ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;em&gt;ä¸Šé¢æˆ‘éƒ½æ˜¯ä½¿ç”¨äº† nvim-lspconfig çš„é»˜è®¤é…ç½®ï¼Œå› ä¸ºè¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ æƒ³è¦é’ˆå¯¹æ¯ç§è¯­è¨€å•ç‹¬åšä¸€äº›ç‰¹åˆ«çš„è®¾ç½®ï¼Œé‚£ä¹ˆå¯ä»¥å‚è€ƒ nvim-lspconfig çš„&lt;a href=&quot;https://github.com/neovim/nvim-lspconfig/blob/master/CONFIG.md&quot;&gt;è¿™ä¸ªæ–‡æ¡£&lt;/a&gt;ã€‚&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘è¿˜éœ€è¦åœ¨è‡ªå·±ç³»ç»Ÿä¸ŠæŠŠä¸Šè¿°ä¸‰ç§è¯­è¨€çš„ LSP Server å®‰è£…ä¸Šï¼Œç„¶å NeoVim ä»¥ä¸Šæ‰€é…ç½®å¥½çš„ LSP Client å°±å¯ä»¥æ­£ç¡®åœ°è¿æ¥ä¸Šå®ƒä»¬ã€‚&lt;/p&gt;

&lt;p&gt;Ruby çš„  LSP Server æˆ‘ä½¿ç”¨ Solargraphï¼Œé€šè¿‡ Gem å®‰è£…ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;gem install solargraph
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;JavaScript çš„  LSP Server æˆ‘ä½¿ç”¨ tsserverï¼Œé€šè¿‡ npm å®‰è£…ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;npm install -g typescript typescript-language-server
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Golang çš„  LSP Server æˆ‘ä½¿ç”¨ goplsï¼Œé€šè¿‡ go mod å®‰è£…ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;go get golang.org/x/tools/gopls@latest
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¨éƒ¨è£…å¥½ä¹‹åï¼Œç”¨ NeoVim æ‰“å¼€ä¸€ä¸ªä¸Šè¿°ä¸‰ç§è¯­è¨€çš„ä»»æ„ä¸€ä¸ªé¡¹ç›®çš„ä»£ç æ–‡ä»¶ï¼Œåœ¨ Vim å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥&lt;code&gt;:LspInfo&lt;/code&gt;ï¼Œå›è½¦ï¼Œåº”è¯¥å°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰é…ç½®æˆåŠŸçš„ LSP ä¿¡æ¯äº†ã€‚&lt;/p&gt;

</description>
        <pubDate>Sat, 27 Feb 2021 00:00:00 +0000</pubDate>
        <link>/2021/02/neovim-builtin-lsp-basic-configuration/</link>
        <guid isPermaLink="true">/2021/02/neovim-builtin-lsp-basic-configuration/</guid>
        
        <category>neovim</category>
        
        
        <category>Tool</category>
        
      </item>
    
  </channel>
</rss>
